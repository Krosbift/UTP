#lang racket                                                                                                                                                                                                                                         #|
╔════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╗
║ ┌───────────────────────────────────────────────────────────────────────────────────────┬────────────────────────────────────────────────────────────────────────┐ ║
║ │ - Fecha de publicacion:                                                    11/11/2022 │                                                                        │ ║
║ │ - Hora:                                                                         11:00 │                                                                        │ ║
║ │ - Version del codigo:                                                           1.0.0 │                                                                        │ ║
║ │ - Autor:                                                 Ing(c) Santiago Torifa Manso │                                                                        │ ║
║ │ - Nombre del lenguaje utilizado:                                               Racket │                           CREDITOS DEL CODIGO                          │ ║
║ │ - Version del lenguaje utilizado:                                                 8.6 │                                                                        │ ║
║ │ - Presentado a:                                         Doctor Ricardo Moreno Laverde │                                                                        │ ║
║ ├───────────────────────────────────────────────────────────────────────────────────────┤                                                                        │ ║
║ │ - Universidad Tecnológica de Pereira                                                  │                                                                        │ ║
║ │ - Programa de Ingenieria de Sistemas y Computacion                                    │                                                                        │ ║
║ ├───────────────────────────────────────────────────────────────────────────────────────┴────────────────────────────────────────────────────────────────────────┤ ║
║ │                                                                                                                                                                │ ║
║ │ * Juego Del Ajedrez: Se pide hacer un programa que permita jugar ajedrez a dos(2) jugadores con las reglas del ajedrez de movimiento y ataque.                 │ ║
║ │   - tendra un el botón ”TERMINAR” para que cualquiera de los dos(2) jugadores termine el juego.                                                                │ ║
║ │   - Solamente se tendra en cuenta el jaque, jaque mate y coronación de peón. Segun lo pedido en el contrato.                                                   │ ║
║ │   - Si de casualidad el rey queda ahogado, debido a la falta de esta norma el juego quedara sin jugadas por ende la ejecucion del programa se dentendra.       │ ║
║ │                                                                                                                                                                │ ║
║ └────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘ ║
╚════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╝

╔═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╗
║ DOCUMENTACIÓN DEL CODIGO                                                                                                                                                                                                                          ║
║ - Indice de las lineas en las que se encuentra cada función.                                                                                                                                                                                      ║
║ - Descripccion de los identificadores globales al código.                                                                                                                                                                                         ║
║ - Y el resto de documentacion que no va incluida en una parte específica del código.                                                                                                                                                              ║
╠═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╣
║ Indice De Las Funciones Del Código Por Bloques, Marcadas Por Desde Que Linea A Que Linea Se Encuentran:                                                                                                                                           ║
║ - Documentación general: [1 - 100]                                                                                                                                                                                                                ║
║ - Todo el código: [103 - 9263]                                                                                                                                                                                                                    ║
║ - Apertura de las librerias necesarias: [107 - 111]                                                                                                                                                                                               ║
║ - Definición del entorno de juego en fromato string: [113 - 147]                                                                                                                                                                                  ║
║ - Definición del entorno de juego en el modo grafico: [149 - 251]                                                                                                                                                                                 ║
║ - Definición de las funciones encargadas de buscar jaque mate en las negras o las blancas: [254 - 4397]                                                                                                                                           ║
║ - Definción de la función del jaque mate de las blancas: [254 - 2323]                                                                                                                                                                             ║
║ - Definción de la función del jaque mate de las blancas: [2329 - 4396]                                                                                                                                                                            ║
║ - Definición de la función encargada de buscar si existe algun jaque sea en las negras o las blancas: [4399 - 4632]                                                                                                                               ║
║ - Definición de la función encargada de buscar si algun peon a llegado a su coronación: [4634 - 4680]                                                                                                                                             ║
║ - Definición de la función encargada de actualizar el modo grafico a medida que se va desarrollando la partida: [4682 - 4744]                                                                                                                     ║
║ - Definición de la función encargada del movimiento de los peones blancos: [4749 - 4868]                                                                                                                                                          ║
║ - Definición de la función encargada del movimiento de los peones negros: [4870 - 4898]                                                                                                                                                           ║
║ - Definición de la función encargada del movimiento de las torres blancas: [4992 - 5442]                                                                                                                                                          ║
║ - Definición de la función encargada del movimiento de las torres negras: [5444 - 5896]                                                                                                                                                           ║
║ - Definición de la función encargada del movimiento de los caballos blancos: [5897 - 6042]                                                                                                                                                        ║
║ - Definición de la función encargada del movimiento de los los caballos negros: [6044 - 6189]                                                                                                                                                     ║
║ - Definición de la función encargada del movimiento de los alfiles blancos: [6191 - 6645]                                                                                                                                                         ║
║ - Definición de la función encargada del movimiento de los alfiles negros: [6647 - 7101]                                                                                                                                                          ║
║ - Definición de la función encargada del movimiento de la reina blanca: [7103 - 7965]                                                                                                                                                             ║
║ - Definición de la función encargada del movimiento de la reina negra: [7967 - 8829]                                                                                                                                                              ║
║ - Definición de la función encargada del movimiento del rey blanco: [8831 - 8976]                                                                                                                                                                 ║
║ - Definición de la función encargada del movimiento del rey negro: [8978 - 9123]                                                                                                                                                                  ║
║ - Definición de la funcion encargada de buscar que ficha es la que el usuario desea mover: [9128 - 9195]                                                                                                                                          ║
║ - Definición de la función encargada de dar los turnos que corresponden por jugador y de mostrar en pantalla quien juega: [9200 - 9261]                                                                                                           ║
╠═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╣
║ Descripción De Los Identificadores Globales Al Código:                                                                                                                                                                                            ║
╠═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╣
║ - juego-grafico: este identificador global almacenara el contenido de la ventana grafica, lo que significa que este es el nombre que identifica a la vista grafica del ajedrez,                                                                   ║
║                  a su vez tambien hay otro identificador que es la ventana de coronación pero este se encuentra como identificador local en la funcion de coronación.                                                                             ║
╠═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╣
║ - string-juego: este identificador almacenara en el un string con un total de 128 caracteres desde [0 hasta 127], en el cual se ordenara cada par de caracteres como ficha de ajedrez,                                                            ║
║                 esto significa que este (string) es el que dara paso a si es necesario hacer una actualizacion grafica en la ventana o "juego-grafico".                                                                                           ║
╠═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╣
║ - string-juego-copy: este identificador como su nombre lo indica es una copia literal del string (string-juego), el cual se usara para dos cosas principalmente,                                                                                  ║
║                                                                                                                                                                                                                                                   ║
║                      - primero: para saber si se ha movido alguna ficha, lo que llevaria directamente a la funcion actualizacion grafica a hacer la actualizacion del juego visto por el usuario.                                                 ║
║                                                                                                                                                                                                                                                   ║
║                      - segundo: para usarlo como comparacion directa con el string-juego, ayudando asi al programa a saber si el jugador al que le correspondia el turno ya dio, o por el contrario                                               ║
║                                 su movimiento no fue valido, de tal manera que este string tambien cumple la función de dar informacion a la función controlador para saber si se movio alguna ficha,                                             ║
║                                 y por ende pasar de turno.                                                                                                                                                                                        ║
║                                                                                                                                                                                                                                                   ║
╠═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╣
║ Documentación extra sobre el funcionamiento del programa o bien del código:                                                                                                                                                                       ║
║                                                                                                                                                                                                                                                   ║
║ - Este ajedrez funcionara con strings de tal manera que las funciones que cambiaran de posicion las fichas sera las referentes a este tipo de dato.                                                                                               ║
║                                                                                                                                                                                                                                                   ║
║ - Solo se usara la libreria grafica para hacer el aspecto visual del juego.                                                                                                                                                                       ║
║                                                                                                                                                                                                                                                   ║
║ - El formato de con que caracteres se identificara cada ficha en el string esta mas abajo en un ejemplo en el apartado de ( definicion del entorno de juego en formato string ).                                                                  ║
║                                                                                                                                                                                                                                                   ║
╠═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╣
║                                                                                                                                                                                                                                                   ║
║  * Todas las funciones creadas en este código tendra antes de su definición la descripcion de cada uno de los identificadores locales que se crearon para ser usados                                                                              ║
║    En dicha función.                                                                                                                                                                                                                              ║
║                                                                                                                                                                                                                                                   ║
╠═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╣
║                                                                                                                                                                                                                                                   ║
║  - Recordar:                                                                                                                                                                                                                                      ║
║                                                                                                                                                                                                                                                   ║
║          - tendra un el botón ”TERMINAR” para que cualquiera de los dos(2) jugadores termine el juego.                                                                                                                                            ║
║                                                                                                                                                                                                                                                   ║
║          - Solamente se tendra en cuenta el jaque, jaque mate y coronación de peón. Segun lo pedido en el contrato por ende,                                                                                                                      ║
║            este ajedrez no tiene implementada la función de enrroque por lo que el rey solo podra mover de a una casilla.                                                                                                                         ║
║                                                                                                                                                                                                                                                   ║
║          - Si de casualidad el rey queda ahogado, debido a la falta de esta norma el juego quedara sin jugadas por ende la ejecucion del programa se dentendra.                                                                                   ║
║                                                                                                                                                                                                                                                   ║
║                                                                                                                                                                                                                                                   ║
║                                                                                                                                                                                                                                                   ║
║                                                                                                                                                                                                                                                   ║
╚═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╝

╔═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╗
║ INICIO DEL CÓDIGO                                                                                                                                                                                                                                 ║
╚═══════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════════╝|#
;___________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
#| Apertura De Las Librerias Necesarias Para El Funcionamiento Del Código |#

(require graphics/graphics) #| Llamado a la libreria grafica del lenguaje |#
(open-graphics) #| Apertura de la libreria grafica del lenguaje |#

;___________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
#| Definición Del Entorno De Juego En Formato String |#

; Definición del string mutable del ajedrez.
(define string-juego (make-string 128 #\space))

; Cambio del string mutable para ponerle el substring que conformara cada ficha del juego.
(string-copy! string-juego 0 "TNCNANQNRNANCNTNPNPNPNPNPNPNPNPN0000000000000000000000000000000000000000000000000000000000000000pbpbpbpbpbpbpbpbtbcbabqbrbabcbtb")

; Copia del string del ajedrez para su uso posterior.
(define string-juego-copy (string-copy string-juego))

; Comentario de referencia del string del ajedrez, con margenes para tener una mejor idea de la posicion de cada ficha.
#| Ejemplo Guia Para Ver Como Estara Conformado El String De Juego:
                     
                           15
      01 23 45 67 89 01 23 45  Mayusculas Para Las Negras
     ┌──┬──┬──┬──┬──┬──┬──┬──┐
  0  │TN│CN│AN│QN│RN│AN│CN│TN│ TN = torre  CN = caballo  AN = alfil  QN = Reina  RN = Rey    
     ├──┼──┼──┼──┼──┼──┼──┼──┤
  1  │PN│PN│PN│PN│PN│PN│PN│PN│ Peones = PN
     ├──┼──┼──┼──┼──┼──┼──┼──┤
  2  │00│00│00│00│00│00│00│00│
     ├──┼──┼──┼──┼──┼──┼──┼──┤
  3  │00│00│00│00│00│00│00│00│
     ├──┼──┼──┼──┼──┼──┼──┼──┤
  4  │00│00│00│00│00│00│00│00│
     ├──┼──┼──┼──┼──┼──┼──┼──┤
  5  │00│00│00│00│00│00│00│00│
     ├──┼──┼──┼──┼──┼──┼──┼──┤
  6  │pb│pb│pb│pb│pb│pb│pb│pb│ Peones = pb
     ├──┼──┼──┼──┼──┼──┼──┼──┤
  7  │tb│cb│ab│qb│rb│ab│cb│tb│ tb = torre  cb = caballo  ab = alfil  qb = Reina  rb = Rey   
     └──┴──┴──┴──┴──┴──┴──┴──┘
                               Minusculas Para Las Blancas                                                                                                                                                                                           |#

;___________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
#| Definición Del Entorno De Juego En Modo Grafico |#

; Definicion de la ventana grafica.
(define juego-grafico (open-viewport "AJEDREZ CLASICO" 1100 800))
(((draw-pixmap-posn "Imagenes/FondoPrincipal 800x800.jpg") juego-grafico) (make-posn 0 0)) #| fondo detras del tablero del ajedrez |#
(((draw-pixmap-posn "Imagenes/Marcador 300x800.jpg") juego-grafico) (make-posn 800 0)) #| fondo para el marcador |#

#| Identificadores Locales A La Función (Cuadros):
   - pixeles-x: almacena las coordenadas en x que se usan para pegar las imagenes del tablero.
   - pixeles-y: almacena las coordenadas en y que se usan para pegar las imagenes del tablero.
   - final-cuadros: es el contador de la función, es lo que determina cuando va a finalizar esta función.
   - final-fila: es el contador usado para realizar el salto de fila en la impresión del tablero. |#
; Definicion de la funcion para imprimir el tablero.
(define (cuadros pixeles-x pixeles-y final-cuadros final-fila)
  (if (<= final-cuadros 32)
      (if (= (remainder final-fila 2) 0)
          (begin
            (((draw-pixmap-posn "Imagenes/CUADRONEGRO 80X80.jpg") juego-grafico) (make-posn pixeles-x pixeles-y))
            (((draw-pixmap-posn "Imagenes/CUADROBLANCO 80X80.jpg") juego-grafico) (make-posn (+ pixeles-x 80) pixeles-y))
            (if (= (remainder final-cuadros 4) 0)
                (cuadros (- pixeles-x 480) (+ pixeles-y 80) (+ final-cuadros 1) (+ final-fila 1))
            ; de lo contrario
                (cuadros (+ pixeles-x 160) pixeles-y (+ final-cuadros 1) final-fila)
            ); fin if
          ); fin begin true
      ; de lo contrario
          (begin
            (((draw-pixmap-posn "Imagenes/CUADROBLANCO 80X80.jpg") juego-grafico) (make-posn pixeles-x pixeles-y))
            (((draw-pixmap-posn "Imagenes/CUADRONEGRO 80X80.jpg") juego-grafico) (make-posn (+ pixeles-x 80) pixeles-y))
            (if (= (remainder final-cuadros 4) 0)
                (cuadros (- pixeles-x 480) (+ pixeles-y 80) (+ final-cuadros 1) (+ final-fila 1))
            ; de lo contrario
                (cuadros (+ pixeles-x 160) pixeles-y (+ final-cuadros 1) final-fila)
            ); fin if
          ); fin begin false
      ); fin if
  ; de lo contrario
      (void)
  ); fin if
); fin definicion cuadros

#| Identificadores Locales A La Función (Ordenador):
   - pixeles-x: almacena un valor numerico para usarlo como coordenadas en x.
   - pixeles-y: almacena un valor numerico para usarlo como coordenada en y.
   - final: es el contador de la funcion.
   - final-fila: es el contador para cambiar de fila en la impresion. |#
; Funcion que ordenara las fichas despues de imprimir el tablero de ajedrez y finaliza imprimiendo el botón de terminar.
(define (ordenador pixeles-x pixeles-y final final-fila)
  (if (< final 64)
      (begin
        (if (= final 0)
            (cuadros (- pixeles-x 10) (- pixeles-y 10) (+ final 1) (+ final-fila 1)) #| llamado a la funcion cuadros para generar el tablero antes de las fichas |#
        ; de lo contrario
            (void)
        ); fin if
        (cond #| condicional para imprimir las fichas basandose en su posicion en el string |#
          [(equal? "TN" (substring string-juego (* final 2) (+ (* final 2) 2))) (((draw-pixmap-posn "Imagenes/TorreNegro 60x60.png"   ) juego-grafico) (make-posn pixeles-x pixeles-y))]
          [(equal? "CN" (substring string-juego (* final 2) (+ (* final 2) 2))) (((draw-pixmap-posn "Imagenes/CaballoNegro 60x60.png" ) juego-grafico) (make-posn pixeles-x pixeles-y))]
          [(equal? "AN" (substring string-juego (* final 2) (+ (* final 2) 2))) (((draw-pixmap-posn "Imagenes/AlfilNegro 60x60.png"   ) juego-grafico) (make-posn pixeles-x pixeles-y))]
          [(equal? "QN" (substring string-juego (* final 2) (+ (* final 2) 2))) (((draw-pixmap-posn "Imagenes/ReinaNegro 60x60.png"   ) juego-grafico) (make-posn pixeles-x pixeles-y))]
          [(equal? "RN" (substring string-juego (* final 2) (+ (* final 2) 2))) (((draw-pixmap-posn "Imagenes/ReyNegro 60x60.png"     ) juego-grafico) (make-posn pixeles-x pixeles-y))]
          [(equal? "PN" (substring string-juego (* final 2) (+ (* final 2) 2))) (((draw-pixmap-posn "Imagenes/PeonNegro 60x60.png"    ) juego-grafico) (make-posn pixeles-x pixeles-y))]
          [(equal? "pb" (substring string-juego (* final 2) (+ (* final 2) 2))) (((draw-pixmap-posn "Imagenes/PeonBlanco 60x60.png"   ) juego-grafico) (make-posn pixeles-x pixeles-y))]
          [(equal? "qb" (substring string-juego (* final 2) (+ (* final 2) 2))) (((draw-pixmap-posn "Imagenes/ReinaBlanco 60x60.png"  ) juego-grafico) (make-posn pixeles-x pixeles-y))]
          [(equal? "rb" (substring string-juego (* final 2) (+ (* final 2) 2))) (((draw-pixmap-posn "Imagenes/ReyBlanco 60x60.png"    ) juego-grafico) (make-posn pixeles-x pixeles-y))]
          [(equal? "ab" (substring string-juego (* final 2) (+ (* final 2) 2))) (((draw-pixmap-posn "Imagenes/AlfilBlanco 60x60.png"  ) juego-grafico) (make-posn pixeles-x pixeles-y))]
          [(equal? "cb" (substring string-juego (* final 2) (+ (* final 2) 2))) (((draw-pixmap-posn "Imagenes/CaballoBlanco 60x60.png") juego-grafico) (make-posn pixeles-x pixeles-y))]
          [(equal? "tb" (substring string-juego (* final 2) (+ (* final 2) 2))) (((draw-pixmap-posn "Imagenes/TorreBlanco 60x60.png"  ) juego-grafico) (make-posn pixeles-x pixeles-y))]
        ); fin cond
        (ordenador (if (= final-fila 7) (- pixeles-x 560) (+ pixeles-x 80)) (if (= final-fila 7) (+ pixeles-y 80) pixeles-y) (+ final 1) (if (= final-fila 7)(- final-fila 7)(+ final-fila 1))) #| llamado recursivo a esta misma función |#
      ); fin begin true
  ; de lo contrario
      (begin #| Impresión del boton de terminar |#
        ((draw-string juego-grafico) (make-posn 100 755) "TERMINAR" "white")
        ((draw-line   juego-grafico) (make-posn  85 740) (make-posn 85 758) "white")
        ((draw-line   juego-grafico) (make-posn 195 740) (make-posn 195 758) "white")
        ((draw-line   juego-grafico) (make-posn  85 740) (make-posn 195 740) "white")
        ((draw-line   juego-grafico) (make-posn  85 758) (make-posn 195 758) "white")
      ); fin begin false
  ); fin if
); fin definicion ordenador
(ordenador 90 90 0 0) #| llamado a la funcion para dibujar el tablero, las fichas y el boton de terminar |#

;___________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
#| Definición De Las Funciones Que Van A Analizar Si Existe Jaque Mate En El Juego |#

(define (jaque-mate-blanco string-pos movimientos)
  (if (<= string-pos 126)
      (cond
        [(equal? (substring string-juego string-pos (+ string-pos 1)) "t") (if (<= movimientos 27)
                                                                  (cond
                                                                    #| movimientos superiores |#
                                                                    [(and (and (>= (- string-pos 16)  0) (<= (- string-pos 16) 126) (= movimientos 0)) (equal? #f (equal? (substring string-juego (- string-pos 15) (- string-pos 14)) "b"))) 
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 16) "tb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (>= (- string-pos 16)  0) (<= (- string-pos 16) 126) (= movimientos 1)) (equal? (substring string-juego (- string-pos 16) (- string-pos 15)) "0") (and (>= (- string-pos 32)  0) (<= (- string-pos 32) 126)) (equal? #f (equal? (substring string-juego (- string-pos 31) (- string-pos 30)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 32) "tb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 16)  0) (<= (- string-pos 16) 126) (= movimientos 2)) (equal? (substring string-juego (- string-pos 16) (- string-pos 15)) "0")) (and (and (>= (- string-pos 32)  0) (<= (- string-pos 32) 126)) (equal? (substring string-juego (- string-pos 32) (- string-pos 31)) "0")) (and (>= (- string-pos 48)  0) (<= (- string-pos 48) 126)) (equal? #f (equal? (substring string-juego (- string-pos 47) (- string-pos 46)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 48) "tb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 16)  0) (<= (- string-pos 16) 126) (= movimientos 3)) (equal? (substring string-juego (- string-pos 16) (- string-pos 15)) "0")) (and (and (>= (- string-pos 32)  0) (<= (- string-pos 32) 126)) (equal? (substring string-juego (- string-pos 32) (- string-pos 31)) "0")) (and (and (>= (- string-pos 48)  0) (<= (- string-pos 48) 126)) (equal? (substring string-juego (- string-pos 48) (- string-pos 47)) "0")) (and (>= (- string-pos 64)  0) (<= (- string-pos 64) 126)) (equal? #f (equal? (substring string-juego (- string-pos 63) (- string-pos 62)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 64) "tb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 16)  0) (<= (- string-pos 16) 126) (= movimientos 4)) (equal? (substring string-juego (- string-pos 16) (- string-pos 15)) "0")) (and (and (>= (- string-pos 32)  0) (<= (- string-pos 32) 126)) (equal? (substring string-juego (- string-pos 32) (- string-pos 31)) "0")) (and (and (>= (- string-pos 48)  0) (<= (- string-pos 48) 126)) (equal? (substring string-juego (- string-pos 48) (- string-pos 47)) "0")) (and (and (>= (- string-pos 64)  0) (<= (- string-pos 64) 126)) (equal? (substring string-juego (- string-pos 64) (- string-pos 63)) "0")) (and (>= (- string-pos 80)  0) (<= (- string-pos 80) 126)) (equal? #f (equal? (substring string-juego (- string-pos 79) (- string-pos 78)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 80) "tb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 16)  0) (<= (- string-pos 16) 126) (= movimientos 5)) (equal? (substring string-juego (- string-pos 16) (- string-pos 15)) "0")) (and (and (>= (- string-pos 32)  0) (<= (- string-pos 32) 126)) (equal? (substring string-juego (- string-pos 32) (- string-pos 31)) "0")) (and (and (>= (- string-pos 48)  0) (<= (- string-pos 48) 126)) (equal? (substring string-juego (- string-pos 48) (- string-pos 47)) "0")) (and (and (>= (- string-pos 64)  0) (<= (- string-pos 64) 126)) (equal? (substring string-juego (- string-pos 64) (- string-pos 63)) "0")) (and (and (>= (- string-pos 80)  0) (<= (- string-pos 80) 126)) (equal? (substring string-juego (- string-pos 80) (- string-pos 79)) "0")) (and (>= (- string-pos 96)  0) (<= (- string-pos 96) 126)) (equal? #f (equal? (substring string-juego (- string-pos 95) (- string-pos 94)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 96) "tb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 16)  0) (<= (- string-pos 16) 126) (= movimientos 6)) (equal? (substring string-juego (- string-pos 16) (- string-pos 15)) "0")) (and (and (>= (- string-pos 32)  0) (<= (- string-pos 32) 126)) (equal? (substring string-juego (- string-pos 32) (- string-pos 31)) "0")) (and (and (>= (- string-pos 48)  0) (<= (- string-pos 48) 126)) (equal? (substring string-juego (- string-pos 48) (- string-pos 47)) "0")) (and (and (>= (- string-pos 64)  0) (<= (- string-pos 64) 126)) (equal? (substring string-juego (- string-pos 64) (- string-pos 63)) "0")) (and (and (>= (- string-pos 80)  0) (<= (- string-pos 80) 126)) (equal? (substring string-juego (- string-pos 80) (- string-pos 79)) "0")) (and (and (>= (- string-pos 96)  0) (<= (- string-pos 96) 126)) (equal? (substring string-juego (- string-pos 96) (- string-pos 95)) "0")) (and (>= (- string-pos 112)  0) (<= (- string-pos 112) 126)) (equal? #f (equal? (substring string-juego (- string-pos 111) (- string-pos 110)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 112) "tb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    #| movimientos inferiores |#
                                                                    [(and (and (>= (+ string-pos 16)  0) (<= (+ string-pos 16) 126) (= movimientos 7)) (equal? #f (equal? (substring string-juego (+ string-pos 17) (+ string-pos 18)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 16) "tb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 16)  0) (<= (+ string-pos 16) 126) (= movimientos 8)) (equal? (substring string-juego (+ string-pos 16) (+ string-pos 17)) "0")) (and (>= (+ string-pos 32)  0) (<= (+ string-pos 32) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 33) (+ string-pos 34)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 32) "tb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 16)  0) (<= (+ string-pos 16) 126) (= movimientos 9)) (equal? (substring string-juego (+ string-pos 16) (+ string-pos 17)) "0")) (and (and (>= (+ string-pos 32)  0) (<= (+ string-pos 32) 126)) (equal? (substring string-juego (+ string-pos 32) (+ string-pos 33)) "0")) (and (>= (+ string-pos 48)  0) (<= (+ string-pos 48) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 49) (+ string-pos 50)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 48) "tb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 16)  0) (<= (+ string-pos 16) 126) (= movimientos 10)) (equal? (substring string-juego (+ string-pos 16) (+ string-pos 17)) "0")) (and (and (>= (+ string-pos 32)  0) (<= (+ string-pos 32) 126)) (equal? (substring string-juego (+ string-pos 32) (+ string-pos 33)) "0")) (and (and (>= (+ string-pos 48)  0) (<= (+ string-pos 48) 126)) (equal? (substring string-juego (+ string-pos 48) (+ string-pos 49)) "0")) (and (>= (+ string-pos 64)  0) (<= (+ string-pos 64) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 65) (+ string-pos 66)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 64) "tb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 16)  0) (<= (+ string-pos 16) 126) (= movimientos 11)) (equal? (substring string-juego (+ string-pos 16) (+ string-pos 17)) "0")) (and (and (>= (+ string-pos 32)  0) (<= (+ string-pos 32) 126)) (equal? (substring string-juego (+ string-pos 32) (+ string-pos 33)) "0")) (and (and (>= (+ string-pos 48)  0) (<= (+ string-pos 48) 126)) (equal? (substring string-juego (+ string-pos 48) (+ string-pos 49)) "0")) (and (and (>= (+ string-pos 64)  0) (<= (+ string-pos 64) 126)) (equal? (substring string-juego (+ string-pos 64) (+ string-pos 65)) "0")) (and (>= (+ string-pos 80)  0) (<= (+ string-pos 80) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 81) (+ string-pos 82)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 80) "tb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 16)  0) (<= (+ string-pos 16) 126) (= movimientos 12)) (equal? (substring string-juego (+ string-pos 16) (+ string-pos 17)) "0")) (and (and (>= (+ string-pos 32)  0) (<= (+ string-pos 32) 126)) (equal? (substring string-juego (+ string-pos 32) (+ string-pos 33)) "0")) (and (and (>= (+ string-pos 48)  0) (<= (+ string-pos 48) 126)) (equal? (substring string-juego (+ string-pos 48) (+ string-pos 49)) "0")) (and (and (>= (+ string-pos 64)  0) (<= (+ string-pos 64) 126)) (equal? (substring string-juego (+ string-pos 64) (+ string-pos 65)) "0")) (and (and (>= (+ string-pos 80)  0) (<= (+ string-pos 80) 126)) (equal? (substring string-juego (+ string-pos 80) (+ string-pos 81)) "0")) (and (>= (+ string-pos 96)  0) (<= (+ string-pos 96) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 97) (+ string-pos 98)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 96) "tb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 16)  0) (<= (+ string-pos 16) 126) (= movimientos 13)) (equal? (substring string-juego (+ string-pos 16) (+ string-pos 17)) "0")) (and (and (>= (+ string-pos 32)  0) (<= (+ string-pos 32) 126)) (equal? (substring string-juego (+ string-pos 32) (+ string-pos 33)) "0")) (and (and (>= (+ string-pos 48)  0) (<= (+ string-pos 48) 126)) (equal? (substring string-juego (+ string-pos 48) (+ string-pos 49)) "0")) (and (and (>= (+ string-pos 64)  0) (<= (+ string-pos 64) 126)) (equal? (substring string-juego (+ string-pos 64) (+ string-pos 65)) "0")) (and (and (>= (+ string-pos 80)  0) (<= (+ string-pos 80) 126)) (equal? (substring string-juego (+ string-pos 80) (+ string-pos 81)) "0")) (and (and (>= (+ string-pos 96)  0) (<= (+ string-pos 96) 126)) (equal? (substring string-juego (+ string-pos 96) (+ string-pos 97)) "0")) (and (>= (+ string-pos 112)  0) (<= (+ string-pos 112) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 111) (+ string-pos 110)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 112) "tb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    #| movimientos derechos |#
                                                                    [(and (and (>= (+ string-pos 2)  0) (<= (+ string-pos 2) 126) (= movimientos 14)) (= (quotient string-pos 16) (quotient (+ string-pos 2) 16)) (equal? #f (equal? (substring string-juego (+ string-pos 3) (+ string-pos 4)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 2) "tb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 2)  0) (<= (+ string-pos 2) 126) (= movimientos 15)) (= (quotient string-pos 16) (quotient (+ string-pos 4) 16)) (equal? (substring string-juego (+ string-pos 2) (+ string-pos 3)) "0")) (and (>= (+ string-pos 4)  0) (<= (+ string-pos 4) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 5) (+ string-pos 6)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 4) "tb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 2)  0) (<= (+ string-pos 2) 126) (= movimientos 16)) (= (quotient string-pos 16) (quotient (+ string-pos 6) 16)) (equal? (substring string-juego (+ string-pos 2) (+ string-pos 3)) "0")) (and (and (>= (+ string-pos 4)  0) (<= (+ string-pos 4) 126)) (equal? (substring string-juego (+ string-pos 4) (+ string-pos 5)) "0")) (and (>= (+ string-pos 6)  0) (<= (+ string-pos 6) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 7) (+ string-pos 8)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 6) "tb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 2)  0) (<= (+ string-pos 2) 126) (= movimientos 17)) (= (quotient string-pos 16) (quotient (+ string-pos 8) 16)) (equal? (substring string-juego (+ string-pos 2) (+ string-pos 3)) "0")) (and (and (>= (+ string-pos 4)  0) (<= (+ string-pos 4) 126)) (equal? (substring string-juego (+ string-pos 4) (+ string-pos 5)) "0")) (and (and (>= (+ string-pos 6)  0) (<= (+ string-pos 6) 126)) (equal? (substring string-juego (+ string-pos 6) (+ string-pos 7)) "0")) (and (>= (+ string-pos 8)  0) (<= (+ string-pos 8) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 9) (+ string-pos 10)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 8) "tb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 2)  0) (<= (+ string-pos 2) 126) (= movimientos 18)) (= (quotient string-pos 16) (quotient (+ string-pos 10) 16)) (equal? (substring string-juego (+ string-pos 2) (+ string-pos 3)) "0")) (and (and (>= (+ string-pos 4)  0) (<= (+ string-pos 4) 126)) (equal? (substring string-juego (+ string-pos 4) (+ string-pos 5)) "0")) (and (and (>= (+ string-pos 6)  0) (<= (+ string-pos 6) 126)) (equal? (substring string-juego (+ string-pos 6) (+ string-pos 7)) "0")) (and (and (>= (+ string-pos 8)  0) (<= (+ string-pos 8) 126)) (equal? (substring string-juego (+ string-pos 8) (+ string-pos 9)) "0")) (and (>= (+ string-pos 10)  0) (<= (+ string-pos 10) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 11) (+ string-pos 12)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 10) "tb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 2)  0) (<= (+ string-pos 2) 126) (= movimientos 19)) (= (quotient string-pos 16) (quotient (+ string-pos 12) 16)) (equal? (substring string-juego (+ string-pos 2) (+ string-pos 3)) "0")) (and (and (>= (+ string-pos 4)  0) (<= (+ string-pos 4) 126)) (equal? (substring string-juego (+ string-pos 4) (+ string-pos 5)) "0")) (and (and (>= (+ string-pos 6)  0) (<= (+ string-pos 6) 126)) (equal? (substring string-juego (+ string-pos 6) (+ string-pos 7)) "0")) (and (and (>= (+ string-pos 8)  0) (<= (+ string-pos 8) 126)) (equal? (substring string-juego (+ string-pos 8) (+ string-pos 9)) "0")) (and (and (>= (+ string-pos 10)  0) (<= (+ string-pos 10) 126)) (equal? (substring string-juego (+ string-pos 10) (+ string-pos 11)) "0")) (and (>= (+ string-pos 12)  0) (<= (+ string-pos 12) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 13) (+ string-pos 14)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 12) "tb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 2)  0) (<= (+ string-pos 2) 126) (= movimientos 20)) (= (quotient string-pos 16) (quotient (+ string-pos 14) 16)) (equal? (substring string-juego (+ string-pos 2) (+ string-pos 3)) "0")) (and (and (>= (+ string-pos 4)  0) (<= (+ string-pos 4) 126)) (equal? (substring string-juego (+ string-pos 4) (+ string-pos 5)) "0")) (and (and (>= (+ string-pos 6)  0) (<= (+ string-pos 6) 126)) (equal? (substring string-juego (+ string-pos 6) (+ string-pos 7)) "0")) (and (and (>= (+ string-pos 8)  0) (<= (+ string-pos 8) 126)) (equal? (substring string-juego (+ string-pos 8) (+ string-pos 9)) "0")) (and (and (>= (+ string-pos 10)  0) (<= (+ string-pos 10) 126)) (equal? (substring string-juego (+ string-pos 10) (+ string-pos 11)) "0")) (and (and (>= (+ string-pos 12)  0) (<= (+ string-pos 12) 126)) (equal? (substring string-juego (+ string-pos 12) (+ string-pos 13)) "0")) (and (>= (+ string-pos 14)  0) (<= (+ string-pos 14) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 15) (+ string-pos 16)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 14) "tb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    #| movimientos izquierdos |#
                                                                    [(and (and (>= (- string-pos 2)  0) (<= (- string-pos 2) 126) (= movimientos 21)) (= (quotient string-pos 16) (quotient (- string-pos 2) 16)) (equal? #f (equal? (substring string-juego (- string-pos 1) (- string-pos 0)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 2) "tb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 2)  0) (<= (- string-pos 2) 126) (= movimientos 22)) (= (quotient string-pos 16) (quotient (- string-pos 4) 16)) (equal? (substring string-juego (- string-pos 2) (- string-pos 1)) "0")) (and (>= (- string-pos 4)  0) (<= (- string-pos 4) 126)) (equal? #f (equal? (substring string-juego (- string-pos 3) (- string-pos 2)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 4) "tb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 2)  0) (<= (- string-pos 2) 126) (= movimientos 23)) (= (quotient string-pos 16) (quotient (- string-pos 6) 16)) (equal? (substring string-juego (- string-pos 2) (- string-pos 1)) "0")) (and (and (>= (- string-pos 4)  0) (<= (- string-pos 4) 126)) (equal? (substring string-juego (- string-pos 4) (- string-pos 3)) "0")) (and (>= (- string-pos 6)  0) (<= (- string-pos 6) 126)) (equal? #f (equal? (substring string-juego (- string-pos 5) (- string-pos 4)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 6) "tb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 2)  0) (<= (- string-pos 2) 126) (= movimientos 24)) (= (quotient string-pos 16) (quotient (- string-pos 8) 16)) (equal? (substring string-juego (- string-pos 2) (- string-pos 1)) "0")) (and (and (>= (- string-pos 4)  0) (<= (- string-pos 4) 126)) (equal? (substring string-juego (- string-pos 4) (- string-pos 3)) "0")) (and (and (>= (- string-pos 6)  0) (<= (- string-pos 6) 126)) (equal? (substring string-juego (- string-pos 6) (- string-pos 5)) "0")) (and (>= (- string-pos 8)  0) (<= (- string-pos 8) 126)) (equal? #f (equal? (substring string-juego (- string-pos 7) (- string-pos 6)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 8) "tb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 2)  0) (<= (- string-pos 2) 126) (= movimientos 25)) (= (quotient string-pos 16) (quotient (- string-pos 10) 16)) (equal? (substring string-juego (- string-pos 2) (- string-pos 1)) "0")) (and (and (>= (- string-pos 4)  0) (<= (- string-pos 4) 126)) (equal? (substring string-juego (- string-pos 4) (- string-pos 3)) "0")) (and (and (>= (- string-pos 6)  0) (<= (- string-pos 6) 126)) (equal? (substring string-juego (- string-pos 6) (- string-pos 5)) "0")) (and (and (>= (- string-pos 8)  0) (<= (- string-pos 8) 126)) (equal? (substring string-juego (- string-pos 8) (- string-pos 7)) "0")) (and (>= (- string-pos 10)  0) (<= (- string-pos 10) 126)) (equal? #f (equal? (substring string-juego (- string-pos 9) (- string-pos 8)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 10) "tb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 2)  0) (<= (- string-pos 2) 126) (= movimientos 26)) (= (quotient string-pos 16) (quotient (- string-pos 12) 16)) (equal? (substring string-juego (- string-pos 2) (- string-pos 1)) "0")) (and (and (>= (- string-pos 4)  0) (<= (- string-pos 4) 126)) (equal? (substring string-juego (- string-pos 4) (- string-pos 3)) "0")) (and (and (>= (- string-pos 6)  0) (<= (- string-pos 6) 126)) (equal? (substring string-juego (- string-pos 6) (- string-pos 5)) "0")) (and (and (>= (- string-pos 8)  0) (<= (- string-pos 8) 126)) (equal? (substring string-juego (- string-pos 8) (- string-pos 7)) "0")) (and (and (>= (- string-pos 10)  0) (<= (- string-pos 10) 126)) (equal? (substring string-juego (- string-pos 10) (- string-pos 9)) "0")) (and (>= (- string-pos 12)  0) (<= (- string-pos 12) 126)) (equal? #f (equal? (substring string-juego (- string-pos 11) (- string-pos 10)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 12) "tb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 2)  0) (<= (- string-pos 2) 126) (= movimientos 27)) (= (quotient string-pos 16) (quotient (- string-pos 14) 16)) (equal? (substring string-juego (- string-pos 2) (- string-pos 1)) "0")) (and (and (>= (- string-pos 4)  0) (<= (- string-pos 4) 126)) (equal? (substring string-juego (- string-pos 4) (- string-pos 3)) "0")) (and (and (>= (- string-pos 6)  0) (<= (- string-pos 6) 126)) (equal? (substring string-juego (- string-pos 6) (- string-pos 5)) "0")) (and (and (>= (- string-pos 8)  0) (<= (- string-pos 8) 126)) (equal? (substring string-juego (- string-pos 8) (- string-pos 7)) "0")) (and (and (>= (- string-pos 10)  0) (<= (- string-pos 10) 126)) (equal? (substring string-juego (- string-pos 10) (- string-pos 9)) "0")) (and (and (>= (- string-pos 12)  0) (<= (- string-pos 12) 126)) (equal? (substring string-juego (- string-pos 12) (- string-pos 11)) "0")) (and (>= (- string-pos 14)  0) (<= (- string-pos 14) 126)) (equal? #f (equal? (substring string-juego (- string-pos 13) (- string-pos 12)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 14) "tb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    ; no se puede hacer el movimiento.
                                                                    [else (jaque-mate-blanco string-pos (+ movimientos 1))]
                                                                  ); fin cond
                                                              ; de lo contrario
                                                                  #| la torre no elimna el jaque o el posible mate |#
                                                                  (jaque-mate-blanco (+ string-pos 2) 0)
                                                              ); fin if
        ]; de lo contrario
        [(equal? (substring string-juego string-pos (+ string-pos 1)) "c") (if (<= movimientos 7)
                                                                  (cond
                                                                    [(and (>= (- string-pos 34) 0) (<= (- string-pos 34) 126) (= movimientos 0) (and (> (quotient string-pos 16) (quotient (- string-pos 34) 16)) (> (remainder string-pos 16) (remainder (- string-pos 34) 16))) (equal? #f (equal? (substring string-juego (- string-pos 33) (- string-pos 32)) "b")))
                                                                                            (string-copy! string-juego string-pos "00")
                                                                                            (string-copy! string-juego (- string-pos 34) "cb")
                                                                                            (if (equal? (jaque 0 "rb") #t)
                                                                                                (begin
                                                                                                  (string-copy! string-juego 0 string-juego-copy)
                                                                                                  (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                ); fin begin true
                                                                                            ; de lo contrario
                                                                                                (begin
                                                                                                  (string-copy! string-juego 0 string-juego-copy)
                                                                                                  #f
                                                                                                ); fin begin false
                                                                                            ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (>= (- string-pos 30) 0) (<= (- string-pos 30) 126) (= movimientos 1) (and (> (quotient string-pos 16) (quotient (- string-pos 30) 16)) (< (remainder string-pos 16) (remainder (- string-pos 30) 16))) (equal? #f (equal? (substring string-juego (- string-pos 29) (- string-pos 28)) "b")))
                                                                                            (string-copy! string-juego string-pos "00")
                                                                                            (string-copy! string-juego (- string-pos 30) "cb")
                                                                                            (if (equal? (jaque 0 "rb") #t)
                                                                                                (begin
                                                                                                  (string-copy! string-juego 0 string-juego-copy)
                                                                                                  (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                ); fin begin true
                                                                                            ; de lo contrario
                                                                                                (begin
                                                                                                  (string-copy! string-juego 0 string-juego-copy)
                                                                                                  #f
                                                                                                ); fin begin false
                                                                                            ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (>= (- string-pos 20) 0) (<= (- string-pos 20) 126) (= movimientos 2) (and (> (quotient string-pos 16) (quotient (- string-pos 20) 16)) (> (remainder string-pos 16) (remainder (- string-pos 20) 16))) (equal? #f (equal? (substring string-juego (- string-pos 19) (- string-pos 18)) "b")))
                                                                                            (string-copy! string-juego string-pos "00")
                                                                                            (string-copy! string-juego (- string-pos 20) "cb")
                                                                                            (if (equal? (jaque 0 "rb") #t)
                                                                                                (begin
                                                                                                  (string-copy! string-juego 0 string-juego-copy)
                                                                                                  (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                ); fin begin true
                                                                                            ; de lo contrario
                                                                                                (begin
                                                                                                  (string-copy! string-juego 0 string-juego-copy)
                                                                                                  #f
                                                                                                ); fin begin false
                                                                                            ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (>= (- string-pos 12) 0) (<= (- string-pos 12) 126) (= movimientos 3) (and (> (quotient string-pos 16) (quotient (- string-pos 12) 16)) (< (remainder string-pos 16) (remainder (- string-pos 12) 16))) (equal? #f (equal? (substring string-juego (- string-pos 11) (- string-pos 10)) "b")))
                                                                                            (string-copy! string-juego string-pos "00")
                                                                                            (string-copy! string-juego (- string-pos 12) "cb")
                                                                                            (if (equal? (jaque 0 "rb") #t)
                                                                                                (begin
                                                                                                  (string-copy! string-juego 0 string-juego-copy)
                                                                                                  (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                ); fin begin true
                                                                                            ; de lo contrario
                                                                                                (begin
                                                                                                  (string-copy! string-juego 0 string-juego-copy)
                                                                                                  #f
                                                                                                ); fin begin false
                                                                                            ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (>= (+ string-pos 12) 0) (<= (+ string-pos 12) 126) (= movimientos 4) (and (< (quotient string-pos 16) (quotient (+ string-pos 12) 16)) (> (remainder string-pos 16) (remainder (+ string-pos 12) 16))) (equal? #f (equal? (substring string-juego (+ string-pos 13) (+ string-pos 14)) "b")))
                                                                                            (string-copy! string-juego string-pos "00")
                                                                                            (string-copy! string-juego (+ string-pos 12) "cb")
                                                                                            (if (equal? (jaque 0 "rb") #t)
                                                                                                (begin
                                                                                                  (string-copy! string-juego 0 string-juego-copy)
                                                                                                  (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                ); fin begin true
                                                                                            ; de lo contrario
                                                                                                (begin
                                                                                                  (string-copy! string-juego 0 string-juego-copy)
                                                                                                  #f
                                                                                                ); fin begin false
                                                                                            ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (>= (+ string-pos 20) 0) (<= (+ string-pos 20) 126) (= movimientos 5) (and (< (quotient string-pos 16) (quotient (+ string-pos 20) 16)) (< (remainder string-pos 16) (remainder (+ string-pos 20) 16))) (equal? #f (equal? (substring string-juego (+ string-pos 21) (+ string-pos 22)) "b")))
                                                                                            (string-copy! string-juego string-pos "00")
                                                                                            (string-copy! string-juego (+ string-pos 20) "cb")
                                                                                            (if (equal? (jaque 0 "rb") #t)
                                                                                                (begin
                                                                                                  (string-copy! string-juego 0 string-juego-copy)
                                                                                                  (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                ); fin begin true
                                                                                            ; de lo contrario
                                                                                                (begin
                                                                                                  (string-copy! string-juego 0 string-juego-copy)
                                                                                                  #f
                                                                                                ); fin begin false
                                                                                            ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (>= (+ string-pos 30) 0) (<= (+ string-pos 30) 126) (= movimientos 6) (and (< (quotient string-pos 16) (quotient (+ string-pos 30) 16)) (> (remainder string-pos 16) (remainder (+ string-pos 30) 16))) (equal? #f (equal? (substring string-juego (+ string-pos 31) (+ string-pos 32)) "b")))
                                                                                            (string-copy! string-juego string-pos "00")
                                                                                            (string-copy! string-juego (+ string-pos 30) "cb")
                                                                                            (if (equal? (jaque 0 "rb") #t)
                                                                                                (begin
                                                                                                  (string-copy! string-juego 0 string-juego-copy)
                                                                                                  (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                ); fin begin true
                                                                                            ; de lo contrario
                                                                                                (begin
                                                                                                  (string-copy! string-juego 0 string-juego-copy)
                                                                                                  #f
                                                                                                ); fin begin false
                                                                                            ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (>= (+ string-pos 34) 0) (<= (+ string-pos 34) 126) (= movimientos 7) (and (< (quotient string-pos 16) (quotient (+ string-pos 34) 16)) (< (remainder string-pos 16) (remainder (+ string-pos 34) 16))) (equal? #f (equal? (substring string-juego (+ string-pos 35) (+ string-pos 36)) "b")))
                                                                                            (string-copy! string-juego string-pos "00")
                                                                                            (string-copy! string-juego (+ string-pos 34) "cb")
                                                                                            (if (equal? (jaque 0 "rb") #t)
                                                                                                (begin
                                                                                                  (string-copy! string-juego 0 string-juego-copy)
                                                                                                  (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                ); fin begin true
                                                                                            ; de lo contrario
                                                                                                (begin
                                                                                                  (string-copy! string-juego 0 string-juego-copy)
                                                                                                  #f
                                                                                                ); fin begin false
                                                                                            ); fin if
                                                                    ]; de lo contrario
                                                                    ; no se puede hacer el movimiento
                                                                    [else (jaque-mate-blanco string-pos (+ movimientos 1))]
                                                                  ); fin cond
                                                              ; de lo contrario
                                                                  #| el caballo no elimna el jaque o el posible mate |#
                                                                  (jaque-mate-blanco (+ string-pos 2) 0)
                                                              ); fin if
        ]; de lo contrario
        [(equal? (substring string-juego string-pos (+ string-pos 1)) "a") (if (<= movimientos 27)
                                                                  (cond
                                                                    #| movimientos arriba a la izquierda |#
                                                                    [(and (and (>= (- string-pos 18)  0) (<= (- string-pos 18) 126)) (= movimientos 0) (and (> (quotient string-pos 16) (quotient (- string-pos 18) 16)) (> (remainder string-pos 16) (remainder (- string-pos 18) 16)))  (equal? #f (equal? (substring string-juego (- string-pos 17) (- string-pos 16)) "b"))) 
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 18) "ab")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 18)  0) (<= (- string-pos 18) 126) (= movimientos 1)) (and (> (quotient string-pos 16) (quotient (- string-pos 36) 16)) (> (remainder string-pos 16) (remainder (- string-pos 36) 16))) (equal? (substring string-juego (- string-pos 18) (- string-pos 17)) "0")) (and (>= (- string-pos 36)  0) (<= (- string-pos 36) 126)) (equal? #f (equal? (substring string-juego (- string-pos 35) (- string-pos 34)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 36) "ab")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 18)  0) (<= (- string-pos 18) 126) (= movimientos 2)) (and (> (quotient string-pos 16) (quotient (- string-pos 54) 16)) (> (remainder string-pos 16) (remainder (- string-pos 54) 16))) (equal? (substring string-juego (- string-pos 18) (- string-pos 17)) "0")) (and (and (>= (- string-pos 36)  0) (<= (- string-pos 36) 126)) (equal? (substring string-juego (- string-pos 36) (- string-pos 35)) "0")) (and (>= (- string-pos 54)  0) (<= (- string-pos 54) 126)) (equal? #f (equal? (substring string-juego (- string-pos 53) (- string-pos 52)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 54) "ab")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 18)  0) (<= (- string-pos 18) 126) (= movimientos 3)) (and (> (quotient string-pos 16) (quotient (- string-pos 72) 16)) (> (remainder string-pos 16) (remainder (- string-pos 72) 16))) (equal? (substring string-juego (- string-pos 18) (- string-pos 17)) "0")) (and (and (>= (- string-pos 36)  0) (<= (- string-pos 36) 126)) (equal? (substring string-juego (- string-pos 36) (- string-pos 35)) "0")) (and (and (>= (- string-pos 54)  0) (<= (- string-pos 54) 126)) (equal? (substring string-juego (- string-pos 54) (- string-pos 53)) "0")) (and (>= (- string-pos 72)  0) (<= (- string-pos 72) 126)) (equal? #f (equal? (substring string-juego (- string-pos 71) (- string-pos 70)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 72) "ab")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 18)  0) (<= (- string-pos 18) 126) (= movimientos 4)) (and (> (quotient string-pos 16) (quotient (- string-pos 90) 16)) (> (remainder string-pos 16) (remainder (- string-pos 90) 16))) (equal? (substring string-juego (- string-pos 18) (- string-pos 17)) "0")) (and (and (>= (- string-pos 36)  0) (<= (- string-pos 36) 126)) (equal? (substring string-juego (- string-pos 36) (- string-pos 35)) "0")) (and (and (>= (- string-pos 54)  0) (<= (- string-pos 54) 126)) (equal? (substring string-juego (- string-pos 54) (- string-pos 53)) "0")) (and (and (>= (- string-pos 72)  0) (<= (- string-pos 72) 126)) (equal? (substring string-juego (- string-pos 72) (- string-pos 71)) "0")) (and (>= (- string-pos 90)  0) (<= (- string-pos 90) 126)) (equal? #f (equal? (substring string-juego (- string-pos 89) (- string-pos 88)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 90) "ab")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 18)  0) (<= (- string-pos 18) 126) (= movimientos 5)) (and (> (quotient string-pos 16) (quotient (- string-pos 108) 16)) (> (remainder string-pos 16) (remainder (- string-pos 108) 16))) (equal? (substring string-juego (- string-pos 18) (- string-pos 17)) "0")) (and (and (>= (- string-pos 36)  0) (<= (- string-pos 36) 126)) (equal? (substring string-juego (- string-pos 36) (- string-pos 35)) "0")) (and (and (>= (- string-pos 54)  0) (<= (- string-pos 54) 126)) (equal? (substring string-juego (- string-pos 54) (- string-pos 53)) "0")) (and (and (>= (- string-pos 72)  0) (<= (- string-pos 72) 126)) (equal? (substring string-juego (- string-pos 72) (- string-pos 71)) "0")) (and (and (>= (- string-pos 90)  0) (<= (- string-pos 90) 126)) (equal? (substring string-juego (- string-pos 90) (- string-pos 89)) "0")) (and (>= (- string-pos 108)  0) (<= (- string-pos 108) 126)) (equal? #f (equal? (substring string-juego (- string-pos 107) (- string-pos 106)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 108) "ab")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 18)  0) (<= (- string-pos 18) 126) (= movimientos 6)) (and (> (quotient string-pos 16) (quotient (- string-pos 126) 16)) (> (remainder string-pos 16) (remainder (- string-pos 126) 16))) (equal? (substring string-juego (- string-pos 18) (- string-pos 17)) "0")) (and (and (>= (- string-pos 36)  0) (<= (- string-pos 36) 126)) (equal? (substring string-juego (- string-pos 36) (- string-pos 35)) "0")) (and (and (>= (- string-pos 54)  0) (<= (- string-pos 54) 126)) (equal? (substring string-juego (- string-pos 54) (- string-pos 53)) "0")) (and (and (>= (- string-pos 72)  0) (<= (- string-pos 72) 126)) (equal? (substring string-juego (- string-pos 72) (- string-pos 71)) "0")) (and (and (>= (- string-pos 90)  0) (<= (- string-pos 90) 126)) (equal? (substring string-juego (- string-pos 90) (- string-pos 89)) "0")) (and (and (>= (- string-pos 108)  0) (<= (- string-pos 108) 126)) (equal? (substring string-juego (- string-pos 108) (- string-pos 107)) "0")) (and (>= (- string-pos 126)  0) (<= (- string-pos 126) 126)) (equal? #f (equal? (substring string-juego (- string-pos 125) (- string-pos 124)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 126) "ab")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    #| movimientos abajo a la derecha |#
                                                                    [(and (and (>= (+ string-pos 18)  0) (<= (+ string-pos 18) 126) (= movimientos 7)) (and (< (quotient string-pos 16) (quotient (+ string-pos 18) 16)) (< (remainder string-pos 16) (remainder (+ string-pos 18) 16))) (equal? #f (equal? (substring string-juego (+ string-pos 19) (+ string-pos 20)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 18) "ab")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 18)  0) (<= (+ string-pos 18) 126) (= movimientos 8)) (and (< (quotient string-pos 16) (quotient (+ string-pos 36) 16)) (< (remainder string-pos 16) (remainder (+ string-pos 36) 16))) (equal? (substring string-juego (+ string-pos 18) (+ string-pos 19)) "0")) (and (>= (+ string-pos 36)  0) (<= (+ string-pos 36) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 37) (+ string-pos 38)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 36) "ab")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 18)  0) (<= (+ string-pos 18) 126) (= movimientos 9)) (and (< (quotient string-pos 16) (quotient (+ string-pos 54) 16)) (< (remainder string-pos 16) (remainder (+ string-pos 54) 16))) (equal? (substring string-juego (+ string-pos 18) (+ string-pos 19)) "0")) (and (and (>= (+ string-pos 36)  0) (<= (+ string-pos 36) 126)) (equal? (substring string-juego (+ string-pos 36) (+ string-pos 37)) "0")) (and (>= (+ string-pos 54)  0) (<= (+ string-pos 54) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 55) (+ string-pos 56)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 54) "ab")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 18)  0) (<= (+ string-pos 18) 126) (= movimientos 10)) (and (< (quotient string-pos 16) (quotient (+ string-pos 72) 16)) (< (remainder string-pos 16) (remainder (+ string-pos 72) 16))) (equal? (substring string-juego (+ string-pos 18) (+ string-pos 19)) "0")) (and (and (>= (+ string-pos 36)  0) (<= (+ string-pos 36) 126)) (equal? (substring string-juego (+ string-pos 36) (+ string-pos 37)) "0")) (and (and (>= (+ string-pos 54)  0) (<= (+ string-pos 54) 126)) (equal? (substring string-juego (+ string-pos 54) (+ string-pos 55)) "0")) (and (>= (+ string-pos 72)  0) (<= (+ string-pos 72) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 73) (+ string-pos 74)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 72) "ab")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 18)  0) (<= (+ string-pos 18) 126) (= movimientos 11)) (and (< (quotient string-pos 16) (quotient (+ string-pos 90) 16)) (< (remainder string-pos 16) (remainder (+ string-pos 90) 16))) (equal? (substring string-juego (+ string-pos 18) (+ string-pos 19)) "0")) (and (and (>= (+ string-pos 36)  0) (<= (+ string-pos 36) 126)) (equal? (substring string-juego (+ string-pos 36) (+ string-pos 37)) "0")) (and (and (>= (+ string-pos 54)  0) (<= (+ string-pos 54) 126)) (equal? (substring string-juego (+ string-pos 54) (+ string-pos 55)) "0")) (and (and (>= (+ string-pos 72)  0) (<= (+ string-pos 72) 126)) (equal? (substring string-juego (+ string-pos 72) (+ string-pos 73)) "0")) (and (>= (+ string-pos 90)  0) (<= (+ string-pos 90) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 91) (+ string-pos 92)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 90) "ab")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 18)  0) (<= (+ string-pos 18) 126) (= movimientos 12)) (and (< (quotient string-pos 16) (quotient (+ string-pos 108) 16)) (< (remainder string-pos 16) (remainder (+ string-pos 108) 16))) (equal? (substring string-juego (+ string-pos 18) (+ string-pos 19)) "0")) (and (and (>= (+ string-pos 36)  0) (<= (+ string-pos 36) 126)) (equal? (substring string-juego (+ string-pos 36) (+ string-pos 37)) "0")) (and (and (>= (+ string-pos 54)  0) (<= (+ string-pos 54) 126)) (equal? (substring string-juego (+ string-pos 54) (+ string-pos 55)) "0")) (and (and (>= (+ string-pos 72)  0) (<= (+ string-pos 72) 126)) (equal? (substring string-juego (+ string-pos 72) (+ string-pos 73)) "0")) (and (and (>= (+ string-pos 90)  0) (<= (+ string-pos 90) 126)) (equal? (substring string-juego (+ string-pos 90) (+ string-pos 91)) "0")) (and (>= (+ string-pos 108)  0) (<= (+ string-pos 108) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 109) (+ string-pos 110)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 108) "ab")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 18)  0) (<= (+ string-pos 18) 126) (= movimientos 13)) (and (< (quotient string-pos 16) (quotient (+ string-pos 126) 16)) (< (remainder string-pos 16) (remainder (+ string-pos 126) 16))) (equal? (substring string-juego (+ string-pos 18) (+ string-pos 19)) "0")) (and (and (>= (+ string-pos 36)  0) (<= (+ string-pos 36) 126)) (equal? (substring string-juego (+ string-pos 36) (+ string-pos 37)) "0")) (and (and (>= (+ string-pos 54)  0) (<= (+ string-pos 54) 126)) (equal? (substring string-juego (+ string-pos 54) (+ string-pos 55)) "0")) (and (and (>= (+ string-pos 72)  0) (<= (+ string-pos 72) 126)) (equal? (substring string-juego (+ string-pos 72) (+ string-pos 73)) "0")) (and (and (>= (+ string-pos 90)  0) (<= (+ string-pos 90) 126)) (equal? (substring string-juego (+ string-pos 90) (+ string-pos 91)) "0")) (and (and (>= (+ string-pos 108)  0) (<= (+ string-pos 108) 126)) (equal? (substring string-juego (+ string-pos 108) (+ string-pos 109)) "0")) (and (>= (+ string-pos 126)  0) (<= (+ string-pos 126) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 127) (+ string-pos 128)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 126) "ab")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    #| movimientos abajo a la izquierda |#
                                                                    [(and (and (>= (+ string-pos 14)  0) (<= (+ string-pos 14) 126) (= movimientos 14)) (and (< (quotient string-pos 16) (quotient (+ string-pos 14) 16)) (> (remainder string-pos 16) (remainder (+ string-pos 14) 16))) (equal? #f (equal? (substring string-juego (+ string-pos 15) (+ string-pos 16)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 14) "ab")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 14)  0) (<= (+ string-pos 14) 126) (= movimientos 15)) (and (< (quotient string-pos 16) (quotient (+ string-pos 28) 16)) (> (remainder string-pos 16) (remainder (+ string-pos 28) 16))) (equal? (substring string-juego (+ string-pos 14) (+ string-pos 15)) "0")) (and (>= (+ string-pos 28)  0) (<= (+ string-pos 28) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 29) (+ string-pos 30)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 28) "ab")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 14)  0) (<= (+ string-pos 14) 126) (= movimientos 16)) (and (< (quotient string-pos 16) (quotient (+ string-pos 42) 16)) (> (remainder string-pos 16) (remainder (+ string-pos 42) 16))) (equal? (substring string-juego (+ string-pos 14) (+ string-pos 15)) "0")) (and (and (>= (+ string-pos 28)  0) (<= (+ string-pos 28) 126)) (equal? (substring string-juego (+ string-pos 28) (+ string-pos 29)) "0")) (and (>= (+ string-pos 42)  0) (<= (+ string-pos 42) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 43) (+ string-pos 44)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 42) "ab")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 14)  0) (<= (+ string-pos 14) 126) (= movimientos 17)) (and (< (quotient string-pos 16) (quotient (+ string-pos 54) 16)) (> (remainder string-pos 16) (remainder (+ string-pos 54) 16))) (equal? (substring string-juego (+ string-pos 14) (+ string-pos 15)) "0")) (and (and (>= (+ string-pos 28)  0) (<= (+ string-pos 28) 126)) (equal? (substring string-juego (+ string-pos 28) (+ string-pos 29)) "0")) (and (and (>= (+ string-pos 42)  0) (<= (+ string-pos 42) 126)) (equal? (substring string-juego (+ string-pos 42) (+ string-pos 43)) "0")) (and (>= (+ string-pos 56)  0) (<= (+ string-pos 56) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 57) (+ string-pos 58)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 54) "ab")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 14)  0) (<= (+ string-pos 14) 126) (= movimientos 18)) (and (< (quotient string-pos 16) (quotient (+ string-pos 70) 16)) (> (remainder string-pos 16) (remainder (+ string-pos 70) 16))) (equal? (substring string-juego (+ string-pos 14) (+ string-pos 15)) "0")) (and (and (>= (+ string-pos 28)  0) (<= (+ string-pos 28) 126)) (equal? (substring string-juego (+ string-pos 28) (+ string-pos 29)) "0")) (and (and (>= (+ string-pos 42)  0) (<= (+ string-pos 42) 126)) (equal? (substring string-juego (+ string-pos 42) (+ string-pos 43)) "0")) (and (and (>= (+ string-pos 56)  0) (<= (+ string-pos 56) 126)) (equal? (substring string-juego (+ string-pos 56) (+ string-pos 57)) "0")) (and (>= (+ string-pos 70)  0) (<= (+ string-pos 70) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 71) (+ string-pos 72)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 70) "ab")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 14)  0) (<= (+ string-pos 14) 126) (= movimientos 19)) (and (< (quotient string-pos 16) (quotient (+ string-pos 84) 16)) (> (remainder string-pos 16) (remainder (+ string-pos 84) 16))) (equal? (substring string-juego (+ string-pos 14) (+ string-pos 15)) "0")) (and (and (>= (+ string-pos 28)  0) (<= (+ string-pos 28) 126)) (equal? (substring string-juego (+ string-pos 28) (+ string-pos 29)) "0")) (and (and (>= (+ string-pos 42)  0) (<= (+ string-pos 42) 126)) (equal? (substring string-juego (+ string-pos 42) (+ string-pos 43)) "0")) (and (and (>= (+ string-pos 56)  0) (<= (+ string-pos 56) 126)) (equal? (substring string-juego (+ string-pos 56) (+ string-pos 57)) "0")) (and (and (>= (+ string-pos 70)  0) (<= (+ string-pos 70) 126)) (equal? (substring string-juego (+ string-pos 70) (+ string-pos 71)) "0")) (and (>= (+ string-pos 84)  0) (<= (+ string-pos 84) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 85) (+ string-pos 86)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 84) "ab")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 14)  0) (<= (+ string-pos 14) 126) (= movimientos 20)) (and (< (quotient string-pos 16) (quotient (+ string-pos 98) 16)) (> (remainder string-pos 16) (remainder (+ string-pos 98) 16))) (equal? (substring string-juego (+ string-pos 14) (+ string-pos 15)) "0")) (and (and (>= (+ string-pos 28)  0) (<= (+ string-pos 28) 126)) (equal? (substring string-juego (+ string-pos 28) (+ string-pos 29)) "0")) (and (and (>= (+ string-pos 42)  0) (<= (+ string-pos 42) 126)) (equal? (substring string-juego (+ string-pos 42) (+ string-pos 43)) "0")) (and (and (>= (+ string-pos 56)  0) (<= (+ string-pos 56) 126)) (equal? (substring string-juego (+ string-pos 56) (+ string-pos 57)) "0")) (and (and (>= (+ string-pos 70)  0) (<= (+ string-pos 70) 126)) (equal? (substring string-juego (+ string-pos 70) (+ string-pos 71)) "0")) (and (and (>= (+ string-pos 84)  0) (<= (+ string-pos 84) 126)) (equal? (substring string-juego (+ string-pos 84) (+ string-pos 85)) "0")) (and (>= (+ string-pos 98)  0) (<= (+ string-pos 98) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 99) (+ string-pos 100)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 98) "ab")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    #| movimientos arriba a la derecha |#
                                                                    [(and (and (>= (- string-pos 14)  0) (<= (- string-pos 14) 126) (= movimientos 14)) (and (> (quotient string-pos 16) (quotient (- string-pos 14) 16)) (< (remainder string-pos 16) (remainder (- string-pos 14) 16))) (equal? #f (equal? (substring string-juego (- string-pos 13) (- string-pos 12)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 14) "ab")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 14)  0) (<= (- string-pos 14) 126) (= movimientos 15)) (and (> (quotient string-pos 16) (quotient (- string-pos 28) 16)) (< (remainder string-pos 16) (remainder (- string-pos 28) 16))) (equal? (substring string-juego (- string-pos 14) (- string-pos 13)) "0")) (and (>= (- string-pos 28)  0) (<= (- string-pos 28) 126)) (equal? #f (equal? (substring string-juego (- string-pos 27) (- string-pos 26)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 28) "ab")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 14)  0) (<= (- string-pos 14) 126) (= movimientos 16)) (and (> (quotient string-pos 16) (quotient (- string-pos 42) 16)) (< (remainder string-pos 16) (remainder (- string-pos 42) 16))) (equal? (substring string-juego (- string-pos 14) (- string-pos 13)) "0")) (and (and (>= (- string-pos 28)  0) (<= (- string-pos 28) 126)) (equal? (substring string-juego (- string-pos 28) (- string-pos 27)) "0")) (and (>= (- string-pos 42)  0) (<= (- string-pos 42) 126)) (equal? #f (equal? (substring string-juego (- string-pos 41) (- string-pos 40)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 42) "ab")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 14)  0) (<= (- string-pos 14) 126) (= movimientos 17)) (and (> (quotient string-pos 16) (quotient (- string-pos 54) 16)) (< (remainder string-pos 16) (remainder (- string-pos 54) 16))) (equal? (substring string-juego (- string-pos 14) (- string-pos 13)) "0")) (and (and (>= (- string-pos 28)  0) (<= (- string-pos 28) 126)) (equal? (substring string-juego (- string-pos 28) (- string-pos 27)) "0")) (and (and (>= (- string-pos 42)  0) (<= (- string-pos 42) 126)) (equal? (substring string-juego (- string-pos 42) (- string-pos 41)) "0")) (and (>= (- string-pos 56)  0) (<= (- string-pos 56) 126)) (equal? #f (equal? (substring string-juego (- string-pos 55) (- string-pos 54)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 54) "ab")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 14)  0) (<= (- string-pos 14) 126) (= movimientos 18)) (and (> (quotient string-pos 16) (quotient (- string-pos 70) 16)) (< (remainder string-pos 16) (remainder (- string-pos 70) 16))) (equal? (substring string-juego (- string-pos 14) (- string-pos 13)) "0")) (and (and (>= (- string-pos 28)  0) (<= (- string-pos 28) 126)) (equal? (substring string-juego (- string-pos 28) (- string-pos 27)) "0")) (and (and (>= (- string-pos 42)  0) (<= (- string-pos 42) 126)) (equal? (substring string-juego (- string-pos 42) (- string-pos 41)) "0")) (and (and (>= (- string-pos 56)  0) (<= (- string-pos 56) 126)) (equal? (substring string-juego (- string-pos 56) (- string-pos 55)) "0")) (and (>= (- string-pos 70)  0) (<= (- string-pos 70) 126)) (equal? #f (equal? (substring string-juego (- string-pos 69) (- string-pos 68)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 70) "ab")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 14)  0) (<= (- string-pos 14) 126) (= movimientos 19)) (and (> (quotient string-pos 16) (quotient (- string-pos 84) 16)) (< (remainder string-pos 16) (remainder (- string-pos 84) 16))) (equal? (substring string-juego (- string-pos 14) (- string-pos 13)) "0")) (and (and (>= (- string-pos 28)  0) (<= (- string-pos 28) 126)) (equal? (substring string-juego (- string-pos 28) (- string-pos 27)) "0")) (and (and (>= (- string-pos 42)  0) (<= (- string-pos 42) 126)) (equal? (substring string-juego (- string-pos 42) (- string-pos 41)) "0")) (and (and (>= (- string-pos 56)  0) (<= (- string-pos 56) 126)) (equal? (substring string-juego (- string-pos 56) (- string-pos 55)) "0")) (and (and (>= (- string-pos 70)  0) (<= (- string-pos 70) 126)) (equal? (substring string-juego (- string-pos 70) (- string-pos 69)) "0")) (and (>= (- string-pos 84)  0) (<= (- string-pos 84) 126)) (equal? #f (equal? (substring string-juego (- string-pos 83) (- string-pos 82)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 84) "ab")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 14)  0) (<= (- string-pos 14) 126) (= movimientos 20)) (and (> (quotient string-pos 16) (quotient (- string-pos 98) 16)) (< (remainder string-pos 16) (remainder (- string-pos 98) 16))) (equal? (substring string-juego (- string-pos 14) (- string-pos 13)) "0")) (and (and (>= (- string-pos 28)  0) (<= (- string-pos 28) 126)) (equal? (substring string-juego (- string-pos 28) (- string-pos 27)) "0")) (and (and (>= (- string-pos 42)  0) (<= (- string-pos 42) 126)) (equal? (substring string-juego (- string-pos 42) (- string-pos 41)) "0")) (and (and (>= (- string-pos 56)  0) (<= (- string-pos 56) 126)) (equal? (substring string-juego (- string-pos 56) (- string-pos 55)) "0")) (and (and (>= (- string-pos 70)  0) (<= (- string-pos 70) 126)) (equal? (substring string-juego (- string-pos 70) (- string-pos 69)) "0")) (and (and (>= (- string-pos 84)  0) (<= (- string-pos 84) 126)) (equal? (substring string-juego (- string-pos 84) (- string-pos 83)) "0")) (and (>= (- string-pos 98)  0) (<= (- string-pos 98) 126)) (equal? #f (equal? (substring string-juego (- string-pos 97) (- string-pos 96)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 98) "ab")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    ; no se puede hacer el movimiento.
                                                                    [else (jaque-mate-blanco string-pos (+ movimientos 1))]
                                                                  ); fin cond
                                                              ; de lo contrario
                                                                  #| la torre no elimna el jaque o el posible mate |#
                                                                  (jaque-mate-blanco (+ string-pos 2) 0)
                                                              ); fin if
        ]; de lo contrario
        [(equal? (substring string-juego string-pos (+ string-pos 1)) "q") (if (<= movimientos 55)
                                                                  (cond
                                                                    #| movimientos superiores |#
                                                                    [(and (and (>= (- string-pos 16)  0) (<= (- string-pos 16) 126) (= movimientos 0)) (equal? #f (equal? (substring string-juego (- string-pos 14) (- string-pos 13)) "b"))) 
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 16) "qb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (>= (- string-pos 16)  0) (<= (- string-pos 16) 126) (= movimientos 1)) (equal? (substring string-juego (- string-pos 16) (- string-pos 15)) "0") (and (>= (- string-pos 32)  0) (<= (- string-pos 32) 126)) (equal? #f (equal? (substring string-juego (- string-pos 30) (- string-pos 29)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 32) "qb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 16)  0) (<= (- string-pos 16) 126) (= movimientos 2)) (equal? (substring string-juego (- string-pos 16) (- string-pos 15)) "0")) (and (and (>= (- string-pos 32)  0) (<= (- string-pos 32) 126)) (equal? (substring string-juego (- string-pos 32) (- string-pos 31)) "0")) (and (>= (- string-pos 48)  0) (<= (- string-pos 48) 126)) (equal? #f (equal? (substring string-juego (- string-pos 47) (- string-pos 46)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 48) "qb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 16)  0) (<= (- string-pos 16) 126) (= movimientos 3)) (equal? (substring string-juego (- string-pos 16) (- string-pos 15)) "0")) (and (and (>= (- string-pos 32)  0) (<= (- string-pos 32) 126)) (equal? (substring string-juego (- string-pos 32) (- string-pos 31)) "0")) (and (and (>= (- string-pos 48)  0) (<= (- string-pos 48) 126)) (equal? (substring string-juego (- string-pos 48) (- string-pos 47)) "0")) (and (>= (- string-pos 64)  0) (<= (- string-pos 64) 126)) (equal? #f (equal? (substring string-juego (- string-pos 63) (- string-pos 62)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 64) "qb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 16)  0) (<= (- string-pos 16) 126) (= movimientos 4)) (equal? (substring string-juego (- string-pos 16) (- string-pos 15)) "0")) (and (and (>= (- string-pos 32)  0) (<= (- string-pos 32) 126)) (equal? (substring string-juego (- string-pos 32) (- string-pos 31)) "0")) (and (and (>= (- string-pos 48)  0) (<= (- string-pos 48) 126)) (equal? (substring string-juego (- string-pos 48) (- string-pos 47)) "0")) (and (and (>= (- string-pos 64)  0) (<= (- string-pos 64) 126)) (equal? (substring string-juego (- string-pos 64) (- string-pos 63)) "0")) (and (>= (- string-pos 80)  0) (<= (- string-pos 80) 126)) (equal? #f (equal? (substring string-juego (- string-pos 79) (- string-pos 78)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 80) "qb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 16)  0) (<= (- string-pos 16) 126) (= movimientos 5)) (equal? (substring string-juego (- string-pos 16) (- string-pos 15)) "0")) (and (and (>= (- string-pos 32)  0) (<= (- string-pos 32) 126)) (equal? (substring string-juego (- string-pos 32) (- string-pos 31)) "0")) (and (and (>= (- string-pos 48)  0) (<= (- string-pos 48) 126)) (equal? (substring string-juego (- string-pos 48) (- string-pos 47)) "0")) (and (and (>= (- string-pos 64)  0) (<= (- string-pos 64) 126)) (equal? (substring string-juego (- string-pos 64) (- string-pos 63)) "0")) (and (and (>= (- string-pos 80)  0) (<= (- string-pos 80) 126)) (equal? (substring string-juego (- string-pos 80) (- string-pos 79)) "0")) (and (>= (- string-pos 96)  0) (<= (- string-pos 96) 126)) (equal? #f (equal? (substring string-juego (- string-pos 95) (- string-pos 94)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 96) "qb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 16)  0) (<= (- string-pos 16) 126) (= movimientos 6)) (equal? (substring string-juego (- string-pos 16) (- string-pos 15)) "0")) (and (and (>= (- string-pos 32)  0) (<= (- string-pos 32) 126)) (equal? (substring string-juego (- string-pos 32) (- string-pos 31)) "0")) (and (and (>= (- string-pos 48)  0) (<= (- string-pos 48) 126)) (equal? (substring string-juego (- string-pos 48) (- string-pos 47)) "0")) (and (and (>= (- string-pos 64)  0) (<= (- string-pos 64) 126)) (equal? (substring string-juego (- string-pos 64) (- string-pos 63)) "0")) (and (and (>= (- string-pos 80)  0) (<= (- string-pos 80) 126)) (equal? (substring string-juego (- string-pos 80) (- string-pos 79)) "0")) (and (and (>= (- string-pos 96)  0) (<= (- string-pos 96) 126)) (equal? (substring string-juego (- string-pos 96) (- string-pos 95)) "0")) (and (>= (- string-pos 112)  0) (<= (- string-pos 112) 126)) (equal? #f (equal? (substring string-juego (- string-pos 111) (- string-pos 110)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 112) "qb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    #| movimientos inferiores |#
                                                                    [(and (and (>= (+ string-pos 16)  0) (<= (+ string-pos 16) 126) (= movimientos 7)) (equal? #f (equal? (substring string-juego (+ string-pos 17) (+ string-pos 18)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 16) "qb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 16)  0) (<= (+ string-pos 16) 126) (= movimientos 8)) (equal? (substring string-juego (+ string-pos 16) (+ string-pos 17)) "0")) (and (>= (+ string-pos 32)  0) (<= (+ string-pos 32) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 33) (+ string-pos 34)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 32) "qb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 16)  0) (<= (+ string-pos 16) 126) (= movimientos 9)) (equal? (substring string-juego (+ string-pos 16) (+ string-pos 17)) "0")) (and (and (>= (+ string-pos 32)  0) (<= (+ string-pos 32) 126)) (equal? (substring string-juego (+ string-pos 32) (+ string-pos 33)) "0")) (and (>= (+ string-pos 48)  0) (<= (+ string-pos 48) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 49) (+ string-pos 50)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 48) "qb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 16)  0) (<= (+ string-pos 16) 126) (= movimientos 10)) (equal? (substring string-juego (+ string-pos 16) (+ string-pos 17)) "0")) (and (and (>= (+ string-pos 32)  0) (<= (+ string-pos 32) 126)) (equal? (substring string-juego (+ string-pos 32) (+ string-pos 33)) "0")) (and (and (>= (+ string-pos 48)  0) (<= (+ string-pos 48) 126)) (equal? (substring string-juego (+ string-pos 48) (+ string-pos 49)) "0")) (and (>= (+ string-pos 64)  0) (<= (+ string-pos 64) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 65) (+ string-pos 66)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 64) "qb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 16)  0) (<= (+ string-pos 16) 126) (= movimientos 11)) (equal? (substring string-juego (+ string-pos 16) (+ string-pos 17)) "0")) (and (and (>= (+ string-pos 32)  0) (<= (+ string-pos 32) 126)) (equal? (substring string-juego (+ string-pos 32) (+ string-pos 33)) "0")) (and (and (>= (+ string-pos 48)  0) (<= (+ string-pos 48) 126)) (equal? (substring string-juego (+ string-pos 48) (+ string-pos 49)) "0")) (and (and (>= (+ string-pos 64)  0) (<= (+ string-pos 64) 126)) (equal? (substring string-juego (+ string-pos 64) (+ string-pos 65)) "0")) (and (>= (+ string-pos 80)  0) (<= (+ string-pos 80) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 81) (+ string-pos 82)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 80) "qb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 16)  0) (<= (+ string-pos 16) 126) (= movimientos 12)) (equal? (substring string-juego (+ string-pos 16) (+ string-pos 17)) "0")) (and (and (>= (+ string-pos 32)  0) (<= (+ string-pos 32) 126)) (equal? (substring string-juego (+ string-pos 32) (+ string-pos 33)) "0")) (and (and (>= (+ string-pos 48)  0) (<= (+ string-pos 48) 126)) (equal? (substring string-juego (+ string-pos 48) (+ string-pos 49)) "0")) (and (and (>= (+ string-pos 64)  0) (<= (+ string-pos 64) 126)) (equal? (substring string-juego (+ string-pos 64) (+ string-pos 65)) "0")) (and (and (>= (+ string-pos 80)  0) (<= (+ string-pos 80) 126)) (equal? (substring string-juego (+ string-pos 80) (+ string-pos 81)) "0")) (and (>= (+ string-pos 96)  0) (<= (+ string-pos 96) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 97) (+ string-pos 98)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 96) "qb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 16)  0) (<= (+ string-pos 16) 126) (= movimientos 13)) (equal? (substring string-juego (+ string-pos 16) (+ string-pos 17)) "0")) (and (and (>= (+ string-pos 32)  0) (<= (+ string-pos 32) 126)) (equal? (substring string-juego (+ string-pos 32) (+ string-pos 33)) "0")) (and (and (>= (+ string-pos 48)  0) (<= (+ string-pos 48) 126)) (equal? (substring string-juego (+ string-pos 48) (+ string-pos 49)) "0")) (and (and (>= (+ string-pos 64)  0) (<= (+ string-pos 64) 126)) (equal? (substring string-juego (+ string-pos 64) (+ string-pos 65)) "0")) (and (and (>= (+ string-pos 80)  0) (<= (+ string-pos 80) 126)) (equal? (substring string-juego (+ string-pos 80) (+ string-pos 81)) "0")) (and (and (>= (+ string-pos 96)  0) (<= (+ string-pos 96) 126)) (equal? (substring string-juego (+ string-pos 96) (+ string-pos 97)) "0")) (and (>= (+ string-pos 112)  0) (<= (+ string-pos 112) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 113) (+ string-pos 114)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 112) "qb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    #| movimientos derechos |#
                                                                    [(and (and (>= (+ string-pos 2)  0) (<= (+ string-pos 2) 126) (= movimientos 14)) (= (quotient string-pos 16) (quotient (+ string-pos 2) 16)) (equal? #f (equal? (substring string-juego (+ string-pos 3) (+ string-pos 4)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 2) "qb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 2)  0) (<= (+ string-pos 2) 126) (= movimientos 15)) (= (quotient string-pos 16) (quotient (+ string-pos 4) 16)) (equal? (substring string-juego (+ string-pos 2) (+ string-pos 3)) "0")) (and (>= (+ string-pos 4)  0) (<= (+ string-pos 4) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 5) (+ string-pos 6)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 4) "qb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 2)  0) (<= (+ string-pos 2) 126) (= movimientos 16)) (= (quotient string-pos 16) (quotient (+ string-pos 6) 16)) (equal? (substring string-juego (+ string-pos 2) (+ string-pos 3)) "0")) (and (and (>= (+ string-pos 4)  0) (<= (+ string-pos 4) 126)) (equal? (substring string-juego (+ string-pos 4) (+ string-pos 5)) "0")) (and (>= (+ string-pos 6)  0) (<= (+ string-pos 6) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 7) (+ string-pos 8)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 6) "qb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 2)  0) (<= (+ string-pos 2) 126) (= movimientos 17)) (= (quotient string-pos 16) (quotient (+ string-pos 8) 16)) (equal? (substring string-juego (+ string-pos 2) (+ string-pos 3)) "0")) (and (and (>= (+ string-pos 4)  0) (<= (+ string-pos 4) 126)) (equal? (substring string-juego (+ string-pos 4) (+ string-pos 5)) "0")) (and (and (>= (+ string-pos 6)  0) (<= (+ string-pos 6) 126)) (equal? (substring string-juego (+ string-pos 6) (+ string-pos 7)) "0")) (and (>= (+ string-pos 8)  0) (<= (+ string-pos 8) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 9) (+ string-pos 10)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 8) "qb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 2)  0) (<= (+ string-pos 2) 126) (= movimientos 18)) (= (quotient string-pos 16) (quotient (+ string-pos 10) 16)) (equal? (substring string-juego (+ string-pos 2) (+ string-pos 3)) "0")) (and (and (>= (+ string-pos 4)  0) (<= (+ string-pos 4) 126)) (equal? (substring string-juego (+ string-pos 4) (+ string-pos 5)) "0")) (and (and (>= (+ string-pos 6)  0) (<= (+ string-pos 6) 126)) (equal? (substring string-juego (+ string-pos 6) (+ string-pos 7)) "0")) (and (and (>= (+ string-pos 8)  0) (<= (+ string-pos 8) 126)) (equal? (substring string-juego (+ string-pos 8) (+ string-pos 9)) "0")) (and (>= (+ string-pos 10)  0) (<= (+ string-pos 10) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 11) (+ string-pos 12)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 10) "qb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 2)  0) (<= (+ string-pos 2) 126) (= movimientos 19)) (= (quotient string-pos 16) (quotient (+ string-pos 12) 16)) (equal? (substring string-juego (+ string-pos 2) (+ string-pos 3)) "0")) (and (and (>= (+ string-pos 4)  0) (<= (+ string-pos 4) 126)) (equal? (substring string-juego (+ string-pos 4) (+ string-pos 5)) "0")) (and (and (>= (+ string-pos 6)  0) (<= (+ string-pos 6) 126)) (equal? (substring string-juego (+ string-pos 6) (+ string-pos 7)) "0")) (and (and (>= (+ string-pos 8)  0) (<= (+ string-pos 8) 126)) (equal? (substring string-juego (+ string-pos 8) (+ string-pos 9)) "0")) (and (and (>= (+ string-pos 10)  0) (<= (+ string-pos 10) 126)) (equal? (substring string-juego (+ string-pos 10) (+ string-pos 11)) "0")) (and (>= (+ string-pos 12)  0) (<= (+ string-pos 12) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 13) (+ string-pos 14)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 12) "qb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 2)  0) (<= (+ string-pos 2) 126) (= movimientos 20)) (= (quotient string-pos 16) (quotient (+ string-pos 14) 16)) (equal? (substring string-juego (+ string-pos 2) (+ string-pos 3)) "0")) (and (and (>= (+ string-pos 4)  0) (<= (+ string-pos 4) 126)) (equal? (substring string-juego (+ string-pos 4) (+ string-pos 5)) "0")) (and (and (>= (+ string-pos 6)  0) (<= (+ string-pos 6) 126)) (equal? (substring string-juego (+ string-pos 6) (+ string-pos 7)) "0")) (and (and (>= (+ string-pos 8)  0) (<= (+ string-pos 8) 126)) (equal? (substring string-juego (+ string-pos 8) (+ string-pos 9)) "0")) (and (and (>= (+ string-pos 10)  0) (<= (+ string-pos 10) 126)) (equal? (substring string-juego (+ string-pos 10) (+ string-pos 11)) "0")) (and (and (>= (+ string-pos 12)  0) (<= (+ string-pos 12) 126)) (equal? (substring string-juego (+ string-pos 12) (+ string-pos 13)) "0")) (and (>= (+ string-pos 14)  0) (<= (+ string-pos 14) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 15) (+ string-pos 16)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 14) "qb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    #| movimientos izquierdos |#
                                                                    [(and (and (>= (- string-pos 2)  0) (<= (- string-pos 2) 126) (= movimientos 21)) (= (quotient string-pos 16) (quotient (- string-pos 2) 16)) (equal? #f (equal? (substring string-juego (- string-pos 1) (- string-pos 0)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 2) "qb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 2)  0) (<= (- string-pos 2) 126) (= movimientos 22)) (= (quotient string-pos 16) (quotient (- string-pos 4) 16)) (equal? (substring string-juego (- string-pos 2) (- string-pos 1)) "0")) (and (>= (- string-pos 4)  0) (<= (- string-pos 4) 126)) (equal? #f (equal? (substring string-juego (- string-pos 3) (- string-pos 2)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 4) "qb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 2)  0) (<= (- string-pos 2) 126) (= movimientos 23)) (= (quotient string-pos 16) (quotient (- string-pos 6) 16)) (equal? (substring string-juego (- string-pos 2) (- string-pos 1)) "0")) (and (and (>= (- string-pos 4)  0) (<= (- string-pos 4) 126)) (equal? (substring string-juego (- string-pos 4) (- string-pos 3)) "0")) (and (>= (- string-pos 6)  0) (<= (- string-pos 6) 126)) (equal? #f (equal? (substring string-juego (- string-pos 5) (- string-pos 4)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 6) "qb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 2)  0) (<= (- string-pos 2) 126) (= movimientos 24)) (= (quotient string-pos 16) (quotient (- string-pos 8) 16)) (equal? (substring string-juego (- string-pos 2) (- string-pos 1)) "0")) (and (and (>= (- string-pos 4)  0) (<= (- string-pos 4) 126)) (equal? (substring string-juego (- string-pos 4) (- string-pos 3)) "0")) (and (and (>= (- string-pos 6)  0) (<= (- string-pos 6) 126)) (equal? (substring string-juego (- string-pos 6) (- string-pos 5)) "0")) (and (>= (- string-pos 8)  0) (<= (- string-pos 8) 126)) (equal? #f (equal? (substring string-juego (- string-pos 7) (- string-pos 6)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 8) "qb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 2)  0) (<= (- string-pos 2) 126) (= movimientos 25)) (= (quotient string-pos 16) (quotient (- string-pos 10) 16)) (equal? (substring string-juego (- string-pos 2) (- string-pos 1)) "0")) (and (and (>= (- string-pos 4)  0) (<= (- string-pos 4) 126)) (equal? (substring string-juego (- string-pos 4) (- string-pos 3)) "0")) (and (and (>= (- string-pos 6)  0) (<= (- string-pos 6) 126)) (equal? (substring string-juego (- string-pos 6) (- string-pos 5)) "0")) (and (and (>= (- string-pos 8)  0) (<= (- string-pos 8) 126)) (equal? (substring string-juego (- string-pos 8) (- string-pos 7)) "0")) (and (>= (- string-pos 10)  0) (<= (- string-pos 10) 126)) (equal? #f (equal? (substring string-juego (- string-pos 9) (- string-pos 8)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 10) "qb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 2)  0) (<= (- string-pos 2) 126) (= movimientos 26)) (= (quotient string-pos 16) (quotient (- string-pos 12) 16)) (equal? (substring string-juego (- string-pos 2) (- string-pos 1)) "0")) (and (and (>= (- string-pos 4)  0) (<= (- string-pos 4) 126)) (equal? (substring string-juego (- string-pos 4) (- string-pos 3)) "0")) (and (and (>= (- string-pos 6)  0) (<= (- string-pos 6) 126)) (equal? (substring string-juego (- string-pos 6) (- string-pos 5)) "0")) (and (and (>= (- string-pos 8)  0) (<= (- string-pos 8) 126)) (equal? (substring string-juego (- string-pos 8) (- string-pos 7)) "0")) (and (and (>= (- string-pos 10)  0) (<= (- string-pos 10) 126)) (equal? (substring string-juego (- string-pos 10) (- string-pos 9)) "0")) (and (>= (- string-pos 12)  0) (<= (- string-pos 12) 126)) (equal? #f (equal? (substring string-juego (- string-pos 11) (- string-pos 10)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 12) "qb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 2)  0) (<= (- string-pos 2) 126) (= movimientos 27)) (= (quotient string-pos 16) (quotient (- string-pos 14) 16)) (equal? (substring string-juego (- string-pos 2) (- string-pos 1)) "0")) (and (and (>= (- string-pos 4)  0) (<= (- string-pos 4) 126)) (equal? (substring string-juego (- string-pos 4) (- string-pos 3)) "0")) (and (and (>= (- string-pos 6)  0) (<= (- string-pos 6) 126)) (equal? (substring string-juego (- string-pos 6) (- string-pos 5)) "0")) (and (and (>= (- string-pos 8)  0) (<= (- string-pos 8) 126)) (equal? (substring string-juego (- string-pos 8) (- string-pos 7)) "0")) (and (and (>= (- string-pos 10)  0) (<= (- string-pos 10) 126)) (equal? (substring string-juego (- string-pos 10) (- string-pos 9)) "0")) (and (and (>= (- string-pos 12)  0) (<= (- string-pos 12) 126)) (equal? (substring string-juego (- string-pos 12) (- string-pos 11)) "0")) (and (>= (- string-pos 14)  0) (<= (- string-pos 14) 126)) (equal? #f (equal? (substring string-juego (- string-pos 13) (- string-pos 12)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 14) "qb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    #| movimientos arriba a la izquierda |#
                                                                    [(and (and (>= (- string-pos 18)  0) (<= (- string-pos 18) 126) (= movimientos 28)) (and (> (quotient string-pos 16) (quotient (- string-pos 18) 16)) (> (remainder string-pos 16) (remainder (- string-pos 18) 16))) (equal? #f (equal? (substring string-juego (- string-pos 17) (- string-pos 16)) "b"))) 
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 18) "qb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 18)  0) (<= (- string-pos 18) 126) (= movimientos 29)) (and (> (quotient string-pos 16) (quotient (- string-pos 36) 16)) (> (remainder string-pos 16) (remainder (- string-pos 36) 16))) (equal? (substring string-juego (- string-pos 18) (- string-pos 17)) "0")) (and (>= (- string-pos 36)  0) (<= (- string-pos 36) 126)) (equal? #f (equal? (substring string-juego (- string-pos 35) (- string-pos 34)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 36) "qb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 18)  0) (<= (- string-pos 18) 126) (= movimientos 30)) (and (> (quotient string-pos 16) (quotient (- string-pos 54) 16)) (> (remainder string-pos 16) (remainder (- string-pos 54) 16))) (equal? (substring string-juego (- string-pos 18) (- string-pos 17)) "0")) (and (and (>= (- string-pos 36)  0) (<= (- string-pos 36) 126)) (equal? (substring string-juego (- string-pos 36) (- string-pos 35)) "0")) (and (>= (- string-pos 54)  0) (<= (- string-pos 54) 126)) (equal? #f (equal? (substring string-juego (- string-pos 53) (- string-pos 52)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 54) "qb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 18)  0) (<= (- string-pos 18) 126) (= movimientos 31)) (and (> (quotient string-pos 16) (quotient (- string-pos 72) 16)) (> (remainder string-pos 16) (remainder (- string-pos 72) 16))) (equal? (substring string-juego (- string-pos 18) (- string-pos 17)) "0")) (and (and (>= (- string-pos 36)  0) (<= (- string-pos 36) 126)) (equal? (substring string-juego (- string-pos 36) (- string-pos 35)) "0")) (and (and (>= (- string-pos 54)  0) (<= (- string-pos 54) 126)) (equal? (substring string-juego (- string-pos 54) (- string-pos 53)) "0")) (and (>= (- string-pos 72)  0) (<= (- string-pos 72) 126)) (equal? #f (equal? (substring string-juego (- string-pos 71) (- string-pos 70)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 72) "qb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 18)  0) (<= (- string-pos 18) 126) (= movimientos 32)) (and (> (quotient string-pos 16) (quotient (- string-pos 90) 16)) (> (remainder string-pos 16) (remainder (- string-pos 90) 16))) (equal? (substring string-juego (- string-pos 18) (- string-pos 17)) "0")) (and (and (>= (- string-pos 36)  0) (<= (- string-pos 36) 126)) (equal? (substring string-juego (- string-pos 36) (- string-pos 35)) "0")) (and (and (>= (- string-pos 54)  0) (<= (- string-pos 54) 126)) (equal? (substring string-juego (- string-pos 54) (- string-pos 53)) "0")) (and (and (>= (- string-pos 72)  0) (<= (- string-pos 72) 126)) (equal? (substring string-juego (- string-pos 72) (- string-pos 71)) "0")) (and (>= (- string-pos 90)  0) (<= (- string-pos 90) 126)) (equal? #f (equal? (substring string-juego (- string-pos 89) (- string-pos 88)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 90) "qb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 18)  0) (<= (- string-pos 18) 126) (= movimientos 33)) (and (> (quotient string-pos 16) (quotient (- string-pos 108) 16)) (> (remainder string-pos 16) (remainder (- string-pos 108) 16))) (equal? (substring string-juego (- string-pos 18) (- string-pos 17)) "0")) (and (and (>= (- string-pos 36)  0) (<= (- string-pos 36) 126)) (equal? (substring string-juego (- string-pos 36) (- string-pos 35)) "0")) (and (and (>= (- string-pos 54)  0) (<= (- string-pos 54) 126)) (equal? (substring string-juego (- string-pos 54) (- string-pos 53)) "0")) (and (and (>= (- string-pos 72)  0) (<= (- string-pos 72) 126)) (equal? (substring string-juego (- string-pos 72) (- string-pos 71)) "0")) (and (and (>= (- string-pos 90)  0) (<= (- string-pos 90) 126)) (equal? (substring string-juego (- string-pos 90) (- string-pos 89)) "0")) (and (>= (- string-pos 108)  0) (<= (- string-pos 108) 126)) (equal? #f (equal? (substring string-juego (- string-pos 107) (- string-pos 106)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 108) "qb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 18)  0) (<= (- string-pos 18) 126) (= movimientos 34)) (and (> (quotient string-pos 16) (quotient (- string-pos 126) 16)) (> (remainder string-pos 16) (remainder (- string-pos 126) 16))) (equal? (substring string-juego (- string-pos 18) (- string-pos 17)) "0")) (and (and (>= (- string-pos 36)  0) (<= (- string-pos 36) 126)) (equal? (substring string-juego (- string-pos 36) (- string-pos 35)) "0")) (and (and (>= (- string-pos 54)  0) (<= (- string-pos 54) 126)) (equal? (substring string-juego (- string-pos 54) (- string-pos 53)) "0")) (and (and (>= (- string-pos 72)  0) (<= (- string-pos 72) 126)) (equal? (substring string-juego (- string-pos 72) (- string-pos 71)) "0")) (and (and (>= (- string-pos 90)  0) (<= (- string-pos 90) 126)) (equal? (substring string-juego (- string-pos 90) (- string-pos 89)) "0")) (and (and (>= (- string-pos 108)  0) (<= (- string-pos 108) 126)) (equal? (substring string-juego (- string-pos 108) (- string-pos 107)) "0")) (and (>= (- string-pos 126)  0) (<= (- string-pos 126) 126)) (equal? #f (equal? (substring string-juego (- string-pos 125) (- string-pos 124)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 126) "qb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    #| movimientos abajo a la derecha |#
                                                                    [(and (and (>= (+ string-pos 18)  0) (<= (+ string-pos 18) 126) (= movimientos 35)) (and (< (quotient string-pos 16) (quotient (+ string-pos 18) 16)) (< (remainder string-pos 16) (remainder (+ string-pos 18) 16))) (equal? #f (equal? (substring string-juego (+ string-pos 19) (+ string-pos 20)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 18) "qb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 18)  0) (<= (+ string-pos 18) 126) (= movimientos 36)) (and (< (quotient string-pos 16) (quotient (+ string-pos 36) 16)) (< (remainder string-pos 16) (remainder (+ string-pos 36) 16))) (equal? (substring string-juego (+ string-pos 18) (+ string-pos 19)) "0")) (and (>= (+ string-pos 36)  0) (<= (+ string-pos 36) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 37) (+ string-pos 38)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 36) "qb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 18)  0) (<= (+ string-pos 18) 126) (= movimientos 37)) (and (< (quotient string-pos 16) (quotient (+ string-pos 54) 16)) (< (remainder string-pos 16) (remainder (+ string-pos 54) 16))) (equal? (substring string-juego (+ string-pos 18) (+ string-pos 19)) "0")) (and (and (>= (+ string-pos 36)  0) (<= (+ string-pos 36) 126)) (equal? (substring string-juego (+ string-pos 36) (+ string-pos 37)) "0")) (and (>= (+ string-pos 54)  0) (<= (+ string-pos 54) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 55) (+ string-pos 56)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 54) "qb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 18)  0) (<= (+ string-pos 18) 126) (= movimientos 38)) (and (< (quotient string-pos 16) (quotient (+ string-pos 72) 16)) (< (remainder string-pos 16) (remainder (+ string-pos 72) 16))) (equal? (substring string-juego (+ string-pos 18) (+ string-pos 19)) "0")) (and (and (>= (+ string-pos 36)  0) (<= (+ string-pos 36) 126)) (equal? (substring string-juego (+ string-pos 36) (+ string-pos 37)) "0")) (and (and (>= (+ string-pos 54)  0) (<= (+ string-pos 54) 126)) (equal? (substring string-juego (+ string-pos 54) (+ string-pos 55)) "0")) (and (>= (+ string-pos 72)  0) (<= (+ string-pos 72) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 73) (+ string-pos 74)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 72) "qb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 18)  0) (<= (+ string-pos 18) 126) (= movimientos 39)) (and (< (quotient string-pos 16) (quotient (+ string-pos 90) 16)) (< (remainder string-pos 16) (remainder (+ string-pos 90) 16))) (equal? (substring string-juego (+ string-pos 18) (+ string-pos 19)) "0")) (and (and (>= (+ string-pos 36)  0) (<= (+ string-pos 36) 126)) (equal? (substring string-juego (+ string-pos 36) (+ string-pos 37)) "0")) (and (and (>= (+ string-pos 54)  0) (<= (+ string-pos 54) 126)) (equal? (substring string-juego (+ string-pos 54) (+ string-pos 55)) "0")) (and (and (>= (+ string-pos 72)  0) (<= (+ string-pos 72) 126)) (equal? (substring string-juego (+ string-pos 72) (+ string-pos 73)) "0")) (and (>= (+ string-pos 90)  0) (<= (+ string-pos 90) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 91) (+ string-pos 92)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 90) "qb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 18)  0) (<= (+ string-pos 18) 126) (= movimientos 40)) (and (< (quotient string-pos 16) (quotient (+ string-pos 108) 16)) (< (remainder string-pos 16) (remainder (+ string-pos 108) 16))) (equal? (substring string-juego (+ string-pos 18) (+ string-pos 19)) "0")) (and (and (>= (+ string-pos 36)  0) (<= (+ string-pos 36) 126)) (equal? (substring string-juego (+ string-pos 36) (+ string-pos 37)) "0")) (and (and (>= (+ string-pos 54)  0) (<= (+ string-pos 54) 126)) (equal? (substring string-juego (+ string-pos 54) (+ string-pos 55)) "0")) (and (and (>= (+ string-pos 72)  0) (<= (+ string-pos 72) 126)) (equal? (substring string-juego (+ string-pos 72) (+ string-pos 73)) "0")) (and (and (>= (+ string-pos 90)  0) (<= (+ string-pos 90) 126)) (equal? (substring string-juego (+ string-pos 90) (+ string-pos 91)) "0")) (and (>= (+ string-pos 108)  0) (<= (+ string-pos 108) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 109) (+ string-pos 110)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 108) "qb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 18)  0) (<= (+ string-pos 18) 126) (= movimientos 41)) (and (< (quotient string-pos 16) (quotient (+ string-pos 126) 16)) (< (remainder string-pos 16) (remainder (+ string-pos 126) 16))) (equal? (substring string-juego (+ string-pos 18) (+ string-pos 19)) "0")) (and (and (>= (+ string-pos 36)  0) (<= (+ string-pos 36) 126)) (equal? (substring string-juego (+ string-pos 36) (+ string-pos 37)) "0")) (and (and (>= (+ string-pos 54)  0) (<= (+ string-pos 54) 126)) (equal? (substring string-juego (+ string-pos 54) (+ string-pos 55)) "0")) (and (and (>= (+ string-pos 72)  0) (<= (+ string-pos 72) 126)) (equal? (substring string-juego (+ string-pos 72) (+ string-pos 73)) "0")) (and (and (>= (+ string-pos 90)  0) (<= (+ string-pos 90) 126)) (equal? (substring string-juego (+ string-pos 90) (+ string-pos 91)) "0")) (and (and (>= (+ string-pos 108)  0) (<= (+ string-pos 108) 126)) (equal? (substring string-juego (+ string-pos 108) (+ string-pos 109)) "0")) (and (>= (+ string-pos 126)  0) (<= (+ string-pos 126) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 127) (+ string-pos 128)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 126) "qb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    #| movimientos abajo a la izquierda |#
                                                                    [(and (and (>= (+ string-pos 14)  0) (<= (+ string-pos 14) 126) (= movimientos 42)) (and (< (quotient string-pos 16) (quotient (+ string-pos 14) 16)) (> (remainder string-pos 16) (remainder (+ string-pos 14) 16))) (equal? #f (equal? (substring string-juego (+ string-pos 15) (+ string-pos 16)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 14) "qb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 14)  0) (<= (+ string-pos 14) 126) (= movimientos 43)) (and (< (quotient string-pos 16) (quotient (+ string-pos 28) 16)) (> (remainder string-pos 16) (remainder (+ string-pos 28) 16))) (equal? (substring string-juego (+ string-pos 14) (+ string-pos 15)) "0")) (and (>= (+ string-pos 28)  0) (<= (+ string-pos 28) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 29) (+ string-pos 30)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 28) "qb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 14)  0) (<= (+ string-pos 14) 126) (= movimientos 44)) (and (< (quotient string-pos 16) (quotient (+ string-pos 42) 16)) (> (remainder string-pos 16) (remainder (+ string-pos 42) 16))) (equal? (substring string-juego (+ string-pos 14) (+ string-pos 15)) "0")) (and (and (>= (+ string-pos 28)  0) (<= (+ string-pos 28) 126)) (equal? (substring string-juego (+ string-pos 28) (+ string-pos 29)) "0")) (and (>= (+ string-pos 42)  0) (<= (+ string-pos 42) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 43) (+ string-pos 44)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 42) "qb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 14)  0) (<= (+ string-pos 14) 126) (= movimientos 45)) (and (< (quotient string-pos 16) (quotient (+ string-pos 54) 16)) (> (remainder string-pos 16) (remainder (+ string-pos 54) 16))) (equal? (substring string-juego (+ string-pos 14) (+ string-pos 15)) "0")) (and (and (>= (+ string-pos 28)  0) (<= (+ string-pos 28) 126)) (equal? (substring string-juego (+ string-pos 28) (+ string-pos 29)) "0")) (and (and (>= (+ string-pos 42)  0) (<= (+ string-pos 42) 126)) (equal? (substring string-juego (+ string-pos 42) (+ string-pos 43)) "0")) (and (>= (+ string-pos 56)  0) (<= (+ string-pos 56) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 57) (+ string-pos 58)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 54) "qb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 14)  0) (<= (+ string-pos 14) 126) (= movimientos 46)) (and (< (quotient string-pos 16) (quotient (+ string-pos 70) 16)) (> (remainder string-pos 16) (remainder (+ string-pos 70) 16))) (equal? (substring string-juego (+ string-pos 14) (+ string-pos 15)) "0")) (and (and (>= (+ string-pos 28)  0) (<= (+ string-pos 28) 126)) (equal? (substring string-juego (+ string-pos 28) (+ string-pos 29)) "0")) (and (and (>= (+ string-pos 42)  0) (<= (+ string-pos 42) 126)) (equal? (substring string-juego (+ string-pos 42) (+ string-pos 43)) "0")) (and (and (>= (+ string-pos 56)  0) (<= (+ string-pos 56) 126)) (equal? (substring string-juego (+ string-pos 56) (+ string-pos 57)) "0")) (and (>= (+ string-pos 70)  0) (<= (+ string-pos 70) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 71) (+ string-pos 72)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 70) "qb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 14)  0) (<= (+ string-pos 14) 126) (= movimientos 47)) (and (< (quotient string-pos 16) (quotient (+ string-pos 84) 16)) (> (remainder string-pos 16) (remainder (+ string-pos 84) 16))) (equal? (substring string-juego (+ string-pos 14) (+ string-pos 15)) "0")) (and (and (>= (+ string-pos 28)  0) (<= (+ string-pos 28) 126)) (equal? (substring string-juego (+ string-pos 28) (+ string-pos 29)) "0")) (and (and (>= (+ string-pos 42)  0) (<= (+ string-pos 42) 126)) (equal? (substring string-juego (+ string-pos 42) (+ string-pos 43)) "0")) (and (and (>= (+ string-pos 56)  0) (<= (+ string-pos 56) 126)) (equal? (substring string-juego (+ string-pos 56) (+ string-pos 57)) "0")) (and (and (>= (+ string-pos 70)  0) (<= (+ string-pos 70) 126)) (equal? (substring string-juego (+ string-pos 70) (+ string-pos 71)) "0")) (and (>= (+ string-pos 84)  0) (<= (+ string-pos 84) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 85) (+ string-pos 86)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 84) "qb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 14)  0) (<= (+ string-pos 14) 126) (= movimientos 48)) (and (< (quotient string-pos 16) (quotient (+ string-pos 98) 16)) (> (remainder string-pos 16) (remainder (+ string-pos 98) 16))) (equal? (substring string-juego (+ string-pos 14) (+ string-pos 15)) "0")) (and (and (>= (+ string-pos 28)  0) (<= (+ string-pos 28) 126)) (equal? (substring string-juego (+ string-pos 28) (+ string-pos 29)) "0")) (and (and (>= (+ string-pos 42)  0) (<= (+ string-pos 42) 126)) (equal? (substring string-juego (+ string-pos 42) (+ string-pos 43)) "0")) (and (and (>= (+ string-pos 56)  0) (<= (+ string-pos 56) 126)) (equal? (substring string-juego (+ string-pos 56) (+ string-pos 57)) "0")) (and (and (>= (+ string-pos 70)  0) (<= (+ string-pos 70) 126)) (equal? (substring string-juego (+ string-pos 70) (+ string-pos 71)) "0")) (and (and (>= (+ string-pos 84)  0) (<= (+ string-pos 84) 126)) (equal? (substring string-juego (+ string-pos 84) (+ string-pos 85)) "0")) (and (>= (+ string-pos 98)  0) (<= (+ string-pos 98) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 99) (+ string-pos 100)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 98) "qb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    #| movimientos arriba a la derecha |#
                                                                    [(and (and (>= (- string-pos 14)  0) (<= (- string-pos 14) 126) (= movimientos 49)) (and (> (quotient string-pos 16) (quotient (- string-pos 14) 16)) (< (remainder string-pos 16) (remainder (- string-pos 14) 16))) (equal? #f (equal? (substring string-juego (- string-pos 13) (- string-pos 12)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 14) "qb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 14)  0) (<= (- string-pos 14) 126) (= movimientos 50)) (and (> (quotient string-pos 16) (quotient (- string-pos 28) 16)) (< (remainder string-pos 16) (remainder (- string-pos 28) 16))) (equal? (substring string-juego (- string-pos 14) (- string-pos 13)) "0")) (and (>= (- string-pos 28)  0) (<= (- string-pos 28) 126)) (equal? #f (equal? (substring string-juego (- string-pos 27) (- string-pos 26)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 28) "qb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 14)  0) (<= (- string-pos 14) 126) (= movimientos 51)) (and (> (quotient string-pos 16) (quotient (- string-pos 42) 16)) (< (remainder string-pos 16) (remainder (- string-pos 42) 16))) (equal? (substring string-juego (- string-pos 14) (- string-pos 13)) "0")) (and (and (>= (- string-pos 28)  0) (<= (- string-pos 28) 126)) (equal? (substring string-juego (- string-pos 28) (- string-pos 27)) "0")) (and (>= (- string-pos 42)  0) (<= (- string-pos 42) 126)) (equal? #f (equal? (substring string-juego (- string-pos 41) (- string-pos 40)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 42) "qb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 14)  0) (<= (- string-pos 14) 126) (= movimientos 52)) (and (> (quotient string-pos 16) (quotient (- string-pos 54) 16)) (< (remainder string-pos 16) (remainder (- string-pos 54) 16))) (equal? (substring string-juego (- string-pos 14) (- string-pos 13)) "0")) (and (and (>= (- string-pos 28)  0) (<= (- string-pos 28) 126)) (equal? (substring string-juego (- string-pos 28) (- string-pos 27)) "0")) (and (and (>= (- string-pos 42)  0) (<= (- string-pos 42) 126)) (equal? (substring string-juego (- string-pos 42) (- string-pos 41)) "0")) (and (>= (- string-pos 56)  0) (<= (- string-pos 56) 126)) (equal? #f (equal? (substring string-juego (- string-pos 55) (- string-pos 54)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 54) "qb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 14)  0) (<= (- string-pos 14) 126) (= movimientos 53)) (and (> (quotient string-pos 16) (quotient (- string-pos 70) 16)) (< (remainder string-pos 16) (remainder (- string-pos 70) 16))) (equal? (substring string-juego (- string-pos 14) (- string-pos 13)) "0")) (and (and (>= (- string-pos 28)  0) (<= (- string-pos 28) 126)) (equal? (substring string-juego (- string-pos 28) (- string-pos 27)) "0")) (and (and (>= (- string-pos 42)  0) (<= (- string-pos 42) 126)) (equal? (substring string-juego (- string-pos 42) (- string-pos 41)) "0")) (and (and (>= (- string-pos 56)  0) (<= (- string-pos 56) 126)) (equal? (substring string-juego (- string-pos 56) (- string-pos 55)) "0")) (and (>= (- string-pos 70)  0) (<= (- string-pos 70) 126)) (equal? #f (equal? (substring string-juego (- string-pos 69) (- string-pos 68)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 70) "qb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 14)  0) (<= (- string-pos 14) 126) (= movimientos 54)) (and (> (quotient string-pos 16) (quotient (- string-pos 84) 16)) (< (remainder string-pos 16) (remainder (- string-pos 84) 16))) (equal? (substring string-juego (- string-pos 14) (- string-pos 13)) "0")) (and (and (>= (- string-pos 28)  0) (<= (- string-pos 28) 126)) (equal? (substring string-juego (- string-pos 28) (- string-pos 27)) "0")) (and (and (>= (- string-pos 42)  0) (<= (- string-pos 42) 126)) (equal? (substring string-juego (- string-pos 42) (- string-pos 41)) "0")) (and (and (>= (- string-pos 56)  0) (<= (- string-pos 56) 126)) (equal? (substring string-juego (- string-pos 56) (- string-pos 55)) "0")) (and (and (>= (- string-pos 70)  0) (<= (- string-pos 70) 126)) (equal? (substring string-juego (- string-pos 70) (- string-pos 69)) "0")) (and (>= (- string-pos 84)  0) (<= (- string-pos 84) 126)) (equal? #f (equal? (substring string-juego (- string-pos 83) (- string-pos 82)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 84) "qb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 14)  0) (<= (- string-pos 14) 126) (= movimientos 55)) (and (> (quotient string-pos 16) (quotient (- string-pos 98) 16)) (< (remainder string-pos 16) (remainder (- string-pos 98) 16))) (equal? (substring string-juego (- string-pos 14) (- string-pos 13)) "0")) (and (and (>= (- string-pos 28)  0) (<= (- string-pos 28) 126)) (equal? (substring string-juego (- string-pos 28) (- string-pos 27)) "0")) (and (and (>= (- string-pos 42)  0) (<= (- string-pos 42) 126)) (equal? (substring string-juego (- string-pos 42) (- string-pos 41)) "0")) (and (and (>= (- string-pos 56)  0) (<= (- string-pos 56) 126)) (equal? (substring string-juego (- string-pos 56) (- string-pos 55)) "0")) (and (and (>= (- string-pos 70)  0) (<= (- string-pos 70) 126)) (equal? (substring string-juego (- string-pos 70) (- string-pos 69)) "0")) (and (and (>= (- string-pos 84)  0) (<= (- string-pos 84) 126)) (equal? (substring string-juego (- string-pos 84) (- string-pos 83)) "0")) (and (>= (- string-pos 98)  0) (<= (- string-pos 98) 126)) (equal? #f (equal? (substring string-juego (- string-pos 97) (- string-pos 96)) "b")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 98) "qb")
                                                                                                         (if (equal? (jaque 0 "rb") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    ; no se puede hacer el movimiento.
                                                                    [else (jaque-mate-blanco string-pos (+ movimientos 1))]
                                                                  ); fin cond
                                                              ; de lo contrario
                                                                  #| la torre no elimna el jaque o el posible mate |#
                                                                  (jaque-mate-blanco (+ string-pos 2) 0)
                                                              ); fin if
        ]; de lo contrario
        [(equal? (substring string-juego string-pos (+ string-pos 1)) "r") (if (<= movimientos 7)
                                                                  (cond
                                                                    [(and (and (>= (- string-pos 16) 0) (<= (- string-pos 16) 126) (= movimientos 0)) (or (equal? (substring string-juego (- string-pos 16) (- string-pos 15)) "0") (equal? (substring string-juego (- string-pos 16) (- string-pos 15)) "P") (equal? (substring string-juego (- string-pos 16) (- string-pos 15)) "T")  (equal? (substring string-juego (- string-pos 16) (- string-pos 15)) "C")  (equal? (substring string-juego (- string-pos 16) (- string-pos 15)) "A")  (equal? (substring string-juego (- string-pos 16) (- string-pos 15)) "Q")))
                                                                                                   (string-copy! string-juego string-pos "00")
                                                                                                   (string-copy! string-juego (- string-pos 16) "rb")
                                                                                                   (if (equal? (jaque 0 "rb") #t)
                                                                                                       (begin
                                                                                                         (string-copy! string-juego 0 string-juego-copy)
                                                                                                         (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                       ); fin begin true
                                                                                                   ; de lo contrario
                                                                                                         (begin
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                           #f
                                                                                                         ); fin begin false
                                                                                                   ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (>= (- string-pos 14) 0) (<= (- string-pos 14) 126) (= movimientos 1)) (or (equal? (substring string-juego (- string-pos 14) (- string-pos 13)) "0") (equal? (substring string-juego (- string-pos 14) (- string-pos 13)) "P") (equal? (substring string-juego (- string-pos 14) (- string-pos 13)) "T")  (equal? (substring string-juego (- string-pos 14) (- string-pos 13)) "C")  (equal? (substring string-juego (- string-pos 14) (- string-pos 13)) "A")  (equal? (substring string-juego (- string-pos 14) (- string-pos 13)) "Q")))
                                                                                                   (string-copy! string-juego string-pos "00")
                                                                                                   (string-copy! string-juego (- string-pos 14) "rb")
                                                                                                   (if (equal? (jaque 0 "rb") #t)
                                                                                                       (begin
                                                                                                         (string-copy! string-juego 0 string-juego-copy)
                                                                                                         (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                       ); fin begin true
                                                                                                   ; de lo contrario
                                                                                                         (begin
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                           #f
                                                                                                         ); fin begin false
                                                                                                   ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (>= (- string-pos 18) 0) (<= (- string-pos 18) 126) (= movimientos 2)) (or (equal? (substring string-juego (- string-pos 18) (- string-pos 17)) "0") (equal? (substring string-juego (- string-pos 18) (- string-pos 17)) "P") (equal? (substring string-juego (- string-pos 18) (- string-pos 17)) "T")  (equal? (substring string-juego (- string-pos 18) (- string-pos 17)) "C")  (equal? (substring string-juego (- string-pos 18) (- string-pos 17)) "A")  (equal? (substring string-juego (- string-pos 18) (- string-pos 17)) "Q")))
                                                                                                   (string-copy! string-juego string-pos "00")
                                                                                                   (string-copy! string-juego (- string-pos 18) "rb")
                                                                                                   (if (equal? (jaque 0 "rb") #t)
                                                                                                       (begin
                                                                                                         (string-copy! string-juego 0 string-juego-copy)
                                                                                                         (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                       ); fin begin true
                                                                                                   ; de lo contrario
                                                                                                         (begin
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                           #f
                                                                                                         ); fin begin false
                                                                                                   ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (>= (- string-pos  2) 0) (<= (- string-pos  2) 126) (= movimientos 3)) (or (equal? (substring string-juego (- string-pos  2) (- string-pos  1)) "0") (equal? (substring string-juego (- string-pos  2) (- string-pos  1)) "P") (equal? (substring string-juego (- string-pos  2) (- string-pos  1)) "T")  (equal? (substring string-juego (- string-pos  2) (- string-pos  1)) "C")  (equal? (substring string-juego (- string-pos  2) (- string-pos  1)) "A")  (equal? (substring string-juego (- string-pos  2) (- string-pos  1)) "Q")))
                                                                                                   (string-copy! string-juego string-pos "00")
                                                                                                   (string-copy! string-juego (- string-pos  2) "rb")
                                                                                                   (if (equal? (jaque 0 "rb") #t)
                                                                                                       (begin
                                                                                                         (string-copy! string-juego 0 string-juego-copy)
                                                                                                         (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                       ); fin begin true
                                                                                                   ; de lo contrario
                                                                                                         (begin
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                           #f
                                                                                                         ); fin begin false
                                                                                                   ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (>= (+ string-pos  2) 0) (<= (+ string-pos  2) 126) (= movimientos 4)) (or (equal? (substring string-juego (+ string-pos  2) (+ string-pos  3)) "0") (equal? (substring string-juego (+ string-pos  2) (+ string-pos  3)) "P") (equal? (substring string-juego (+ string-pos  2) (+ string-pos  3)) "T")  (equal? (substring string-juego (+ string-pos  2) (+ string-pos  3)) "C")  (equal? (substring string-juego (+ string-pos  2) (+ string-pos  3)) "A")  (equal? (substring string-juego (+ string-pos  2) (+ string-pos  3)) "Q")))
                                                                                                   (string-copy! string-juego string-pos "00")
                                                                                                   (string-copy! string-juego (+ string-pos  2) "rb")
                                                                                                   (if (equal? (jaque 0 "rb") #t)
                                                                                                       (begin
                                                                                                         (string-copy! string-juego 0 string-juego-copy)
                                                                                                         (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                       ); fin begin true
                                                                                                   ; de lo contrario
                                                                                                         (begin
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                           #f
                                                                                                         ); fin begin false
                                                                                                   ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (>= (+ string-pos 18) 0) (<= (+ string-pos 18) 126) (= movimientos 5)) (or (equal? (substring string-juego (+ string-pos 18) (+ string-pos 19)) "0") (equal? (substring string-juego (+ string-pos 18) (+ string-pos 19)) "P") (equal? (substring string-juego (+ string-pos 18) (+ string-pos 19)) "T")  (equal? (substring string-juego (+ string-pos 18) (+ string-pos 19)) "C")  (equal? (substring string-juego (+ string-pos 18) (+ string-pos 19)) "A")  (equal? (substring string-juego (+ string-pos 18) (+ string-pos 19)) "Q")))
                                                                                                   (string-copy! string-juego string-pos "00")
                                                                                                   (string-copy! string-juego (+ string-pos 18) "rb")
                                                                                                   (if (equal? (jaque 0 "rb") #t)
                                                                                                       (begin
                                                                                                         (string-copy! string-juego 0 string-juego-copy)
                                                                                                         (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                       ); fin begin true
                                                                                                   ; de lo contrario
                                                                                                         (begin
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                           #f
                                                                                                         ); fin begin false
                                                                                                   ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (>= (+ string-pos 14) 0) (<= (+ string-pos 14) 126) (= movimientos 6)) (or (equal? (substring string-juego (+ string-pos 14) (+ string-pos 15)) "0") (equal? (substring string-juego (+ string-pos 14) (+ string-pos 15)) "P") (equal? (substring string-juego (+ string-pos 14) (+ string-pos 15)) "T")  (equal? (substring string-juego (+ string-pos 14) (+ string-pos 15)) "C")  (equal? (substring string-juego (+ string-pos 14) (+ string-pos 15)) "A")  (equal? (substring string-juego (+ string-pos 14) (+ string-pos 15)) "Q")))
                                                                                                   (string-copy! string-juego string-pos "00")
                                                                                                   (string-copy! string-juego (+ string-pos 14) "rb")
                                                                                                   (if (equal? (jaque 0 "rb") #t)
                                                                                                       (begin
                                                                                                         (string-copy! string-juego 0 string-juego-copy)
                                                                                                         (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                       ); fin begin true
                                                                                                   ; de lo contrario
                                                                                                         (begin
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                           #f
                                                                                                         ); fin begin false
                                                                                                   ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (>= (+ string-pos 16) 0) (<= (+ string-pos 16) 126) (= movimientos 7)) (or (equal? (substring string-juego (+ string-pos 16) (+ string-pos 17)) "0") (equal? (substring string-juego (+ string-pos 16) (+ string-pos 17)) "P") (equal? (substring string-juego (+ string-pos 16) (+ string-pos 17)) "T")  (equal? (substring string-juego (+ string-pos 16) (+ string-pos 17)) "C")  (equal? (substring string-juego (+ string-pos 16) (+ string-pos 17)) "A")  (equal? (substring string-juego (+ string-pos 16) (+ string-pos 17)) "Q")))
                                                                                                   (string-copy! string-juego string-pos "00")
                                                                                                   (string-copy! string-juego (+ string-pos 16) "rb")
                                                                                                   (if (equal? (jaque 0 "rb") #t)
                                                                                                       (begin
                                                                                                         (string-copy! string-juego 0 string-juego-copy)
                                                                                                         (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                       ); fin begin true
                                                                                                   ; de lo contrario
                                                                                                         (begin
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                           #f
                                                                                                         ); fin begin false
                                                                                                   ); fin if
                                                                    ]; de lo contrario
                                                                    ; no se puede hacer el movimiento
                                                                    [else (jaque-mate-blanco string-pos (+ movimientos 1))]
                                                                  ); fin cond
                                                              ; de lo contrario
                                                                  #| el rey por si solo no puede salir de su jaque |#
                                                                  (jaque-mate-blanco (+ string-pos 2) 0)
                                                              ); fin if
        ]; de lo contrario
        [(equal? (substring string-juego string-pos (+ string-pos 1)) "p") (if (<= movimientos 3)
                                                                  (cond
                                                                    #| paso doble del peon   |#
                                                                    [(and (and (>= string-pos 96) (<= string-pos 110) (= movimientos 0)) (equal? (substring string-juego (- string-pos 32) (- string-pos 31)) "0")) (string-copy! string-juego string-pos "00")
                                                                                                                                                                                                  (string-copy! string-juego (- string-pos 32) "pb")
                                                                                                                                                                                                  (if (equal? (jaque 0 "rb") #t)
                                                                                                                                                                                                      (begin
                                                                                                                                                                                                        (string-copy! string-juego 0 string-juego-copy)
                                                                                                                                                                                                        (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                                                                                                                      ); fin begin true
                                                                                                                                                                                                  ; de lo contrario
                                                                                                                                                                                                      (begin
                                                                                                                                                                                                        (string-copy! string-juego 0 string-juego-copy)
                                                                                                                                                                                                        #f
                                                                                                                                                                                                      ); fin begin false
                                                                                                                                                                                                  ); fin if
                                                                    ]; de lo contrario
                                                                    #| solo un paso del peon |#
                                                                    [(and (and (>= (- string-pos 16) 0) (<= (- string-pos 16) 126) (= movimientos 1)) (equal? (substring string-juego (- string-pos 16) (- string-pos 15)) "0")) (string-copy! string-juego string-pos "00")
                                                                                                                                                                                                  (string-copy! string-juego (- string-pos 16) "pb")
                                                                                                                                                                                                  (if (equal? (jaque 0 "rb") #t)
                                                                                                                                                                                                      (begin
                                                                                                                                                                                                        (string-copy! string-juego 0 string-juego-copy)
                                                                                                                                                                                                        (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                                                                                                                      ); fin begin true
                                                                                                                                                                                                  ; de lo contrario
                                                                                                                                                                                                      (begin
                                                                                                                                                                                                        (string-copy! string-juego 0 string-juego-copy)
                                                                                                                                                                                                        #f
                                                                                                                                                                                                      ); fin begin false
                                                                                                                                                                                                  ); fin if
                                                                    ]; de lo contrario
                                                                    #| peon comiendo a la izquierda |#
                                                                    [(and (and (equal? #f (equal? string-pos 30)) (equal? #f (equal? string-pos 46)) (equal? #f (equal? string-pos 62)) (equal? #f (equal? string-pos 78)) (equal? #f (equal? string-pos 94)) (equal? #f (equal? string-pos 110))) (and (>= (- string-pos 14) 0) (<= (- string-pos 14) 126) (= movimientos 2)) (equal? (substring string-juego (- string-pos 13) (- string-pos 12)) "N")) (string-copy! string-juego string-pos "00")
                                                                                                                                                                                                              (string-copy! string-juego (- string-pos 14) "pb")
                                                                                                                                                                                                              (if (equal? (jaque 0 "rb") #t)
                                                                                                                                                                                                                  (begin
                                                                                                                                                                                                                    (string-copy! string-juego 0 string-juego-copy)
                                                                                                                                                                                                                    (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                                                                                                                                  ); fin begin true
                                                                                                                                                                                                              ; de lo contrario
                                                                                                                                                                                                                  (begin
                                                                                                                                                                                                                    (string-copy! string-juego 0 string-juego-copy)
                                                                                                                                                                                                                     #f
                                                                                                                                                                                                                  ); fin begin false
                                                                                                                                                                                                              ); fin if
                                                                    ]; de lo contrario
                                                                    #| peon comiendo a la derecha   |#
                                                                    [(and (and (equal? #f (equal? string-pos 16)) (equal? #f (equal? string-pos 32)) (equal? #f (equal? string-pos 48)) (equal? #f (equal? string-pos 64)) (equal? #f (equal? string-pos 80)) (equal? #f (equal? string-pos 96))) (and (>= (- string-pos 18) 0) (<= (- string-pos 18) 126) (= movimientos 3)) (equal? (substring string-juego (- string-pos 17) (- string-pos 16)) "N")) (string-copy! string-juego string-pos "00")
                                                                                                                                                                                                              (string-copy! string-juego (- string-pos 18) "pb")
                                                                                                                                                                                                              (if (equal? (jaque 0 "rb") #t)
                                                                                                                                                                                                                  (begin
                                                                                                                                                                                                                    (string-copy! string-juego 0 string-juego-copy)
                                                                                                                                                                                                                    (jaque-mate-blanco string-pos (+ movimientos 1))
                                                                                                                                                                                                                  ); fin begin true
                                                                                                                                                                                                              ; de lo contrario
                                                                                                                                                                                                                  (begin
                                                                                                                                                                                                                    (string-copy! string-juego 0 string-juego-copy)
                                                                                                                                                                                                                     #f
                                                                                                                                                                                                                  ); fin begin false
                                                                                                                                                                                                              ); fin if
                                                                    ]; de lo contrario
                                                                    ; no se puede hacer el movimiento.
                                                                    [else (jaque-mate-blanco string-pos (+ movimientos 1))]
                                                                  ); fin cond
                                                              ; de lo contrario
                                                                  #| el peon no elimina el jaque o el posible mate |#
                                                                  (jaque-mate-blanco (+ string-pos 2) 0)
                                                              ); fin if
        ]; de lo incrementa el contador o el string-pos
        [else (jaque-mate-blanco (+ string-pos 2) 0)]
      ); fin cond
  ; de lo contrario
      (begin
        (string-copy! string-juego 0 string-juego-copy)
        #t
      ); fin begin false
  ); fin cond
); fin definicion jaque mate blanco

#| Identificadores Locales A La Funcion (jaque mate negro):
   - string-pos: se encarga de guardar un valor numerico para tomarlo como posicion en el string y el cual va a ir creciendo desde su valor minimo hasta que alcance el total del string
   - movimientos: almacena un valor numerico, como contador para los movimientos posibles de cada ficha
Definicion de la funcion jaque mate negro, para saber cuando los negros estan en jaque mate. |#
(define (jaque-mate-negro string-pos movimientos)
  (if (<= string-pos 126)
      (cond
        [(equal? (substring string-juego string-pos (+ string-pos 1)) "T") (if (<= movimientos 27)
                                                                  (cond
                                                                    #| movimientos superiores |#
                                                                    [(and (and (>= (- string-pos 16)  0) (<= (- string-pos 16) 126) (= movimientos 0)) (equal? #f (equal? (substring string-juego (- string-pos 15) (- string-pos 14)) "N"))) 
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 16) "TN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (>= (- string-pos 16)  0) (<= (- string-pos 16) 126) (= movimientos 1)) (equal? (substring string-juego (- string-pos 16) (- string-pos 15)) "0") (and (>= (- string-pos 32)  0) (<= (- string-pos 32) 126)) (equal? #f (equal? (substring string-juego (- string-pos 31) (- string-pos 30)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 32) "TN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 16)  0) (<= (- string-pos 16) 126) (= movimientos 2)) (equal? (substring string-juego (- string-pos 16) (- string-pos 15)) "0")) (and (and (>= (- string-pos 32)  0) (<= (- string-pos 32) 126)) (equal? (substring string-juego (- string-pos 32) (- string-pos 31)) "0")) (and (>= (- string-pos 48)  0) (<= (- string-pos 48) 126)) (equal? #f (equal? (substring string-juego (- string-pos 47) (- string-pos 46)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 48) "TN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 16)  0) (<= (- string-pos 16) 126) (= movimientos 3)) (equal? (substring string-juego (- string-pos 16) (- string-pos 15)) "0")) (and (and (>= (- string-pos 32)  0) (<= (- string-pos 32) 126)) (equal? (substring string-juego (- string-pos 32) (- string-pos 31)) "0")) (and (and (>= (- string-pos 48)  0) (<= (- string-pos 48) 126)) (equal? (substring string-juego (- string-pos 48) (- string-pos 47)) "0")) (and (>= (- string-pos 64)  0) (<= (- string-pos 64) 126)) (equal? #f (equal? (substring string-juego (- string-pos 63) (- string-pos 62)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 64) "TN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 16)  0) (<= (- string-pos 16) 126) (= movimientos 4)) (equal? (substring string-juego (- string-pos 16) (- string-pos 15)) "0")) (and (and (>= (- string-pos 32)  0) (<= (- string-pos 32) 126)) (equal? (substring string-juego (- string-pos 32) (- string-pos 31)) "0")) (and (and (>= (- string-pos 48)  0) (<= (- string-pos 48) 126)) (equal? (substring string-juego (- string-pos 48) (- string-pos 47)) "0")) (and (and (>= (- string-pos 64)  0) (<= (- string-pos 64) 126)) (equal? (substring string-juego (- string-pos 64) (- string-pos 63)) "0")) (and (>= (- string-pos 80)  0) (<= (- string-pos 80) 126)) (equal? #f (equal? (substring string-juego (- string-pos 79) (- string-pos 78)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 80) "TN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 16)  0) (<= (- string-pos 16) 126) (= movimientos 5)) (equal? (substring string-juego (- string-pos 16) (- string-pos 15)) "0")) (and (and (>= (- string-pos 32)  0) (<= (- string-pos 32) 126)) (equal? (substring string-juego (- string-pos 32) (- string-pos 31)) "0")) (and (and (>= (- string-pos 48)  0) (<= (- string-pos 48) 126)) (equal? (substring string-juego (- string-pos 48) (- string-pos 47)) "0")) (and (and (>= (- string-pos 64)  0) (<= (- string-pos 64) 126)) (equal? (substring string-juego (- string-pos 64) (- string-pos 63)) "0")) (and (and (>= (- string-pos 80)  0) (<= (- string-pos 80) 126)) (equal? (substring string-juego (- string-pos 80) (- string-pos 79)) "0")) (and (>= (- string-pos 96)  0) (<= (- string-pos 96) 126)) (equal? #f (equal? (substring string-juego (- string-pos 95) (- string-pos 94)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 96) "TN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 16)  0) (<= (- string-pos 16) 126) (= movimientos 6)) (equal? (substring string-juego (- string-pos 16) (- string-pos 15)) "0")) (and (and (>= (- string-pos 32)  0) (<= (- string-pos 32) 126)) (equal? (substring string-juego (- string-pos 32) (- string-pos 31)) "0")) (and (and (>= (- string-pos 48)  0) (<= (- string-pos 48) 126)) (equal? (substring string-juego (- string-pos 48) (- string-pos 47)) "0")) (and (and (>= (- string-pos 64)  0) (<= (- string-pos 64) 126)) (equal? (substring string-juego (- string-pos 64) (- string-pos 63)) "0")) (and (and (>= (- string-pos 80)  0) (<= (- string-pos 80) 126)) (equal? (substring string-juego (- string-pos 80) (- string-pos 79)) "0")) (and (and (>= (- string-pos 96)  0) (<= (- string-pos 96) 126)) (equal? (substring string-juego (- string-pos 96) (- string-pos 95)) "0")) (and (>= (- string-pos 112)  0) (<= (- string-pos 112) 126)) (equal? #f (equal? (substring string-juego (- string-pos 111) (- string-pos 110)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 112) "TN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    #| movimientos inferiores |#
                                                                    [(and (and (>= (+ string-pos 16)  0) (<= (+ string-pos 16) 126) (= movimientos 7)) (equal? #f (equal? (substring string-juego (+ string-pos 17) (+ string-pos 18)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 16) "TN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 16)  0) (<= (+ string-pos 16) 126) (= movimientos 8)) (equal? (substring string-juego (+ string-pos 16) (+ string-pos 17)) "0")) (and (>= (+ string-pos 32)  0) (<= (+ string-pos 32) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 33) (+ string-pos 34)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 32) "TN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 16)  0) (<= (+ string-pos 16) 126) (= movimientos 9)) (equal? (substring string-juego (+ string-pos 16) (+ string-pos 17)) "0")) (and (and (>= (+ string-pos 32)  0) (<= (+ string-pos 32) 126)) (equal? (substring string-juego (+ string-pos 32) (+ string-pos 33)) "0")) (and (>= (+ string-pos 48)  0) (<= (+ string-pos 48) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 49) (+ string-pos 50)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 48) "TN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 16)  0) (<= (+ string-pos 16) 126) (= movimientos 10)) (equal? (substring string-juego (+ string-pos 16) (+ string-pos 17)) "0")) (and (and (>= (+ string-pos 32)  0) (<= (+ string-pos 32) 126)) (equal? (substring string-juego (+ string-pos 32) (+ string-pos 33)) "0")) (and (and (>= (+ string-pos 48)  0) (<= (+ string-pos 48) 126)) (equal? (substring string-juego (+ string-pos 48) (+ string-pos 49)) "0")) (and (>= (+ string-pos 64)  0) (<= (+ string-pos 64) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 65) (+ string-pos 66)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 64) "TN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 16)  0) (<= (+ string-pos 16) 126) (= movimientos 11)) (equal? (substring string-juego (+ string-pos 16) (+ string-pos 17)) "0")) (and (and (>= (+ string-pos 32)  0) (<= (+ string-pos 32) 126)) (equal? (substring string-juego (+ string-pos 32) (+ string-pos 33)) "0")) (and (and (>= (+ string-pos 48)  0) (<= (+ string-pos 48) 126)) (equal? (substring string-juego (+ string-pos 48) (+ string-pos 49)) "0")) (and (and (>= (+ string-pos 64)  0) (<= (+ string-pos 64) 126)) (equal? (substring string-juego (+ string-pos 64) (+ string-pos 65)) "0")) (and (>= (+ string-pos 80)  0) (<= (+ string-pos 80) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 81) (+ string-pos 82)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 80) "TN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 16)  0) (<= (+ string-pos 16) 126) (= movimientos 12)) (equal? (substring string-juego (+ string-pos 16) (+ string-pos 17)) "0")) (and (and (>= (+ string-pos 32)  0) (<= (+ string-pos 32) 126)) (equal? (substring string-juego (+ string-pos 32) (+ string-pos 33)) "0")) (and (and (>= (+ string-pos 48)  0) (<= (+ string-pos 48) 126)) (equal? (substring string-juego (+ string-pos 48) (+ string-pos 49)) "0")) (and (and (>= (+ string-pos 64)  0) (<= (+ string-pos 64) 126)) (equal? (substring string-juego (+ string-pos 64) (+ string-pos 65)) "0")) (and (and (>= (+ string-pos 80)  0) (<= (+ string-pos 80) 126)) (equal? (substring string-juego (+ string-pos 80) (+ string-pos 81)) "0")) (and (>= (+ string-pos 96)  0) (<= (+ string-pos 96) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 97) (+ string-pos 98)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 96) "TN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 16)  0) (<= (+ string-pos 16) 126) (= movimientos 13)) (equal? (substring string-juego (+ string-pos 16) (+ string-pos 17)) "0")) (and (and (>= (+ string-pos 32)  0) (<= (+ string-pos 32) 126)) (equal? (substring string-juego (+ string-pos 32) (+ string-pos 33)) "0")) (and (and (>= (+ string-pos 48)  0) (<= (+ string-pos 48) 126)) (equal? (substring string-juego (+ string-pos 48) (+ string-pos 49)) "0")) (and (and (>= (+ string-pos 64)  0) (<= (+ string-pos 64) 126)) (equal? (substring string-juego (+ string-pos 64) (+ string-pos 65)) "0")) (and (and (>= (+ string-pos 80)  0) (<= (+ string-pos 80) 126)) (equal? (substring string-juego (+ string-pos 80) (+ string-pos 81)) "0")) (and (and (>= (+ string-pos 96)  0) (<= (+ string-pos 96) 126)) (equal? (substring string-juego (+ string-pos 96) (+ string-pos 97)) "0")) (and (>= (+ string-pos 112)  0) (<= (+ string-pos 112) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 113) (+ string-pos 114)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 112) "TN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    #| movimientos derechos |#
                                                                    [(and (and (>= (+ string-pos 2)  0) (<= (+ string-pos 2) 126) (= movimientos 14)) (= (quotient string-pos 16) (quotient (+ string-pos 2) 16)) (equal? #f (equal? (substring string-juego (+ string-pos 3) (+ string-pos 4)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 2) "TN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 2)  0) (<= (+ string-pos 2) 126) (= movimientos 15)) (= (quotient string-pos 16) (quotient (+ string-pos 4) 16)) (equal? (substring string-juego (+ string-pos 2) (+ string-pos 3)) "0")) (and (>= (+ string-pos 4)  0) (<= (+ string-pos 4) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 5) (+ string-pos 6)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 4) "TN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 2)  0) (<= (+ string-pos 2) 126) (= movimientos 16)) (= (quotient string-pos 16) (quotient (+ string-pos 6) 16)) (equal? (substring string-juego (+ string-pos 2) (+ string-pos 3)) "0")) (and (and (>= (+ string-pos 4)  0) (<= (+ string-pos 4) 126)) (equal? (substring string-juego (+ string-pos 4) (+ string-pos 5)) "0")) (and (>= (+ string-pos 6)  0) (<= (+ string-pos 6) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 7) (+ string-pos 8)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 6) "TN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 2)  0) (<= (+ string-pos 2) 126) (= movimientos 17)) (= (quotient string-pos 16) (quotient (+ string-pos 8) 16)) (equal? (substring string-juego (+ string-pos 2) (+ string-pos 3)) "0")) (and (and (>= (+ string-pos 4)  0) (<= (+ string-pos 4) 126)) (equal? (substring string-juego (+ string-pos 4) (+ string-pos 5)) "0")) (and (and (>= (+ string-pos 6)  0) (<= (+ string-pos 6) 126)) (equal? (substring string-juego (+ string-pos 6) (+ string-pos 7)) "0")) (and (>= (+ string-pos 8)  0) (<= (+ string-pos 8) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 9) (+ string-pos 10)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 8) "TN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 2)  0) (<= (+ string-pos 2) 126) (= movimientos 18)) (= (quotient string-pos 16) (quotient (+ string-pos 10) 16)) (equal? (substring string-juego (+ string-pos 2) (+ string-pos 3)) "0")) (and (and (>= (+ string-pos 4)  0) (<= (+ string-pos 4) 126)) (equal? (substring string-juego (+ string-pos 4) (+ string-pos 5)) "0")) (and (and (>= (+ string-pos 6)  0) (<= (+ string-pos 6) 126)) (equal? (substring string-juego (+ string-pos 6) (+ string-pos 7)) "0")) (and (and (>= (+ string-pos 8)  0) (<= (+ string-pos 8) 126)) (equal? (substring string-juego (+ string-pos 8) (+ string-pos 9)) "0")) (and (>= (+ string-pos 10)  0) (<= (+ string-pos 10) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 11) (+ string-pos 12)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 10) "TN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 2)  0) (<= (+ string-pos 2) 126) (= movimientos 19)) (= (quotient string-pos 16) (quotient (+ string-pos 12) 16)) (equal? (substring string-juego (+ string-pos 2) (+ string-pos 3)) "0")) (and (and (>= (+ string-pos 4)  0) (<= (+ string-pos 4) 126)) (equal? (substring string-juego (+ string-pos 4) (+ string-pos 5)) "0")) (and (and (>= (+ string-pos 6)  0) (<= (+ string-pos 6) 126)) (equal? (substring string-juego (+ string-pos 6) (+ string-pos 7)) "0")) (and (and (>= (+ string-pos 8)  0) (<= (+ string-pos 8) 126)) (equal? (substring string-juego (+ string-pos 8) (+ string-pos 9)) "0")) (and (and (>= (+ string-pos 10)  0) (<= (+ string-pos 10) 126)) (equal? (substring string-juego (+ string-pos 10) (+ string-pos 11)) "0")) (and (>= (+ string-pos 12)  0) (<= (+ string-pos 12) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 13) (+ string-pos 14)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 12) "TN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 2)  0) (<= (+ string-pos 2) 126) (= movimientos 20)) (= (quotient string-pos 16) (quotient (+ string-pos 14) 16)) (equal? (substring string-juego (+ string-pos 2) (+ string-pos 3)) "0")) (and (and (>= (+ string-pos 4)  0) (<= (+ string-pos 4) 126)) (equal? (substring string-juego (+ string-pos 4) (+ string-pos 5)) "0")) (and (and (>= (+ string-pos 6)  0) (<= (+ string-pos 6) 126)) (equal? (substring string-juego (+ string-pos 6) (+ string-pos 7)) "0")) (and (and (>= (+ string-pos 8)  0) (<= (+ string-pos 8) 126)) (equal? (substring string-juego (+ string-pos 8) (+ string-pos 9)) "0")) (and (and (>= (+ string-pos 10)  0) (<= (+ string-pos 10) 126)) (equal? (substring string-juego (+ string-pos 10) (+ string-pos 11)) "0")) (and (and (>= (+ string-pos 12)  0) (<= (+ string-pos 12) 126)) (equal? (substring string-juego (+ string-pos 12) (+ string-pos 13)) "0")) (and (>= (+ string-pos 14)  0) (<= (+ string-pos 14) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 15) (+ string-pos 16)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 14) "TN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    #| movimientos izquierdos |#
                                                                    [(and (and (>= (- string-pos 2)  0) (<= (- string-pos 2) 126)) (= movimientos 21) (= (quotient string-pos 16) (quotient (- string-pos 2) 16)) (equal? #f (equal? (substring string-juego (- string-pos 1) (- string-pos 0)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 2) "TN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 2)  0) (<= (- string-pos 2) 126) (= movimientos 22)) (= (quotient string-pos 16) (quotient (- string-pos 4) 16)) (equal? (substring string-juego (- string-pos 2) (- string-pos 1)) "0")) (and (>= (- string-pos 4)  0) (<= (- string-pos 4) 126)) (equal? #f (equal? (substring string-juego (- string-pos 3) (- string-pos 2)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 4) "TN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 2)  0) (<= (- string-pos 2) 126) (= movimientos 23)) (= (quotient string-pos 16) (quotient (- string-pos 6) 16)) (equal? (substring string-juego (- string-pos 2) (- string-pos 1)) "0")) (and (and (>= (- string-pos 4)  0) (<= (- string-pos 4) 126)) (equal? (substring string-juego (- string-pos 4) (- string-pos 3)) "0")) (and (>= (- string-pos 6)  0) (<= (- string-pos 6) 126)) (equal? #f (equal? (substring string-juego (- string-pos 5) (- string-pos 4)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 6) "TN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 2)  0) (<= (- string-pos 2) 126) (= movimientos 24)) (= (quotient string-pos 16) (quotient (- string-pos 8) 16)) (equal? (substring string-juego (- string-pos 2) (- string-pos 1)) "0")) (and (and (>= (- string-pos 4)  0) (<= (- string-pos 4) 126)) (equal? (substring string-juego (- string-pos 4) (- string-pos 3)) "0")) (and (and (>= (- string-pos 6)  0) (<= (- string-pos 6) 126)) (equal? (substring string-juego (- string-pos 6) (- string-pos 5)) "0")) (and (>= (- string-pos 8)  0) (<= (- string-pos 8) 126)) (equal? #f (equal? (substring string-juego (- string-pos 7) (- string-pos 6)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 8) "TN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 2)  0) (<= (- string-pos 2) 126) (= movimientos 25)) (= (quotient string-pos 16) (quotient (- string-pos 10) 16)) (equal? (substring string-juego (- string-pos 2) (- string-pos 1)) "0")) (and (and (>= (- string-pos 4)  0) (<= (- string-pos 4) 126)) (equal? (substring string-juego (- string-pos 4) (- string-pos 3)) "0")) (and (and (>= (- string-pos 6)  0) (<= (- string-pos 6) 126)) (equal? (substring string-juego (- string-pos 6) (- string-pos 5)) "0")) (and (and (>= (- string-pos 8)  0) (<= (- string-pos 8) 126)) (equal? (substring string-juego (- string-pos 8) (- string-pos 7)) "0")) (and (>= (- string-pos 10)  0) (<= (- string-pos 10) 126)) (equal? #f (equal? (substring string-juego (- string-pos 9) (- string-pos 8)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 10) "TN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 2)  0) (<= (- string-pos 2) 126) (= movimientos 26)) (= (quotient string-pos 16) (quotient (- string-pos 12) 16)) (equal? (substring string-juego (- string-pos 2) (- string-pos 1)) "0")) (and (and (>= (- string-pos 4)  0) (<= (- string-pos 4) 126)) (equal? (substring string-juego (- string-pos 4) (- string-pos 3)) "0")) (and (and (>= (- string-pos 6)  0) (<= (- string-pos 6) 126)) (equal? (substring string-juego (- string-pos 6) (- string-pos 5)) "0")) (and (and (>= (- string-pos 8)  0) (<= (- string-pos 8) 126)) (equal? (substring string-juego (- string-pos 8) (- string-pos 7)) "0")) (and (and (>= (- string-pos 10)  0) (<= (- string-pos 10) 126)) (equal? (substring string-juego (- string-pos 10) (- string-pos 9)) "0")) (and (>= (- string-pos 12)  0) (<= (- string-pos 12) 126)) (equal? #f (equal? (substring string-juego (- string-pos 11) (- string-pos 10)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 12) "TN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 2)  0) (<= (- string-pos 2) 126) (= movimientos 27)) (= (quotient string-pos 16) (quotient (- string-pos 14) 16)) (equal? (substring string-juego (- string-pos 2) (- string-pos 1)) "0")) (and (and (>= (- string-pos 4)  0) (<= (- string-pos 4) 126)) (equal? (substring string-juego (- string-pos 4) (- string-pos 3)) "0")) (and (and (>= (- string-pos 6)  0) (<= (- string-pos 6) 126)) (equal? (substring string-juego (- string-pos 6) (- string-pos 5)) "0")) (and (and (>= (- string-pos 8)  0) (<= (- string-pos 8) 126)) (equal? (substring string-juego (- string-pos 8) (- string-pos 7)) "0")) (and (and (>= (- string-pos 10)  0) (<= (- string-pos 10) 126)) (equal? (substring string-juego (- string-pos 10) (- string-pos 9)) "0")) (and (and (>= (- string-pos 12)  0) (<= (- string-pos 12) 126)) (equal? (substring string-juego (- string-pos 12) (- string-pos 11)) "0")) (and (>= (- string-pos 14)  0) (<= (- string-pos 14) 126)) (equal? #f (equal? (substring string-juego (- string-pos 13) (- string-pos 12)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 14) "TN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    ; no se puede hacer el movimiento.
                                                                    [else (jaque-mate-negro string-pos (+ movimientos 1))]
                                                                  ); fin cond
                                                              ; de lo contrario
                                                                  #| la torre no elimna el jaque o el posible mate |#
                                                                  (jaque-mate-negro (+ string-pos 2) 0)
                                                              ); fin if
        ]; de lo contrario
        [(equal? (substring string-juego string-pos (+ string-pos 1)) "C") (if (<= movimientos 7)
                                                                  (cond
                                                                    [(and (>= (- string-pos 34) 0) (<= (- string-pos 34) 126) (= movimientos 0) (and (> (quotient string-pos 16) (quotient (- string-pos 34) 16)) (> (remainder string-pos 16) (remainder (- string-pos 34) 16))) (equal? #f (equal? (substring string-juego (- string-pos 33) (- string-pos 32)) "N")))
                                                                                            (string-copy! string-juego string-pos "00")
                                                                                            (string-copy! string-juego (- string-pos 34) "CN")
                                                                                            (if (equal? (jaque 0 "RN") #t)
                                                                                                (begin
                                                                                                  (string-copy! string-juego 0 string-juego-copy)
                                                                                                  (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                ); fin begin true
                                                                                            ; de lo contrario
                                                                                                (begin
                                                                                                  (string-copy! string-juego 0 string-juego-copy)
                                                                                                  #f
                                                                                                ); fin begin false
                                                                                            ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (>= (- string-pos 30) 0) (<= (- string-pos 30) 126) (= movimientos 1) (and (> (quotient string-pos 16) (quotient (- string-pos 30) 16)) (< (remainder string-pos 16) (remainder (- string-pos 30) 16))) (equal? #f (equal? (substring string-juego (- string-pos 29) (- string-pos 28)) "N")))
                                                                                            (string-copy! string-juego string-pos "00")
                                                                                            (string-copy! string-juego (- string-pos 30) "CN")
                                                                                            (if (equal? (jaque 0 "RN") #t)
                                                                                                (begin
                                                                                                  (string-copy! string-juego 0 string-juego-copy)
                                                                                                  (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                ); fin begin true
                                                                                            ; de lo contrario
                                                                                                (begin
                                                                                                  (string-copy! string-juego 0 string-juego-copy)
                                                                                                  #f
                                                                                                ); fin begin false
                                                                                            ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (>= (- string-pos 20) 0) (<= (- string-pos 20) 126) (= movimientos 2) (and (> (quotient string-pos 16) (quotient (- string-pos 20) 16)) (> (remainder string-pos 16) (remainder (- string-pos 20) 16))) (equal? #f (equal? (substring string-juego (- string-pos 19) (- string-pos 18)) "N")))
                                                                                            (string-copy! string-juego string-pos "00")
                                                                                            (string-copy! string-juego (- string-pos 20) "CN")
                                                                                            (if (equal? (jaque 0 "RN") #t)
                                                                                                (begin
                                                                                                  (string-copy! string-juego 0 string-juego-copy)
                                                                                                  (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                ); fin begin true
                                                                                            ; de lo contrario
                                                                                                (begin
                                                                                                  (string-copy! string-juego 0 string-juego-copy)
                                                                                                  #f
                                                                                                ); fin begin false
                                                                                            ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (>= (- string-pos 12) 0) (<= (- string-pos 12) 126) (= movimientos 3) (and (> (quotient string-pos 16) (quotient (- string-pos 12) 16)) (< (remainder string-pos 16) (remainder (- string-pos 12) 16))) (equal? #f (equal? (substring string-juego (- string-pos 11) (- string-pos 10)) "N")))
                                                                                            (string-copy! string-juego string-pos "00")
                                                                                            (string-copy! string-juego (- string-pos 12) "CN")
                                                                                            (if (equal? (jaque 0 "RN") #t)
                                                                                                (begin
                                                                                                  (string-copy! string-juego 0 string-juego-copy)
                                                                                                  (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                ); fin begin true
                                                                                            ; de lo contrario
                                                                                                (begin
                                                                                                  (string-copy! string-juego 0 string-juego-copy)
                                                                                                  #f
                                                                                                ); fin begin false
                                                                                            ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (>= (+ string-pos 12) 0) (<= (+ string-pos 12) 126) (= movimientos 4) (and (< (quotient string-pos 16) (quotient (+ string-pos 12) 16)) (> (remainder string-pos 16) (remainder (+ string-pos 12) 16))) (equal? #f (equal? (substring string-juego (+ string-pos 13) (+ string-pos 14)) "N")))
                                                                                            (string-copy! string-juego string-pos "00")
                                                                                            (string-copy! string-juego (+ string-pos 12) "CN")
                                                                                            (if (equal? (jaque 0 "RN") #t)
                                                                                                (begin
                                                                                                  (string-copy! string-juego 0 string-juego-copy)
                                                                                                  (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                ); fin begin true
                                                                                            ; de lo contrario
                                                                                                (begin
                                                                                                  (string-copy! string-juego 0 string-juego-copy)
                                                                                                  #f
                                                                                                ); fin begin false
                                                                                            ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (>= (+ string-pos 20) 0) (<= (+ string-pos 20) 126) (= movimientos 5) (and (< (quotient string-pos 16) (quotient (+ string-pos 20) 16)) (< (remainder string-pos 16) (remainder (+ string-pos 20) 16))) (equal? #f (equal? (substring string-juego (+ string-pos 21) (+ string-pos 22)) "N")))
                                                                                            (string-copy! string-juego string-pos "00")
                                                                                            (string-copy! string-juego (+ string-pos 20) "CN")
                                                                                            (if (equal? (jaque 0 "RN") #t)
                                                                                                (begin
                                                                                                  (string-copy! string-juego 0 string-juego-copy)
                                                                                                  (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                ); fin begin true
                                                                                            ; de lo contrario
                                                                                                (begin
                                                                                                  (string-copy! string-juego 0 string-juego-copy)
                                                                                                  #f
                                                                                                ); fin begin false
                                                                                            ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (>= (+ string-pos 30) 0) (<= (+ string-pos 30) 126) (= movimientos 6) (and (< (quotient string-pos 16) (quotient (+ string-pos 30) 16)) (> (remainder string-pos 16) (remainder (+ string-pos 30) 16))) (equal? #f (equal? (substring string-juego (+ string-pos 31) (+ string-pos 32)) "N"))) 
                                                                                            (string-copy! string-juego string-pos "00")
                                                                                            (string-copy! string-juego (+ string-pos 30) "CN")
                                                                                            (if (equal? (jaque 0 "RN") #t)
                                                                                                (begin
                                                                                                  (string-copy! string-juego 0 string-juego-copy)
                                                                                                  (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                ); fin begin true
                                                                                            ; de lo contrario
                                                                                                (begin
                                                                                                  (string-copy! string-juego 0 string-juego-copy)
                                                                                                  #f
                                                                                                ); fin begin false
                                                                                            ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (>= (+ string-pos 34) 0) (<= (+ string-pos 34) 126) (= movimientos 7) (and (< (quotient string-pos 16) (quotient (+ string-pos 34) 16)) (< (remainder string-pos 16) (remainder (+ string-pos 34) 16))) (equal? #f (equal? (substring string-juego (+ string-pos 35) (+ string-pos 36)) "N")))
                                                                                            (string-copy! string-juego string-pos "00")
                                                                                            (string-copy! string-juego (+ string-pos 34) "CN")
                                                                                            (if (equal? (jaque 0 "RN") #t)
                                                                                                (begin
                                                                                                  (string-copy! string-juego 0 string-juego-copy)
                                                                                                  (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                ); fin begin true
                                                                                            ; de lo contrario
                                                                                                (begin
                                                                                                  (string-copy! string-juego 0 string-juego-copy)
                                                                                                  #f
                                                                                                ); fin begin false
                                                                                            ); fin if
                                                                    ]; de lo contrario
                                                                    ; no se puede hacer el movimiento
                                                                    [else (jaque-mate-negro string-pos (+ movimientos 1))]
                                                                  ); fin cond
                                                              ; de lo contrario
                                                                  #| el caballo no elimna el jaque o el posible mate |#
                                                                  (jaque-mate-negro (+ string-pos 2) 0)
                                                              ); fin if
        ]; de lo contrario
        [(equal? (substring string-juego string-pos (+ string-pos 1)) "A") (if (<= movimientos 27)
                                                                  (cond
                                                                    #| movimientos arriba a la izquierda |#
                                                                    [(and (and (>= (- string-pos 18)  0) (<= (- string-pos 18) 126)) (= movimientos 0) (and (> (quotient string-pos 16) (quotient (- string-pos 18) 16)) (> (remainder string-pos 16) (remainder (- string-pos 18) 16))) (equal? #f (equal? (substring string-juego (- string-pos 17) (- string-pos 16)) "N"))) 
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 18) "AN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 18)  0) (<= (- string-pos 18) 126) (= movimientos 1)) (and (> (quotient string-pos 16) (quotient (- string-pos 36) 16)) (> (remainder string-pos 16) (remainder (- string-pos 36) 16))) (equal? (substring string-juego (- string-pos 18) (- string-pos 17)) "0")) (and (>= (- string-pos 36)  0) (<= (- string-pos 36) 126)) (equal? #f (equal? (substring string-juego (- string-pos 35) (- string-pos 34)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 36) "AN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 18)  0) (<= (- string-pos 18) 126) (= movimientos 2)) (and (> (quotient string-pos 16) (quotient (- string-pos 54) 16)) (> (remainder string-pos 16) (remainder (- string-pos 54) 16))) (equal? (substring string-juego (- string-pos 18) (- string-pos 17)) "0")) (and (and (>= (- string-pos 36)  0) (<= (- string-pos 36) 126)) (equal? (substring string-juego (- string-pos 36) (- string-pos 35)) "0")) (and (>= (- string-pos 54)  0) (<= (- string-pos 54) 126)) (equal? #f (equal? (substring string-juego (- string-pos 53) (- string-pos 52)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 54) "AN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 18)  0) (<= (- string-pos 18) 126) (= movimientos 3)) (and (> (quotient string-pos 16) (quotient (- string-pos 72) 16)) (> (remainder string-pos 16) (remainder (- string-pos 72) 16))) (equal? (substring string-juego (- string-pos 18) (- string-pos 17)) "0")) (and (and (>= (- string-pos 36)  0) (<= (- string-pos 36) 126)) (equal? (substring string-juego (- string-pos 36) (- string-pos 35)) "0")) (and (and (>= (- string-pos 54)  0) (<= (- string-pos 54) 126)) (equal? (substring string-juego (- string-pos 54) (- string-pos 53)) "0")) (and (>= (- string-pos 72)  0) (<= (- string-pos 72) 126)) (equal? #f (equal? (substring string-juego (- string-pos 71) (- string-pos 70)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 72) "AN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 18)  0) (<= (- string-pos 18) 126) (= movimientos 4)) (and (> (quotient string-pos 16) (quotient (- string-pos 90) 16)) (> (remainder string-pos 16) (remainder (- string-pos 90) 16))) (equal? (substring string-juego (- string-pos 18) (- string-pos 17)) "0")) (and (and (>= (- string-pos 36)  0) (<= (- string-pos 36) 126)) (equal? (substring string-juego (- string-pos 36) (- string-pos 35)) "0")) (and (and (>= (- string-pos 54)  0) (<= (- string-pos 54) 126)) (equal? (substring string-juego (- string-pos 54) (- string-pos 53)) "0")) (and (and (>= (- string-pos 72)  0) (<= (- string-pos 72) 126)) (equal? (substring string-juego (- string-pos 72) (- string-pos 71)) "0")) (and (>= (- string-pos 90)  0) (<= (- string-pos 90) 126)) (equal? #f (equal? (substring string-juego (- string-pos 89) (- string-pos 88)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 90) "AN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 18)  0) (<= (- string-pos 18) 126) (= movimientos 5)) (and (> (quotient string-pos 16) (quotient (- string-pos 108) 16)) (> (remainder string-pos 16) (remainder (- string-pos 108) 16))) (equal? (substring string-juego (- string-pos 18) (- string-pos 17)) "0")) (and (and (>= (- string-pos 36)  0) (<= (- string-pos 36) 126)) (equal? (substring string-juego (- string-pos 36) (- string-pos 35)) "0")) (and (and (>= (- string-pos 54)  0) (<= (- string-pos 54) 126)) (equal? (substring string-juego (- string-pos 54) (- string-pos 53)) "0")) (and (and (>= (- string-pos 72)  0) (<= (- string-pos 72) 126)) (equal? (substring string-juego (- string-pos 72) (- string-pos 71)) "0")) (and (and (>= (- string-pos 90)  0) (<= (- string-pos 90) 126)) (equal? (substring string-juego (- string-pos 90) (- string-pos 89)) "0")) (and (>= (- string-pos 108)  0) (<= (- string-pos 108) 126)) (equal? #f (equal? (substring string-juego (- string-pos 107) (- string-pos 106)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 108) "AN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 18)  0) (<= (- string-pos 18) 126) (= movimientos 6)) (and (> (quotient string-pos 16) (quotient (- string-pos 126) 16)) (> (remainder string-pos 16) (remainder (- string-pos 126) 16))) (equal? (substring string-juego (- string-pos 18) (- string-pos 17)) "0")) (and (and (>= (- string-pos 36)  0) (<= (- string-pos 36) 126)) (equal? (substring string-juego (- string-pos 36) (- string-pos 35)) "0")) (and (and (>= (- string-pos 54)  0) (<= (- string-pos 54) 126)) (equal? (substring string-juego (- string-pos 54) (- string-pos 53)) "0")) (and (and (>= (- string-pos 72)  0) (<= (- string-pos 72) 126)) (equal? (substring string-juego (- string-pos 72) (- string-pos 71)) "0")) (and (and (>= (- string-pos 90)  0) (<= (- string-pos 90) 126)) (equal? (substring string-juego (- string-pos 90) (- string-pos 89)) "0")) (and (and (>= (- string-pos 108)  0) (<= (- string-pos 108) 126)) (equal? (substring string-juego (- string-pos 108) (- string-pos 107)) "0")) (and (>= (- string-pos 126)  0) (<= (- string-pos 126) 126)) (equal? #f (equal? (substring string-juego (- string-pos 125) (- string-pos 124)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 126) "AN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    #| movimientos abajo a la derecha |#
                                                                    [(and (and (>= (+ string-pos 18)  0) (<= (+ string-pos 18) 126) (= movimientos 7)) (and (< (quotient string-pos 16) (quotient (+ string-pos 18) 16)) (< (remainder string-pos 16) (remainder (+ string-pos 18) 16))) (equal? #f (equal? (substring string-juego (+ string-pos 19) (+ string-pos 20)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 18) "AN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 18)  0) (<= (+ string-pos 18) 126) (= movimientos 8)) (and (< (quotient string-pos 16) (quotient (+ string-pos 36) 16)) (< (remainder string-pos 16) (remainder (+ string-pos 36) 16))) (equal? (substring string-juego (+ string-pos 18) (+ string-pos 19)) "0")) (and (>= (+ string-pos 36)  0) (<= (+ string-pos 36) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 37) (+ string-pos 38)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 36) "AN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 18)  0) (<= (+ string-pos 18) 126) (= movimientos 9)) (and (< (quotient string-pos 16) (quotient (+ string-pos 54) 16)) (< (remainder string-pos 16) (remainder (+ string-pos 54) 16))) (equal? (substring string-juego (+ string-pos 18) (+ string-pos 19)) "0")) (and (and (>= (+ string-pos 36)  0) (<= (+ string-pos 36) 126)) (equal? (substring string-juego (+ string-pos 36) (+ string-pos 37)) "0")) (and (>= (+ string-pos 54)  0) (<= (+ string-pos 54) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 55) (+ string-pos 56)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 54) "AN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 18)  0) (<= (+ string-pos 18) 126) (= movimientos 10)) (and (< (quotient string-pos 16) (quotient (+ string-pos 72) 16)) (< (remainder string-pos 16) (remainder (+ string-pos 72) 16))) (equal? (substring string-juego (+ string-pos 18) (+ string-pos 19)) "0")) (and (and (>= (+ string-pos 36)  0) (<= (+ string-pos 36) 126)) (equal? (substring string-juego (+ string-pos 36) (+ string-pos 37)) "0")) (and (and (>= (+ string-pos 54)  0) (<= (+ string-pos 54) 126)) (equal? (substring string-juego (+ string-pos 54) (+ string-pos 55)) "0")) (and (>= (+ string-pos 72)  0) (<= (+ string-pos 72) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 73) (+ string-pos 74)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 72) "AN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 18)  0) (<= (+ string-pos 18) 126) (= movimientos 11)) (and (< (quotient string-pos 16) (quotient (+ string-pos 90) 16)) (< (remainder string-pos 16) (remainder (+ string-pos 90) 16))) (equal? (substring string-juego (+ string-pos 18) (+ string-pos 19)) "0")) (and (and (>= (+ string-pos 36)  0) (<= (+ string-pos 36) 126)) (equal? (substring string-juego (+ string-pos 36) (+ string-pos 37)) "0")) (and (and (>= (+ string-pos 54)  0) (<= (+ string-pos 54) 126)) (equal? (substring string-juego (+ string-pos 54) (+ string-pos 55)) "0")) (and (and (>= (+ string-pos 72)  0) (<= (+ string-pos 72) 126)) (equal? (substring string-juego (+ string-pos 72) (+ string-pos 73)) "0")) (and (>= (+ string-pos 90)  0) (<= (+ string-pos 90) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 91) (+ string-pos 92)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 90) "AN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 18)  0) (<= (+ string-pos 18) 126) (= movimientos 12)) (and (< (quotient string-pos 16) (quotient (+ string-pos 108) 16)) (< (remainder string-pos 16) (remainder (+ string-pos 108) 16))) (equal? (substring string-juego (+ string-pos 18) (+ string-pos 19)) "0")) (and (and (>= (+ string-pos 36)  0) (<= (+ string-pos 36) 126)) (equal? (substring string-juego (+ string-pos 36) (+ string-pos 37)) "0")) (and (and (>= (+ string-pos 54)  0) (<= (+ string-pos 54) 126)) (equal? (substring string-juego (+ string-pos 54) (+ string-pos 55)) "0")) (and (and (>= (+ string-pos 72)  0) (<= (+ string-pos 72) 126)) (equal? (substring string-juego (+ string-pos 72) (+ string-pos 73)) "0")) (and (and (>= (+ string-pos 90)  0) (<= (+ string-pos 90) 126)) (equal? (substring string-juego (+ string-pos 90) (+ string-pos 91)) "0")) (and (>= (+ string-pos 108)  0) (<= (+ string-pos 108) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 109) (+ string-pos 110)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 108) "AN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 18)  0) (<= (+ string-pos 18) 126) (= movimientos 13)) (and (< (quotient string-pos 16) (quotient (+ string-pos 126) 16)) (< (remainder string-pos 16) (remainder (+ string-pos 126) 16))) (equal? (substring string-juego (+ string-pos 18) (+ string-pos 19)) "0")) (and (and (>= (+ string-pos 36)  0) (<= (+ string-pos 36) 126)) (equal? (substring string-juego (+ string-pos 36) (+ string-pos 37)) "0")) (and (and (>= (+ string-pos 54)  0) (<= (+ string-pos 54) 126)) (equal? (substring string-juego (+ string-pos 54) (+ string-pos 55)) "0")) (and (and (>= (+ string-pos 72)  0) (<= (+ string-pos 72) 126)) (equal? (substring string-juego (+ string-pos 72) (+ string-pos 73)) "0")) (and (and (>= (+ string-pos 90)  0) (<= (+ string-pos 90) 126)) (equal? (substring string-juego (+ string-pos 90) (+ string-pos 91)) "0")) (and (and (>= (+ string-pos 108)  0) (<= (+ string-pos 108) 126)) (equal? (substring string-juego (+ string-pos 108) (+ string-pos 109)) "0")) (and (>= (+ string-pos 126)  0) (<= (+ string-pos 126) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 127) (+ string-pos 128)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 126) "AN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    #| movimientos abajo a la izquierda |#
                                                                    [(and (and (>= (+ string-pos 14)  0) (<= (+ string-pos 14) 126)) (= movimientos 14) (and (< (quotient string-pos 16) (quotient (+ string-pos 14) 16)) (> (remainder string-pos 16) (remainder (+ string-pos 14) 16))) (equal? #f (equal? (substring string-juego (+ string-pos 15) (+ string-pos 16)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 14) "AN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 14)  0) (<= (+ string-pos 14) 126) (= movimientos 15)) (and (< (quotient string-pos 16) (quotient (+ string-pos 28) 16)) (> (remainder string-pos 16) (remainder (+ string-pos 28) 16))) (equal? (substring string-juego (+ string-pos 14) (+ string-pos 15)) "0")) (and (>= (+ string-pos 28)  0) (<= (+ string-pos 28) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 29) (+ string-pos 30)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 28) "AN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 14)  0) (<= (+ string-pos 14) 126) (= movimientos 16)) (and (< (quotient string-pos 16) (quotient (+ string-pos 42) 16)) (> (remainder string-pos 16) (remainder (+ string-pos 42) 16))) (equal? (substring string-juego (+ string-pos 14) (+ string-pos 15)) "0")) (and (and (>= (+ string-pos 28)  0) (<= (+ string-pos 28) 126)) (equal? (substring string-juego (+ string-pos 28) (+ string-pos 29)) "0")) (and (>= (+ string-pos 42)  0) (<= (+ string-pos 42) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 43) (+ string-pos 44)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 42) "AN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 14)  0) (<= (+ string-pos 14) 126) (= movimientos 17)) (and (< (quotient string-pos 16) (quotient (+ string-pos 54) 16)) (> (remainder string-pos 16) (remainder (+ string-pos 54) 16))) (equal? (substring string-juego (+ string-pos 14) (+ string-pos 15)) "0")) (and (and (>= (+ string-pos 28)  0) (<= (+ string-pos 28) 126)) (equal? (substring string-juego (+ string-pos 28) (+ string-pos 29)) "0")) (and (and (>= (+ string-pos 42)  0) (<= (+ string-pos 42) 126)) (equal? (substring string-juego (+ string-pos 42) (+ string-pos 43)) "0")) (and (>= (+ string-pos 56)  0) (<= (+ string-pos 56) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 57) (+ string-pos 58)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 54) "AN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 14)  0) (<= (+ string-pos 14) 126) (= movimientos 18)) (and (< (quotient string-pos 16) (quotient (+ string-pos 70) 16)) (> (remainder string-pos 16) (remainder (+ string-pos 70) 16))) (equal? (substring string-juego (+ string-pos 14) (+ string-pos 15)) "0")) (and (and (>= (+ string-pos 28)  0) (<= (+ string-pos 28) 126)) (equal? (substring string-juego (+ string-pos 28) (+ string-pos 29)) "0")) (and (and (>= (+ string-pos 42)  0) (<= (+ string-pos 42) 126)) (equal? (substring string-juego (+ string-pos 42) (+ string-pos 43)) "0")) (and (and (>= (+ string-pos 56)  0) (<= (+ string-pos 56) 126)) (equal? (substring string-juego (+ string-pos 56) (+ string-pos 57)) "0")) (and (>= (+ string-pos 70)  0) (<= (+ string-pos 70) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 71) (+ string-pos 72)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 70) "AN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 14)  0) (<= (+ string-pos 14) 126) (= movimientos 19)) (and (< (quotient string-pos 16) (quotient (+ string-pos 84) 16)) (> (remainder string-pos 16) (remainder (+ string-pos 84) 16))) (equal? (substring string-juego (+ string-pos 14) (+ string-pos 15)) "0")) (and (and (>= (+ string-pos 28)  0) (<= (+ string-pos 28) 126)) (equal? (substring string-juego (+ string-pos 28) (+ string-pos 29)) "0")) (and (and (>= (+ string-pos 42)  0) (<= (+ string-pos 42) 126)) (equal? (substring string-juego (+ string-pos 42) (+ string-pos 43)) "0")) (and (and (>= (+ string-pos 56)  0) (<= (+ string-pos 56) 126)) (equal? (substring string-juego (+ string-pos 56) (+ string-pos 57)) "0")) (and (and (>= (+ string-pos 70)  0) (<= (+ string-pos 70) 126)) (equal? (substring string-juego (+ string-pos 70) (+ string-pos 71)) "0")) (and (>= (+ string-pos 84)  0) (<= (+ string-pos 84) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 85) (+ string-pos 86)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 84) "AN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 14)  0) (<= (+ string-pos 14) 126) (= movimientos 20)) (and (< (quotient string-pos 16) (quotient (+ string-pos 98) 16)) (> (remainder string-pos 16) (remainder (+ string-pos 98) 16))) (equal? (substring string-juego (+ string-pos 14) (+ string-pos 15)) "0")) (and (and (>= (+ string-pos 28)  0) (<= (+ string-pos 28) 126)) (equal? (substring string-juego (+ string-pos 28) (+ string-pos 29)) "0")) (and (and (>= (+ string-pos 42)  0) (<= (+ string-pos 42) 126)) (equal? (substring string-juego (+ string-pos 42) (+ string-pos 43)) "0")) (and (and (>= (+ string-pos 56)  0) (<= (+ string-pos 56) 126)) (equal? (substring string-juego (+ string-pos 56) (+ string-pos 57)) "0")) (and (and (>= (+ string-pos 70)  0) (<= (+ string-pos 70) 126)) (equal? (substring string-juego (+ string-pos 70) (+ string-pos 71)) "0")) (and (and (>= (+ string-pos 84)  0) (<= (+ string-pos 84) 126)) (equal? (substring string-juego (+ string-pos 84) (+ string-pos 85)) "0")) (and (>= (+ string-pos 98)  0) (<= (+ string-pos 98) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 99) (+ string-pos 100)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 98) "AN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    #| movimientos arriba a la derecha |#
                                                                    [(and (and (>= (- string-pos 14)  0) (<= (- string-pos 14) 126)) (= movimientos 14) (and (> (quotient string-pos 16) (quotient (- string-pos 14) 16)) (< (remainder string-pos 16) (remainder (- string-pos 14) 16))) (equal? #f (equal? (substring string-juego (- string-pos 13) (- string-pos 12)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 14) "AN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (- movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 14)  0) (<= (- string-pos 14) 126) (= movimientos 15)) (and (> (quotient string-pos 16) (quotient (- string-pos 28) 16)) (< (remainder string-pos 16) (remainder (- string-pos 28) 16))) (equal? (substring string-juego (- string-pos 14) (- string-pos 13)) "0")) (and (>= (- string-pos 28)  0) (<= (- string-pos 28) 126)) (equal? #f (equal? (substring string-juego (- string-pos 27) (- string-pos 26)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 28) "AN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (- movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 14)  0) (<= (- string-pos 14) 126) (= movimientos 16)) (and (> (quotient string-pos 16) (quotient (- string-pos 42) 16)) (< (remainder string-pos 16) (remainder (- string-pos 42) 16))) (equal? (substring string-juego (- string-pos 14) (- string-pos 13)) "0")) (and (and (>= (- string-pos 28)  0) (<= (- string-pos 28) 126)) (equal? (substring string-juego (- string-pos 28) (- string-pos 27)) "0")) (and (>= (- string-pos 42)  0) (<= (- string-pos 42) 126)) (equal? #f (equal? (substring string-juego (- string-pos 41) (- string-pos 40)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 42) "AN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (- movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 14)  0) (<= (- string-pos 14) 126) (= movimientos 17)) (and (> (quotient string-pos 16) (quotient (- string-pos 54) 16)) (< (remainder string-pos 16) (remainder (- string-pos 54) 16))) (equal? (substring string-juego (- string-pos 14) (- string-pos 13)) "0")) (and (and (>= (- string-pos 28)  0) (<= (- string-pos 28) 126)) (equal? (substring string-juego (- string-pos 28) (- string-pos 27)) "0")) (and (and (>= (- string-pos 42)  0) (<= (- string-pos 42) 126)) (equal? (substring string-juego (- string-pos 42) (- string-pos 41)) "0")) (and (>= (- string-pos 56)  0) (<= (- string-pos 56) 126)) (equal? #f (equal? (substring string-juego (- string-pos 55) (- string-pos 54)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 54) "AN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (- movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 14)  0) (<= (- string-pos 14) 126) (= movimientos 18)) (and (> (quotient string-pos 16) (quotient (- string-pos 70) 16)) (< (remainder string-pos 16) (remainder (- string-pos 70) 16))) (equal? (substring string-juego (- string-pos 14) (- string-pos 13)) "0")) (and (and (>= (- string-pos 28)  0) (<= (- string-pos 28) 126)) (equal? (substring string-juego (- string-pos 28) (- string-pos 27)) "0")) (and (and (>= (- string-pos 42)  0) (<= (- string-pos 42) 126)) (equal? (substring string-juego (- string-pos 42) (- string-pos 41)) "0")) (and (and (>= (- string-pos 56)  0) (<= (- string-pos 56) 126)) (equal? (substring string-juego (- string-pos 56) (- string-pos 55)) "0")) (and (>= (- string-pos 70)  0) (<= (- string-pos 70) 126)) (equal? #f (equal? (substring string-juego (- string-pos 69) (- string-pos 68)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 70) "AN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (- movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 14)  0) (<= (- string-pos 14) 126) (= movimientos 19)) (and (> (quotient string-pos 84) (quotient (- string-pos 14) 16)) (< (remainder string-pos 16) (remainder (- string-pos 84) 16))) (equal? (substring string-juego (- string-pos 14) (- string-pos 13)) "0")) (and (and (>= (- string-pos 28)  0) (<= (- string-pos 28) 126)) (equal? (substring string-juego (- string-pos 28) (- string-pos 27)) "0")) (and (and (>= (- string-pos 42)  0) (<= (- string-pos 42) 126)) (equal? (substring string-juego (- string-pos 42) (- string-pos 41)) "0")) (and (and (>= (- string-pos 56)  0) (<= (- string-pos 56) 126)) (equal? (substring string-juego (- string-pos 56) (- string-pos 55)) "0")) (and (and (>= (- string-pos 70)  0) (<= (- string-pos 70) 126)) (equal? (substring string-juego (- string-pos 70) (- string-pos 69)) "0")) (and (>= (- string-pos 84)  0) (<= (- string-pos 84) 126)) (equal? #f (equal? (substring string-juego (- string-pos 83) (- string-pos 82)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 84) "AN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (- movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 14)  0) (<= (- string-pos 14) 126) (= movimientos 20)) (and (> (quotient string-pos 16) (quotient (- string-pos 98) 16)) (< (remainder string-pos 16) (remainder (- string-pos 98) 16))) (equal? (substring string-juego (- string-pos 14) (- string-pos 13)) "0")) (and (and (>= (- string-pos 28)  0) (<= (- string-pos 28) 126)) (equal? (substring string-juego (- string-pos 28) (- string-pos 27)) "0")) (and (and (>= (- string-pos 42)  0) (<= (- string-pos 42) 126)) (equal? (substring string-juego (- string-pos 42) (- string-pos 41)) "0")) (and (and (>= (- string-pos 56)  0) (<= (- string-pos 56) 126)) (equal? (substring string-juego (- string-pos 56) (- string-pos 55)) "0")) (and (and (>= (- string-pos 70)  0) (<= (- string-pos 70) 126)) (equal? (substring string-juego (- string-pos 70) (- string-pos 69)) "0")) (and (and (>= (- string-pos 84)  0) (<= (- string-pos 84) 126)) (equal? (substring string-juego (- string-pos 84) (- string-pos 83)) "0")) (and (>= (- string-pos 98)  0) (<= (- string-pos 98) 126)) (equal? #f (equal? (substring string-juego (- string-pos 97) (- string-pos 96)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 98) "AN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (- movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    ; no se puede hacer el movimiento.
                                                                    [else (jaque-mate-negro string-pos (+ movimientos 1))]
                                                                  ); fin cond
                                                              ; de lo contrario
                                                                  #| la torre no elimna el jaque o el posible mate |#
                                                                  (jaque-mate-negro (+ string-pos 2) 0)
                                                              ); fin if
        ]; de lo contrario
        [(equal? (substring string-juego string-pos (+ string-pos 1)) "Q") (if (<= movimientos 55)
                                                                  (cond
                                                                    #| movimientos superiores |#
                                                                    [(and (and (>= (- string-pos 16)  0) (<= (- string-pos 16) 126)) (= movimientos 0) (equal? #f (equal? (substring string-juego (- string-pos 15) (- string-pos 14)) "N"))) 
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 16) "QN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (>= (- string-pos 16)  0) (<= (- string-pos 16) 126) (= movimientos 1)) (equal? (substring string-juego (- string-pos 16) (- string-pos 15)) "0") (and (>= (- string-pos 32)  0) (<= (- string-pos 32) 126)) (equal? #f (equal? (substring string-juego (- string-pos 31) (- string-pos 30)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 32) "QN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 16)  0) (<= (- string-pos 16) 126) (= movimientos 2)) (equal? (substring string-juego (- string-pos 16) (- string-pos 15)) "0")) (and (and (>= (- string-pos 32)  0) (<= (- string-pos 32) 126)) (equal? (substring string-juego (- string-pos 32) (- string-pos 31)) "0")) (and (>= (- string-pos 48)  0) (<= (- string-pos 48) 126)) (equal? #f (equal? (substring string-juego (- string-pos 47) (- string-pos 46)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 48) "QN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 16)  0) (<= (- string-pos 16) 126) (= movimientos 3)) (equal? (substring string-juego (- string-pos 16) (- string-pos 15)) "0")) (and (and (>= (- string-pos 32)  0) (<= (- string-pos 32) 126)) (equal? (substring string-juego (- string-pos 32) (- string-pos 31)) "0")) (and (and (>= (- string-pos 48)  0) (<= (- string-pos 48) 126)) (equal? (substring string-juego (- string-pos 48) (- string-pos 47)) "0")) (and (>= (- string-pos 64)  0) (<= (- string-pos 64) 126)) (equal? #f (equal? (substring string-juego (- string-pos 63) (- string-pos 62)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 64) "QN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 16)  0) (<= (- string-pos 16) 126) (= movimientos 4)) (equal? (substring string-juego (- string-pos 16) (- string-pos 15)) "0")) (and (and (>= (- string-pos 32)  0) (<= (- string-pos 32) 126)) (equal? (substring string-juego (- string-pos 32) (- string-pos 31)) "0")) (and (and (>= (- string-pos 48)  0) (<= (- string-pos 48) 126)) (equal? (substring string-juego (- string-pos 48) (- string-pos 47)) "0")) (and (and (>= (- string-pos 64)  0) (<= (- string-pos 64) 126)) (equal? (substring string-juego (- string-pos 64) (- string-pos 63)) "0")) (and (>= (- string-pos 80)  0) (<= (- string-pos 80) 126)) (equal? #f (equal? (substring string-juego (- string-pos 79) (- string-pos 78)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 80) "QN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 16)  0) (<= (- string-pos 16) 126) (= movimientos 5)) (equal? (substring string-juego (- string-pos 16) (- string-pos 15)) "0")) (and (and (>= (- string-pos 32)  0) (<= (- string-pos 32) 126)) (equal? (substring string-juego (- string-pos 32) (- string-pos 31)) "0")) (and (and (>= (- string-pos 48)  0) (<= (- string-pos 48) 126)) (equal? (substring string-juego (- string-pos 48) (- string-pos 47)) "0")) (and (and (>= (- string-pos 64)  0) (<= (- string-pos 64) 126)) (equal? (substring string-juego (- string-pos 64) (- string-pos 63)) "0")) (and (and (>= (- string-pos 80)  0) (<= (- string-pos 80) 126)) (equal? (substring string-juego (- string-pos 80) (- string-pos 79)) "0")) (and (>= (- string-pos 96)  0) (<= (- string-pos 96) 126)) (equal? #f (equal? (substring string-juego (- string-pos 95) (- string-pos 94)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 96) "QN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 16)  0) (<= (- string-pos 16) 126) (= movimientos 6)) (equal? (substring string-juego (- string-pos 16) (- string-pos 15)) "0")) (and (and (>= (- string-pos 32)  0) (<= (- string-pos 32) 126)) (equal? (substring string-juego (- string-pos 32) (- string-pos 31)) "0")) (and (and (>= (- string-pos 48)  0) (<= (- string-pos 48) 126)) (equal? (substring string-juego (- string-pos 48) (- string-pos 47)) "0")) (and (and (>= (- string-pos 64)  0) (<= (- string-pos 64) 126)) (equal? (substring string-juego (- string-pos 64) (- string-pos 63)) "0")) (and (and (>= (- string-pos 80)  0) (<= (- string-pos 80) 126)) (equal? (substring string-juego (- string-pos 80) (- string-pos 79)) "0")) (and (and (>= (- string-pos 96)  0) (<= (- string-pos 96) 126)) (equal? (substring string-juego (- string-pos 96) (- string-pos 95)) "0")) (and (>= (- string-pos 112)  0) (<= (- string-pos 112) 126)) (equal? #f (equal? (substring string-juego (- string-pos 111) (- string-pos 110)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 112) "QN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    #| movimientos inferiores |#
                                                                    [(and (and (>= (+ string-pos 16)  0) (<= (+ string-pos 16) 126) (= movimientos 7)) (equal? #f (equal? (substring string-juego (+ string-pos 17) (+ string-pos 18)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 16) "QN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 16)  0) (<= (+ string-pos 16) 126) (= movimientos 8)) (equal? (substring string-juego (+ string-pos 16) (+ string-pos 17)) "0")) (and (>= (+ string-pos 32)  0) (<= (+ string-pos 32) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 33) (+ string-pos 34)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 32) "QN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 16)  0) (<= (+ string-pos 16) 126) (= movimientos 9)) (equal? (substring string-juego (+ string-pos 16) (+ string-pos 17)) "0")) (and (and (>= (+ string-pos 32)  0) (<= (+ string-pos 32) 126)) (equal? (substring string-juego (+ string-pos 32) (+ string-pos 33)) "0")) (and (>= (+ string-pos 48)  0) (<= (+ string-pos 48) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 49) (+ string-pos 50)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 48) "QN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 16)  0) (<= (+ string-pos 16) 126) (= movimientos 10)) (equal? (substring string-juego (+ string-pos 16) (+ string-pos 17)) "0")) (and (and (>= (+ string-pos 32)  0) (<= (+ string-pos 32) 126)) (equal? (substring string-juego (+ string-pos 32) (+ string-pos 33)) "0")) (and (and (>= (+ string-pos 48)  0) (<= (+ string-pos 48) 126)) (equal? (substring string-juego (+ string-pos 48) (+ string-pos 49)) "0")) (and (>= (+ string-pos 64)  0) (<= (+ string-pos 64) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 65) (+ string-pos 66)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 64) "QN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 16)  0) (<= (+ string-pos 16) 126) (= movimientos 11)) (equal? (substring string-juego (+ string-pos 16) (+ string-pos 17)) "0")) (and (and (>= (+ string-pos 32)  0) (<= (+ string-pos 32) 126)) (equal? (substring string-juego (+ string-pos 32) (+ string-pos 33)) "0")) (and (and (>= (+ string-pos 48)  0) (<= (+ string-pos 48) 126)) (equal? (substring string-juego (+ string-pos 48) (+ string-pos 49)) "0")) (and (and (>= (+ string-pos 64)  0) (<= (+ string-pos 64) 126)) (equal? (substring string-juego (+ string-pos 64) (+ string-pos 65)) "0")) (and (>= (+ string-pos 80)  0) (<= (+ string-pos 80) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 81) (+ string-pos 82)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 80) "QN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 16)  0) (<= (+ string-pos 16) 126) (= movimientos 12)) (equal? (substring string-juego (+ string-pos 16) (+ string-pos 17)) "0")) (and (and (>= (+ string-pos 32)  0) (<= (+ string-pos 32) 126)) (equal? (substring string-juego (+ string-pos 32) (+ string-pos 33)) "0")) (and (and (>= (+ string-pos 48)  0) (<= (+ string-pos 48) 126)) (equal? (substring string-juego (+ string-pos 48) (+ string-pos 49)) "0")) (and (and (>= (+ string-pos 64)  0) (<= (+ string-pos 64) 126)) (equal? (substring string-juego (+ string-pos 64) (+ string-pos 65)) "0")) (and (and (>= (+ string-pos 80)  0) (<= (+ string-pos 80) 126)) (equal? (substring string-juego (+ string-pos 80) (+ string-pos 81)) "0")) (and (>= (+ string-pos 96)  0) (<= (+ string-pos 96) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 97) (+ string-pos 98)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 96) "QN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 16)  0) (<= (+ string-pos 16) 126) (= movimientos 13)) (equal? (substring string-juego (+ string-pos 16) (+ string-pos 17)) "0")) (and (and (>= (+ string-pos 32)  0) (<= (+ string-pos 32) 126)) (equal? (substring string-juego (+ string-pos 32) (+ string-pos 33)) "0")) (and (and (>= (+ string-pos 48)  0) (<= (+ string-pos 48) 126)) (equal? (substring string-juego (+ string-pos 48) (+ string-pos 49)) "0")) (and (and (>= (+ string-pos 64)  0) (<= (+ string-pos 64) 126)) (equal? (substring string-juego (+ string-pos 64) (+ string-pos 65)) "0")) (and (and (>= (+ string-pos 80)  0) (<= (+ string-pos 80) 126)) (equal? (substring string-juego (+ string-pos 80) (+ string-pos 81)) "0")) (and (and (>= (+ string-pos 96)  0) (<= (+ string-pos 96) 126)) (equal? (substring string-juego (+ string-pos 96) (+ string-pos 97)) "0")) (and (>= (+ string-pos 112)  0) (<= (+ string-pos 112) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 113) (+ string-pos 114)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 112) "QN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    #| movimientos derechos |#
                                                                    [(and (and (>= (+ string-pos 2)  0) (<= (+ string-pos 2) 126)) (= movimientos 14) (= (quotient string-pos 16) (quotient (+ string-pos 2) 16)) (equal? #f (equal? (substring string-juego (+ string-pos 3) (+ string-pos 4)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 2) "QN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 2)  0) (<= (+ string-pos 2) 126) (= movimientos 15)) (= (quotient string-pos 16) (quotient (+ string-pos 4) 16)) (equal? (substring string-juego (+ string-pos 2) (+ string-pos 3)) "0")) (and (>= (+ string-pos 4)  0) (<= (+ string-pos 4) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 5) (+ string-pos 6)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 4) "QN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 2)  0) (<= (+ string-pos 2) 126) (= movimientos 16)) (= (quotient string-pos 16) (quotient (+ string-pos 6) 16)) (equal? (substring string-juego (+ string-pos 2) (+ string-pos 3)) "0")) (and (and (>= (+ string-pos 4)  0) (<= (+ string-pos 4) 126)) (equal? (substring string-juego (+ string-pos 4) (+ string-pos 5)) "0")) (and (>= (+ string-pos 6)  0) (<= (+ string-pos 6) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 7) (+ string-pos 8)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 6) "QN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 2)  0) (<= (+ string-pos 2) 126) (= movimientos 17)) (= (quotient string-pos 16) (quotient (+ string-pos 8) 16)) (equal? (substring string-juego (+ string-pos 2) (+ string-pos 3)) "0")) (and (and (>= (+ string-pos 4)  0) (<= (+ string-pos 4) 126)) (equal? (substring string-juego (+ string-pos 4) (+ string-pos 5)) "0")) (and (and (>= (+ string-pos 6)  0) (<= (+ string-pos 6) 126)) (equal? (substring string-juego (+ string-pos 6) (+ string-pos 7)) "0")) (and (>= (+ string-pos 8)  0) (<= (+ string-pos 8) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 9) (+ string-pos 10)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 8) "QN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 2)  0) (<= (+ string-pos 2) 126) (= movimientos 18)) (= (quotient string-pos 16) (quotient (+ string-pos 10) 16)) (equal? (substring string-juego (+ string-pos 2) (+ string-pos 3)) "0")) (and (and (>= (+ string-pos 4)  0) (<= (+ string-pos 4) 126)) (equal? (substring string-juego (+ string-pos 4) (+ string-pos 5)) "0")) (and (and (>= (+ string-pos 6)  0) (<= (+ string-pos 6) 126)) (equal? (substring string-juego (+ string-pos 6) (+ string-pos 7)) "0")) (and (and (>= (+ string-pos 8)  0) (<= (+ string-pos 8) 126)) (equal? (substring string-juego (+ string-pos 8) (+ string-pos 9)) "0")) (and (>= (+ string-pos 10)  0) (<= (+ string-pos 10) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 11) (+ string-pos 12)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 10) "QN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 2)  0) (<= (+ string-pos 2) 126) (= movimientos 19)) (= (quotient string-pos 16) (quotient (+ string-pos 12) 16)) (equal? (substring string-juego (+ string-pos 2) (+ string-pos 3)) "0")) (and (and (>= (+ string-pos 4)  0) (<= (+ string-pos 4) 126)) (equal? (substring string-juego (+ string-pos 4) (+ string-pos 5)) "0")) (and (and (>= (+ string-pos 6)  0) (<= (+ string-pos 6) 126)) (equal? (substring string-juego (+ string-pos 6) (+ string-pos 7)) "0")) (and (and (>= (+ string-pos 8)  0) (<= (+ string-pos 8) 126)) (equal? (substring string-juego (+ string-pos 8) (+ string-pos 9)) "0")) (and (and (>= (+ string-pos 10)  0) (<= (+ string-pos 10) 126)) (equal? (substring string-juego (+ string-pos 10) (+ string-pos 11)) "0")) (and (>= (+ string-pos 12)  0) (<= (+ string-pos 12) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 13) (+ string-pos 14)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 12) "QN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 2)  0) (<= (+ string-pos 2) 126) (= movimientos 20)) (= (quotient string-pos 16) (quotient (+ string-pos 14) 16)) (equal? (substring string-juego (+ string-pos 2) (+ string-pos 3)) "0")) (and (and (>= (+ string-pos 4)  0) (<= (+ string-pos 4) 126)) (equal? (substring string-juego (+ string-pos 4) (+ string-pos 5)) "0")) (and (and (>= (+ string-pos 6)  0) (<= (+ string-pos 6) 126)) (equal? (substring string-juego (+ string-pos 6) (+ string-pos 7)) "0")) (and (and (>= (+ string-pos 8)  0) (<= (+ string-pos 8) 126)) (equal? (substring string-juego (+ string-pos 8) (+ string-pos 9)) "0")) (and (and (>= (+ string-pos 10)  0) (<= (+ string-pos 10) 126)) (equal? (substring string-juego (+ string-pos 10) (+ string-pos 11)) "0")) (and (and (>= (+ string-pos 12)  0) (<= (+ string-pos 12) 126)) (equal? (substring string-juego (+ string-pos 12) (+ string-pos 13)) "0")) (and (>= (+ string-pos 14)  0) (<= (+ string-pos 14) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 15) (+ string-pos 16)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 14) "QN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    #| movimientos izquierdos |#
                                                                    [(and (and (>= (- string-pos 2)  0) (<= (- string-pos 2) 126)) (= movimientos 21) (= (quotient string-pos 16) (quotient (- string-pos 2) 16)) (equal? #f (equal? (substring string-juego (- string-pos 1) (- string-pos 0)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 2) "QN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 2)  0) (<= (- string-pos 2) 126) (= movimientos 22)) (= (quotient string-pos 16) (quotient (- string-pos 4) 16)) (equal? (substring string-juego (- string-pos 2) (- string-pos 1)) "0")) (and (>= (- string-pos 4)  0) (<= (- string-pos 4) 126)) (equal? #f (equal? (substring string-juego (- string-pos 3) (- string-pos 2)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 4) "QN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 2)  0) (<= (- string-pos 2) 126) (= movimientos 23)) (= (quotient string-pos 16) (quotient (- string-pos 6) 16)) (equal? (substring string-juego (- string-pos 2) (- string-pos 1)) "0")) (and (and (>= (- string-pos 4)  0) (<= (- string-pos 4) 126)) (equal? (substring string-juego (- string-pos 4) (- string-pos 3)) "0")) (and (>= (- string-pos 6)  0) (<= (- string-pos 6) 126)) (equal? #f (equal? (substring string-juego (- string-pos 5) (- string-pos 4)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 6) "QN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 2)  0) (<= (- string-pos 2) 126) (= movimientos 24)) (= (quotient string-pos 16) (quotient (- string-pos 8) 16)) (equal? (substring string-juego (- string-pos 2) (- string-pos 1)) "0")) (and (and (>= (- string-pos 4)  0) (<= (- string-pos 4) 126)) (equal? (substring string-juego (- string-pos 4) (- string-pos 3)) "0")) (and (and (>= (- string-pos 6)  0) (<= (- string-pos 6) 126)) (equal? (substring string-juego (- string-pos 6) (- string-pos 5)) "0")) (and (>= (- string-pos 8)  0) (<= (- string-pos 8) 126)) (equal? #f (equal? (substring string-juego (- string-pos 7) (- string-pos 6)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 8) "QN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 2)  0) (<= (- string-pos 2) 126) (= movimientos 25)) (= (quotient string-pos 16) (quotient (- string-pos 10) 16)) (equal? (substring string-juego (- string-pos 2) (- string-pos 1)) "0")) (and (and (>= (- string-pos 4)  0) (<= (- string-pos 4) 126)) (equal? (substring string-juego (- string-pos 4) (- string-pos 3)) "0")) (and (and (>= (- string-pos 6)  0) (<= (- string-pos 6) 126)) (equal? (substring string-juego (- string-pos 6) (- string-pos 5)) "0")) (and (and (>= (- string-pos 8)  0) (<= (- string-pos 8) 126)) (equal? (substring string-juego (- string-pos 8) (- string-pos 7)) "0")) (and (>= (- string-pos 10)  0) (<= (- string-pos 10) 126)) (equal? #f (equal? (substring string-juego (- string-pos 9) (- string-pos 8)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 10) "QN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 2)  0) (<= (- string-pos 2) 126) (= movimientos 26)) (= (quotient string-pos 16) (quotient (- string-pos 12) 16)) (equal? (substring string-juego (- string-pos 2) (- string-pos 1)) "0")) (and (and (>= (- string-pos 4)  0) (<= (- string-pos 4) 126)) (equal? (substring string-juego (- string-pos 4) (- string-pos 3)) "0")) (and (and (>= (- string-pos 6)  0) (<= (- string-pos 6) 126)) (equal? (substring string-juego (- string-pos 6) (- string-pos 5)) "0")) (and (and (>= (- string-pos 8)  0) (<= (- string-pos 8) 126)) (equal? (substring string-juego (- string-pos 8) (- string-pos 7)) "0")) (and (and (>= (- string-pos 10)  0) (<= (- string-pos 10) 126)) (equal? (substring string-juego (- string-pos 10) (- string-pos 9)) "0")) (and (>= (- string-pos 12)  0) (<= (- string-pos 12) 126)) (equal? #f (equal? (substring string-juego (- string-pos 11) (- string-pos 10)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 12) "QN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 2)  0) (<= (- string-pos 2) 126) (= movimientos 27)) (= (quotient string-pos 16) (quotient (- string-pos 14) 16)) (equal? (substring string-juego (- string-pos 2) (- string-pos 1)) "0")) (and (and (>= (- string-pos 4)  0) (<= (- string-pos 4) 126)) (equal? (substring string-juego (- string-pos 4) (- string-pos 3)) "0")) (and (and (>= (- string-pos 6)  0) (<= (- string-pos 6) 126)) (equal? (substring string-juego (- string-pos 6) (- string-pos 5)) "0")) (and (and (>= (- string-pos 8)  0) (<= (- string-pos 8) 126)) (equal? (substring string-juego (- string-pos 8) (- string-pos 7)) "0")) (and (and (>= (- string-pos 10)  0) (<= (- string-pos 10) 126)) (equal? (substring string-juego (- string-pos 10) (- string-pos 9)) "0")) (and (and (>= (- string-pos 12)  0) (<= (- string-pos 12) 126)) (equal? (substring string-juego (- string-pos 12) (- string-pos 11)) "0")) (and (>= (- string-pos 14)  0) (<= (- string-pos 14) 126)) (equal? #f (equal? (substring string-juego (- string-pos 13) (- string-pos 12)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 14) "QN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    #| movimientos arriba a la izquierda |#
                                                                    [(and (and (>= (- string-pos 18)  0) (<= (- string-pos 18) 126)) (= movimientos 28) (and (> (quotient string-pos 16) (quotient (- string-pos 18) 16)) (> (remainder string-pos 16) (remainder (- string-pos 18) 16))) (equal? #f (equal? (substring string-juego (- string-pos 17) (- string-pos 16)) "N"))) 
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 18) "QN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 18)  0) (<= (- string-pos 18) 126) (= movimientos 29)) (and (> (quotient string-pos 16) (quotient (- string-pos 36) 16)) (> (remainder string-pos 16) (remainder (- string-pos 36) 16))) (equal? (substring string-juego (- string-pos 18) (- string-pos 17)) "0")) (and (>= (- string-pos 36)  0) (<= (- string-pos 36) 126)) (equal? #f (equal? (substring string-juego (- string-pos 35) (- string-pos 34)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 36) "QN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 18)  0) (<= (- string-pos 18) 126) (= movimientos 30)) (and (> (quotient string-pos 16) (quotient (- string-pos 54) 16)) (> (remainder string-pos 16) (remainder (- string-pos 54) 16))) (equal? (substring string-juego (- string-pos 18) (- string-pos 17)) "0")) (and (and (>= (- string-pos 36)  0) (<= (- string-pos 36) 126)) (equal? (substring string-juego (- string-pos 36) (- string-pos 35)) "0")) (and (>= (- string-pos 54)  0) (<= (- string-pos 54) 126)) (equal? #f (equal? (substring string-juego (- string-pos 53) (- string-pos 52)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 54) "QN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 18)  0) (<= (- string-pos 18) 126) (= movimientos 31)) (and (> (quotient string-pos 16) (quotient (- string-pos 72) 16)) (> (remainder string-pos 16) (remainder (- string-pos 72) 16))) (equal? (substring string-juego (- string-pos 18) (- string-pos 17)) "0")) (and (and (>= (- string-pos 36)  0) (<= (- string-pos 36) 126)) (equal? (substring string-juego (- string-pos 36) (- string-pos 35)) "0")) (and (and (>= (- string-pos 54)  0) (<= (- string-pos 54) 126)) (equal? (substring string-juego (- string-pos 54) (- string-pos 53)) "0")) (and (>= (- string-pos 72)  0) (<= (- string-pos 72) 126)) (equal? #f (equal? (substring string-juego (- string-pos 71) (- string-pos 70)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 72) "QN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 18)  0) (<= (- string-pos 18) 126) (= movimientos 32)) (and (> (quotient string-pos 16) (quotient (- string-pos 90) 16)) (> (remainder string-pos 16) (remainder (- string-pos 90) 16))) (equal? (substring string-juego (- string-pos 18) (- string-pos 17)) "0")) (and (and (>= (- string-pos 36)  0) (<= (- string-pos 36) 126)) (equal? (substring string-juego (- string-pos 36) (- string-pos 35)) "0")) (and (and (>= (- string-pos 54)  0) (<= (- string-pos 54) 126)) (equal? (substring string-juego (- string-pos 54) (- string-pos 53)) "0")) (and (and (>= (- string-pos 72)  0) (<= (- string-pos 72) 126)) (equal? (substring string-juego (- string-pos 72) (- string-pos 71)) "0")) (and (>= (- string-pos 90)  0) (<= (- string-pos 90) 126)) (equal? #f (equal? (substring string-juego (- string-pos 89) (- string-pos 88)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 90) "QN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 18)  0) (<= (- string-pos 18) 126) (= movimientos 33)) (and (> (quotient string-pos 16) (quotient (- string-pos 108) 16)) (> (remainder string-pos 16) (remainder (- string-pos 108) 16))) (equal? (substring string-juego (- string-pos 18) (- string-pos 17)) "0")) (and (and (>= (- string-pos 36)  0) (<= (- string-pos 36) 126)) (equal? (substring string-juego (- string-pos 36) (- string-pos 35)) "0")) (and (and (>= (- string-pos 54)  0) (<= (- string-pos 54) 126)) (equal? (substring string-juego (- string-pos 54) (- string-pos 53)) "0")) (and (and (>= (- string-pos 72)  0) (<= (- string-pos 72) 126)) (equal? (substring string-juego (- string-pos 72) (- string-pos 71)) "0")) (and (and (>= (- string-pos 90)  0) (<= (- string-pos 90) 126)) (equal? (substring string-juego (- string-pos 90) (- string-pos 89)) "0")) (and (>= (- string-pos 108)  0) (<= (- string-pos 108) 126)) (equal? #f (equal? (substring string-juego (- string-pos 107) (- string-pos 106)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 108) "QN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 18)  0) (<= (- string-pos 18) 126) (= movimientos 34)) (and (> (quotient string-pos 16) (quotient (- string-pos 126) 16)) (> (remainder string-pos 16) (remainder (- string-pos 126) 16))) (equal? (substring string-juego (- string-pos 18) (- string-pos 17)) "0")) (and (and (>= (- string-pos 36)  0) (<= (- string-pos 36) 126)) (equal? (substring string-juego (- string-pos 36) (- string-pos 35)) "0")) (and (and (>= (- string-pos 54)  0) (<= (- string-pos 54) 126)) (equal? (substring string-juego (- string-pos 54) (- string-pos 53)) "0")) (and (and (>= (- string-pos 72)  0) (<= (- string-pos 72) 126)) (equal? (substring string-juego (- string-pos 72) (- string-pos 71)) "0")) (and (and (>= (- string-pos 90)  0) (<= (- string-pos 90) 126)) (equal? (substring string-juego (- string-pos 90) (- string-pos 89)) "0")) (and (and (>= (- string-pos 108)  0) (<= (- string-pos 108) 126)) (equal? (substring string-juego (- string-pos 108) (- string-pos 107)) "0")) (and (>= (- string-pos 126)  0) (<= (- string-pos 126) 126)) (equal? #f (equal? (substring string-juego (- string-pos 125) (- string-pos 124)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 126) "QN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    #| movimientos abajo a la derecha |#
                                                                    [(and (and (>= (+ string-pos 18)  0) (<= (+ string-pos 18) 126) (= movimientos 35)) (and (< (quotient string-pos 16) (quotient (+ string-pos 18) 16)) (< (remainder string-pos 16) (remainder (+ string-pos 18) 16))) (equal? #f (equal? (substring string-juego (+ string-pos 19) (+ string-pos 20)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 18) "QN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 18)  0) (<= (+ string-pos 18) 126) (= movimientos 36)) (and (< (quotient string-pos 16) (quotient (+ string-pos 36) 16)) (< (remainder string-pos 16) (remainder (+ string-pos 36) 16))) (equal? (substring string-juego (+ string-pos 18) (+ string-pos 19)) "0")) (and (>= (+ string-pos 36)  0) (<= (+ string-pos 36) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 37) (+ string-pos 38)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 36) "QN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 18)  0) (<= (+ string-pos 18) 126) (= movimientos 37)) (and (< (quotient string-pos 16) (quotient (+ string-pos 54) 16)) (< (remainder string-pos 16) (remainder (+ string-pos 54) 16))) (equal? (substring string-juego (+ string-pos 18) (+ string-pos 19)) "0")) (and (and (>= (+ string-pos 36)  0) (<= (+ string-pos 36) 126)) (equal? (substring string-juego (+ string-pos 36) (+ string-pos 37)) "0")) (and (>= (+ string-pos 54)  0) (<= (+ string-pos 54) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 55) (+ string-pos 56)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 54) "QN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 18)  0) (<= (+ string-pos 18) 126) (= movimientos 38)) (and (< (quotient string-pos 16) (quotient (+ string-pos 72) 16)) (< (remainder string-pos 16) (remainder (+ string-pos 72) 16))) (equal? (substring string-juego (+ string-pos 18) (+ string-pos 19)) "0")) (and (and (>= (+ string-pos 36)  0) (<= (+ string-pos 36) 126)) (equal? (substring string-juego (+ string-pos 36) (+ string-pos 37)) "0")) (and (and (>= (+ string-pos 54)  0) (<= (+ string-pos 54) 126)) (equal? (substring string-juego (+ string-pos 54) (+ string-pos 55)) "0")) (and (>= (+ string-pos 72)  0) (<= (+ string-pos 72) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 73) (+ string-pos 74)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 72) "QN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 18)  0) (<= (+ string-pos 18) 126) (= movimientos 39)) (and (< (quotient string-pos 16) (quotient (+ string-pos 90) 16)) (< (remainder string-pos 16) (remainder (+ string-pos 90) 16))) (equal? (substring string-juego (+ string-pos 18) (+ string-pos 19)) "0")) (and (and (>= (+ string-pos 36)  0) (<= (+ string-pos 36) 126)) (equal? (substring string-juego (+ string-pos 36) (+ string-pos 37)) "0")) (and (and (>= (+ string-pos 54)  0) (<= (+ string-pos 54) 126)) (equal? (substring string-juego (+ string-pos 54) (+ string-pos 55)) "0")) (and (and (>= (+ string-pos 72)  0) (<= (+ string-pos 72) 126)) (equal? (substring string-juego (+ string-pos 72) (+ string-pos 73)) "0")) (and (>= (+ string-pos 90)  0) (<= (+ string-pos 90) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 91) (+ string-pos 92)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 90) "QN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 18)  0) (<= (+ string-pos 18) 126) (= movimientos 40)) (and (< (quotient string-pos 16) (quotient (+ string-pos 108) 16)) (< (remainder string-pos 16) (remainder (+ string-pos 108) 16))) (equal? (substring string-juego (+ string-pos 18) (+ string-pos 19)) "0")) (and (and (>= (+ string-pos 36)  0) (<= (+ string-pos 36) 126)) (equal? (substring string-juego (+ string-pos 36) (+ string-pos 37)) "0")) (and (and (>= (+ string-pos 54)  0) (<= (+ string-pos 54) 126)) (equal? (substring string-juego (+ string-pos 54) (+ string-pos 55)) "0")) (and (and (>= (+ string-pos 72)  0) (<= (+ string-pos 72) 126)) (equal? (substring string-juego (+ string-pos 72) (+ string-pos 73)) "0")) (and (and (>= (+ string-pos 90)  0) (<= (+ string-pos 90) 126)) (equal? (substring string-juego (+ string-pos 90) (+ string-pos 91)) "0")) (and (>= (+ string-pos 108)  0) (<= (+ string-pos 108) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 109) (+ string-pos 110)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 108) "QN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 18)  0) (<= (+ string-pos 18) 126) (= movimientos 41)) (and (< (quotient string-pos 16) (quotient (+ string-pos 126) 16)) (< (remainder string-pos 16) (remainder (+ string-pos 126) 16))) (equal? (substring string-juego (+ string-pos 18) (+ string-pos 19)) "0")) (and (and (>= (+ string-pos 36)  0) (<= (+ string-pos 36) 126)) (equal? (substring string-juego (+ string-pos 36) (+ string-pos 37)) "0")) (and (and (>= (+ string-pos 54)  0) (<= (+ string-pos 54) 126)) (equal? (substring string-juego (+ string-pos 54) (+ string-pos 55)) "0")) (and (and (>= (+ string-pos 72)  0) (<= (+ string-pos 72) 126)) (equal? (substring string-juego (+ string-pos 72) (+ string-pos 73)) "0")) (and (and (>= (+ string-pos 90)  0) (<= (+ string-pos 90) 126)) (equal? (substring string-juego (+ string-pos 90) (+ string-pos 91)) "0")) (and (and (>= (+ string-pos 108)  0) (<= (+ string-pos 108) 126)) (equal? (substring string-juego (+ string-pos 108) (+ string-pos 109)) "0")) (and (>= (+ string-pos 126)  0) (<= (+ string-pos 126) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 127) (+ string-pos 128)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 126) "QN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    #| movimientos abajo a la izquierda |#
                                                                    [(and (and (>= (+ string-pos 14)  0) (<= (+ string-pos 14) 126)) (= movimientos 42) (and (< (quotient string-pos 16) (quotient (+ string-pos 14) 16)) (> (remainder string-pos 16) (remainder (+ string-pos 14) 16))) (equal? #f (equal? (substring string-juego (+ string-pos 15) (+ string-pos 16)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 14) "QN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 14)  0) (<= (+ string-pos 14) 126) (= movimientos 43)) (and (< (quotient string-pos 16) (quotient (+ string-pos 28) 16)) (> (remainder string-pos 16) (remainder (+ string-pos 28) 16))) (equal? (substring string-juego (+ string-pos 14) (+ string-pos 15)) "0")) (and (>= (+ string-pos 28)  0) (<= (+ string-pos 28) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 29) (+ string-pos 30)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 28) "QN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 14)  0) (<= (+ string-pos 14) 126) (= movimientos 44)) (and (< (quotient string-pos 16) (quotient (+ string-pos 42) 16)) (> (remainder string-pos 16) (remainder (+ string-pos 42) 16))) (equal? (substring string-juego (+ string-pos 14) (+ string-pos 15)) "0")) (and (and (>= (+ string-pos 28)  0) (<= (+ string-pos 28) 126)) (equal? (substring string-juego (+ string-pos 28) (+ string-pos 29)) "0")) (and (>= (+ string-pos 42)  0) (<= (+ string-pos 42) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 43) (+ string-pos 44)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 42) "QN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 14)  0) (<= (+ string-pos 14) 126) (= movimientos 45)) (and (< (quotient string-pos 16) (quotient (+ string-pos 54) 16)) (> (remainder string-pos 16) (remainder (+ string-pos 54) 16))) (equal? (substring string-juego (+ string-pos 14) (+ string-pos 15)) "0")) (and (and (>= (+ string-pos 28)  0) (<= (+ string-pos 28) 126)) (equal? (substring string-juego (+ string-pos 28) (+ string-pos 29)) "0")) (and (and (>= (+ string-pos 42)  0) (<= (+ string-pos 42) 126)) (equal? (substring string-juego (+ string-pos 42) (+ string-pos 43)) "0")) (and (>= (+ string-pos 56)  0) (<= (+ string-pos 56) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 57) (+ string-pos 58)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 54) "QN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 14)  0) (<= (+ string-pos 14) 126) (= movimientos 46)) (and (< (quotient string-pos 16) (quotient (+ string-pos 70) 16)) (> (remainder string-pos 16) (remainder (+ string-pos 70) 16))) (equal? (substring string-juego (+ string-pos 14) (+ string-pos 15)) "0")) (and (and (>= (+ string-pos 28)  0) (<= (+ string-pos 28) 126)) (equal? (substring string-juego (+ string-pos 28) (+ string-pos 29)) "0")) (and (and (>= (+ string-pos 42)  0) (<= (+ string-pos 42) 126)) (equal? (substring string-juego (+ string-pos 42) (+ string-pos 43)) "0")) (and (and (>= (+ string-pos 56)  0) (<= (+ string-pos 56) 126)) (equal? (substring string-juego (+ string-pos 56) (+ string-pos 57)) "0")) (and (>= (+ string-pos 70)  0) (<= (+ string-pos 70) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 71) (+ string-pos 72)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 70) "QN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 14)  0) (<= (+ string-pos 14) 126) (= movimientos 47)) (and (< (quotient string-pos 16) (quotient (+ string-pos 84) 16)) (> (remainder string-pos 16) (remainder (+ string-pos 84) 16))) (equal? (substring string-juego (+ string-pos 14) (+ string-pos 15)) "0")) (and (and (>= (+ string-pos 28)  0) (<= (+ string-pos 28) 126)) (equal? (substring string-juego (+ string-pos 28) (+ string-pos 29)) "0")) (and (and (>= (+ string-pos 42)  0) (<= (+ string-pos 42) 126)) (equal? (substring string-juego (+ string-pos 42) (+ string-pos 43)) "0")) (and (and (>= (+ string-pos 56)  0) (<= (+ string-pos 56) 126)) (equal? (substring string-juego (+ string-pos 56) (+ string-pos 57)) "0")) (and (and (>= (+ string-pos 70)  0) (<= (+ string-pos 70) 126)) (equal? (substring string-juego (+ string-pos 70) (+ string-pos 71)) "0")) (and (>= (+ string-pos 84)  0) (<= (+ string-pos 84) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 85) (+ string-pos 86)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 84) "QN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (+ string-pos 14)  0) (<= (+ string-pos 14) 126) (= movimientos 48)) (and (< (quotient string-pos 16) (quotient (+ string-pos 98) 16)) (> (remainder string-pos 16) (remainder (+ string-pos 98) 16))) (equal? (substring string-juego (+ string-pos 14) (+ string-pos 15)) "0")) (and (and (>= (+ string-pos 28)  0) (<= (+ string-pos 28) 126)) (equal? (substring string-juego (+ string-pos 28) (+ string-pos 29)) "0")) (and (and (>= (+ string-pos 42)  0) (<= (+ string-pos 42) 126)) (equal? (substring string-juego (+ string-pos 42) (+ string-pos 43)) "0")) (and (and (>= (+ string-pos 56)  0) (<= (+ string-pos 56) 126)) (equal? (substring string-juego (+ string-pos 56) (+ string-pos 57)) "0")) (and (and (>= (+ string-pos 70)  0) (<= (+ string-pos 70) 126)) (equal? (substring string-juego (+ string-pos 70) (+ string-pos 71)) "0")) (and (and (>= (+ string-pos 84)  0) (<= (+ string-pos 84) 126)) (equal? (substring string-juego (+ string-pos 84) (+ string-pos 85)) "0")) (and (>= (+ string-pos 98)  0) (<= (+ string-pos 98) 126)) (equal? #f (equal? (substring string-juego (+ string-pos 99) (+ string-pos 100)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (+ string-pos 98) "QN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    #| movimientos arriba a la derecha |#
                                                                    [(and (and (>= (- string-pos 14)  0) (<= (- string-pos 14) 126)) (= movimientos 49) (and (> (quotient string-pos 16) (quotient (- string-pos 14) 16)) (< (remainder string-pos 16) (remainder (- string-pos 14) 16))) (equal? #f (equal? (substring string-juego (- string-pos 13) (- string-pos 12)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 14) "QN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 14)  0) (<= (- string-pos 14) 126) (= movimientos 50)) (and (> (quotient string-pos 16) (quotient (- string-pos 28) 16)) (< (remainder string-pos 16) (remainder (- string-pos 28) 16))) (equal? (substring string-juego (- string-pos 14) (- string-pos 13)) "0")) (and (>= (- string-pos 28)  0) (<= (- string-pos 28) 126)) (equal? #f (equal? (substring string-juego (- string-pos 27) (- string-pos 26)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 28) "QN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 14)  0) (<= (- string-pos 14) 126) (= movimientos 51)) (and (> (quotient string-pos 16) (quotient (- string-pos 42) 16)) (< (remainder string-pos 16) (remainder (- string-pos 42) 16))) (equal? (substring string-juego (- string-pos 14) (- string-pos 13)) "0")) (and (and (>= (- string-pos 28)  0) (<= (- string-pos 28) 126)) (equal? (substring string-juego (- string-pos 28) (- string-pos 27)) "0")) (and (>= (- string-pos 42)  0) (<= (- string-pos 42) 126)) (equal? #f (equal? (substring string-juego (- string-pos 41) (- string-pos 40)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 42) "QN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 14)  0) (<= (- string-pos 14) 126) (= movimientos 52)) (and (> (quotient string-pos 16) (quotient (- string-pos 54) 16)) (< (remainder string-pos 16) (remainder (- string-pos 54) 16))) (equal? (substring string-juego (- string-pos 14) (- string-pos 13)) "0")) (and (and (>= (- string-pos 28)  0) (<= (- string-pos 28) 126)) (equal? (substring string-juego (- string-pos 28) (- string-pos 27)) "0")) (and (and (>= (- string-pos 42)  0) (<= (- string-pos 42) 126)) (equal? (substring string-juego (- string-pos 42) (- string-pos 41)) "0")) (and (>= (- string-pos 56)  0) (<= (- string-pos 56) 126)) (equal? #f (equal? (substring string-juego (- string-pos 55) (- string-pos 54)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 54) "QN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 14)  0) (<= (- string-pos 14) 126) (= movimientos 53)) (and (> (quotient string-pos 16) (quotient (- string-pos 70) 16)) (< (remainder string-pos 16) (remainder (- string-pos 70) 16))) (equal? (substring string-juego (- string-pos 14) (- string-pos 13)) "0")) (and (and (>= (- string-pos 28)  0) (<= (- string-pos 28) 126)) (equal? (substring string-juego (- string-pos 28) (- string-pos 27)) "0")) (and (and (>= (- string-pos 42)  0) (<= (- string-pos 42) 126)) (equal? (substring string-juego (- string-pos 42) (- string-pos 41)) "0")) (and (and (>= (- string-pos 56)  0) (<= (- string-pos 56) 126)) (equal? (substring string-juego (- string-pos 56) (- string-pos 55)) "0")) (and (>= (- string-pos 70)  0) (<= (- string-pos 70) 126)) (equal? #f (equal? (substring string-juego (- string-pos 69) (- string-pos 68)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 70) "QN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 14)  0) (<= (- string-pos 14) 126) (= movimientos 54)) (and (> (quotient string-pos 16) (quotient (- string-pos 84) 16)) (< (remainder string-pos 16) (remainder (- string-pos 84) 16))) (equal? (substring string-juego (- string-pos 14) (- string-pos 13)) "0")) (and (and (>= (- string-pos 28)  0) (<= (- string-pos 28) 126)) (equal? (substring string-juego (- string-pos 28) (- string-pos 27)) "0")) (and (and (>= (- string-pos 42)  0) (<= (- string-pos 42) 126)) (equal? (substring string-juego (- string-pos 42) (- string-pos 41)) "0")) (and (and (>= (- string-pos 56)  0) (<= (- string-pos 56) 126)) (equal? (substring string-juego (- string-pos 56) (- string-pos 55)) "0")) (and (and (>= (- string-pos 70)  0) (<= (- string-pos 70) 126)) (equal? (substring string-juego (- string-pos 70) (- string-pos 69)) "0")) (and (>= (- string-pos 84)  0) (<= (- string-pos 84) 126)) (equal? #f (equal? (substring string-juego (- string-pos 83) (- string-pos 82)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 84) "QN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (and (>= (- string-pos 14)  0) (<= (- string-pos 14) 126) (= movimientos 55)) (and (> (quotient string-pos 16) (quotient (- string-pos 98) 16)) (< (remainder string-pos 16) (remainder (- string-pos 98) 16))) (equal? (substring string-juego (- string-pos 14) (- string-pos 13)) "0")) (and (and (>= (- string-pos 28)  0) (<= (- string-pos 28) 126)) (equal? (substring string-juego (- string-pos 28) (- string-pos 27)) "0")) (and (and (>= (- string-pos 42)  0) (<= (- string-pos 42) 126)) (equal? (substring string-juego (- string-pos 42) (- string-pos 41)) "0")) (and (and (>= (- string-pos 56)  0) (<= (- string-pos 56) 126)) (equal? (substring string-juego (- string-pos 56) (- string-pos 55)) "0")) (and (and (>= (- string-pos 70)  0) (<= (- string-pos 70) 126)) (equal? (substring string-juego (- string-pos 70) (- string-pos 69)) "0")) (and (and (>= (- string-pos 84)  0) (<= (- string-pos 84) 126)) (equal? (substring string-juego (- string-pos 84) (- string-pos 83)) "0")) (and (>= (- string-pos 98)  0) (<= (- string-pos 98) 126)) (equal? #f (equal? (substring string-juego (- string-pos 97) (- string-pos 96)) "N")))
                                                                                                         (string-copy! string-juego string-pos "00")
                                                                                                         (string-copy! string-juego (- string-pos 98) "QN")
                                                                                                         (if (equal? (jaque 0 "RN") #t)
                                                                                                             (begin
                                                                                                               (string-copy! string-juego 0 string-juego-copy)
                                                                                                               (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                             ); fin begin true
                                                                                                         ; de lo contrario
                                                                                                             (begin
                                                                                                                (string-copy! string-juego 0 string-juego-copy)
                                                                                                               #f
                                                                                                             ); fin begin false
                                                                                                         ); fin if
                                                                    ]; de lo contrario
                                                                    ; no se puede hacer el movimiento.
                                                                    [else (jaque-mate-negro string-pos (+ movimientos 1))]
                                                                  ); fin cond
                                                              ; de lo contrario
                                                                  #| la torre no elimna el jaque o el posible mate |#
                                                                  (jaque-mate-negro (+ string-pos 2) 0)
                                                              ); fin if
        ]; de lo contrario
        [(equal? (substring string-juego string-pos (+ string-pos 1)) "R") (if (<= movimientos 7)
                                                                  (cond
                                                                    [(and (and (>= (- string-pos 16) 0) (<= (- string-pos 16) 126) (= movimientos 0)) (or (equal? (substring string-juego (- string-pos 16) (- string-pos 15)) "0") (equal? (substring string-juego (- string-pos 16) (- string-pos 15)) "p") (equal? (substring string-juego (- string-pos 16) (- string-pos 15)) "t")  (equal? (substring string-juego (- string-pos 16) (- string-pos 15)) "c")  (equal? (substring string-juego (- string-pos 16) (- string-pos 15)) "a")  (equal? (substring string-juego (- string-pos 16) (- string-pos 15)) "q")))
                                                                                                   (string-copy! string-juego string-pos "00")
                                                                                                   (string-copy! string-juego (- string-pos 16) "RN")
                                                                                                   (if (equal? (jaque 0 "RN") #t)
                                                                                                       (begin
                                                                                                         (string-copy! string-juego 0 string-juego-copy)
                                                                                                         (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                       ); fin begin true
                                                                                                   ; de lo contrario
                                                                                                         (begin
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                           #f
                                                                                                         ); fin begin false
                                                                                                   ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (>= (- string-pos 14) 0) (<= (- string-pos 14) 126) (= movimientos 1)) (or (equal? (substring string-juego (- string-pos 14) (- string-pos 13)) "0") (equal? (substring string-juego (- string-pos 14) (- string-pos 13)) "p") (equal? (substring string-juego (- string-pos 14) (- string-pos 13)) "t")  (equal? (substring string-juego (- string-pos 14) (- string-pos 13)) "c")  (equal? (substring string-juego (- string-pos 14) (- string-pos 13)) "a")  (equal? (substring string-juego (- string-pos 14) (- string-pos 13)) "q")))
                                                                                                   (string-copy! string-juego string-pos "00")
                                                                                                   (string-copy! string-juego (- string-pos 14) "RN")
                                                                                                   (if (equal? (jaque 0 "RN") #t)
                                                                                                       (begin
                                                                                                         (string-copy! string-juego 0 string-juego-copy)
                                                                                                         (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                       ); fin begin true
                                                                                                   ; de lo contrario
                                                                                                         (begin
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                           #f
                                                                                                         ); fin begin false
                                                                                                   ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (>= (- string-pos 18) 0) (<= (- string-pos 18) 126) (= movimientos 2)) (or (equal? (substring string-juego (- string-pos 18) (- string-pos 17)) "0") (equal? (substring string-juego (- string-pos 18) (- string-pos 17)) "p") (equal? (substring string-juego (- string-pos 18) (- string-pos 17)) "t")  (equal? (substring string-juego (- string-pos 18) (- string-pos 17)) "c")  (equal? (substring string-juego (- string-pos 18) (- string-pos 17)) "a")  (equal? (substring string-juego (- string-pos 18) (- string-pos 17)) "q")))
                                                                                                   (string-copy! string-juego string-pos "00")
                                                                                                   (string-copy! string-juego (- string-pos 18) "RN")
                                                                                                   (if (equal? (jaque 0 "RN") #t)
                                                                                                       (begin
                                                                                                         (string-copy! string-juego 0 string-juego-copy)
                                                                                                         (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                       ); fin begin true
                                                                                                   ; de lo contrario
                                                                                                         (begin
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                           #f
                                                                                                         ); fin begin false
                                                                                                   ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (>= (- string-pos  2) 0) (<= (- string-pos  2) 126) (= movimientos 3)) (or (equal? (substring string-juego (- string-pos  2) (- string-pos  1)) "0") (equal? (substring string-juego (- string-pos  2) (- string-pos  1)) "p") (equal? (substring string-juego (- string-pos  2) (- string-pos  1)) "t")  (equal? (substring string-juego (- string-pos  2) (- string-pos  1)) "c")  (equal? (substring string-juego (- string-pos  2) (- string-pos  1)) "a")  (equal? (substring string-juego (- string-pos  2) (- string-pos  1)) "q")))
                                                                                                   (string-copy! string-juego string-pos "00")
                                                                                                   (string-copy! string-juego (- string-pos  2) "RN")
                                                                                                   (if (equal? (jaque 0 "RN") #t)
                                                                                                       (begin
                                                                                                         (string-copy! string-juego 0 string-juego-copy)
                                                                                                         (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                       ); fin begin true
                                                                                                   ; de lo contrario
                                                                                                         (begin
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                           #f
                                                                                                         ); fin begin false
                                                                                                   ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (>= (+ string-pos  2) 0) (<= (+ string-pos  2) 126) (= movimientos 4)) (or (equal? (substring string-juego (+ string-pos  2) (+ string-pos  3)) "0") (equal? (substring string-juego (+ string-pos  2) (+ string-pos  3)) "p") (equal? (substring string-juego (+ string-pos  2) (+ string-pos  3)) "t")  (equal? (substring string-juego (+ string-pos  2) (+ string-pos  3)) "c")  (equal? (substring string-juego (+ string-pos  2) (+ string-pos  3)) "a")  (equal? (substring string-juego (+ string-pos  2) (+ string-pos  3)) "q")))
                                                                                                   (string-copy! string-juego string-pos "00")
                                                                                                   (string-copy! string-juego (+ string-pos  2) "RN")
                                                                                                   (if (equal? (jaque 0 "RN") #t)
                                                                                                       (begin
                                                                                                         (string-copy! string-juego 0 string-juego-copy)
                                                                                                         (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                       ); fin begin true
                                                                                                   ; de lo contrario
                                                                                                         (begin
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                           #f
                                                                                                         ); fin begin false
                                                                                                   ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (>= (+ string-pos 18) 0) (<= (+ string-pos 18) 126) (= movimientos 5)) (or (equal? (substring string-juego (+ string-pos 18) (+ string-pos 19)) "0") (equal? (substring string-juego (+ string-pos 18) (+ string-pos 19)) "p") (equal? (substring string-juego (+ string-pos 18) (+ string-pos 19)) "t")  (equal? (substring string-juego (+ string-pos 18) (+ string-pos 19)) "c")  (equal? (substring string-juego (+ string-pos 18) (+ string-pos 19)) "a")  (equal? (substring string-juego (+ string-pos 18) (+ string-pos 19)) "q")))
                                                                                                   (string-copy! string-juego string-pos "00")
                                                                                                   (string-copy! string-juego (+ string-pos 18) "RN")
                                                                                                   (if (equal? (jaque 0 "RN") #t)
                                                                                                       (begin
                                                                                                         (string-copy! string-juego 0 string-juego-copy)
                                                                                                         (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                       ); fin begin true
                                                                                                   ; de lo contrario
                                                                                                         (begin
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                           #f
                                                                                                         ); fin begin false
                                                                                                   ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (>= (+ string-pos 14) 0) (<= (+ string-pos 14) 126) (= movimientos 6)) (or (equal? (substring string-juego (+ string-pos 14) (+ string-pos 15)) "0") (equal? (substring string-juego (+ string-pos 14) (+ string-pos 15)) "p") (equal? (substring string-juego (+ string-pos 14) (+ string-pos 15)) "t")  (equal? (substring string-juego (+ string-pos 14) (+ string-pos 15)) "c")  (equal? (substring string-juego (+ string-pos 14) (+ string-pos 15)) "a")  (equal? (substring string-juego (+ string-pos 14) (+ string-pos 15)) "q")))
                                                                                                   (string-copy! string-juego string-pos "00")
                                                                                                   (string-copy! string-juego (+ string-pos 14) "RN")
                                                                                                   (if (equal? (jaque 0 "RN") #t)
                                                                                                       (begin
                                                                                                         (string-copy! string-juego 0 string-juego-copy)
                                                                                                         (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                       ); fin begin true
                                                                                                   ; de lo contrario
                                                                                                         (begin
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                           #f
                                                                                                         ); fin begin false
                                                                                                   ); fin if
                                                                    ]; de lo contrario
                                                                    [(and (and (>= (+ string-pos 16) 0) (<= (+ string-pos 16) 126) (= movimientos 7)) (or (equal? (substring string-juego (+ string-pos 16) (+ string-pos 17)) "0") (equal? (substring string-juego (+ string-pos 16) (+ string-pos 17)) "p") (equal? (substring string-juego (+ string-pos 16) (+ string-pos 17)) "t")  (equal? (substring string-juego (+ string-pos 16) (+ string-pos 17)) "c")  (equal? (substring string-juego (+ string-pos 16) (+ string-pos 17)) "a")  (equal? (substring string-juego (+ string-pos 16) (+ string-pos 17)) "q")))
                                                                                                   (string-copy! string-juego string-pos "00")
                                                                                                   (string-copy! string-juego (+ string-pos 16) "RN")
                                                                                                   (if (equal? (jaque 0 "RN") #t)
                                                                                                       (begin
                                                                                                         (string-copy! string-juego 0 string-juego-copy)
                                                                                                         (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                       ); fin begin true
                                                                                                   ; de lo contrario
                                                                                                         (begin
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                           #f
                                                                                                         ); fin begin false
                                                                                                   ); fin if
                                                                    ]; de lo contrario
                                                                    ; no se puede hacer el movimiento
                                                                    [else (jaque-mate-negro string-pos (+ movimientos 1))]
                                                                  ); fin cond
                                                              ; de lo contrario
                                                                  #| el rey por si solo no puede salir de su jaque |#
                                                                  (jaque-mate-negro(+ string-pos 2) 0)
                                                              ); fin if
        ]; de lo contrario
        [(equal? (substring string-juego string-pos (+ string-pos 1)) "P") (if (<= movimientos 3)
                                                                  (cond
                                                                    #| paso doble del peon   |#
                                                                    [(and (and (>= string-pos 16) (<= string-pos 30) (= movimientos 0)) (equal? (substring string-juego (+ string-pos 32) (+ string-pos 33)) "0")) (string-copy! string-juego string-pos "00")
                                                                                                                                                                                                  (string-copy! string-juego (+ string-pos 32) "PN")
                                                                                                                                                                                                  (if (equal? (jaque 0 "RN") #t)
                                                                                                                                                                                                      (begin
                                                                                                                                                                                                        (string-copy! string-juego 0 string-juego-copy)
                                                                                                                                                                                                        (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                                                                                                                      ); fin begin true
                                                                                                                                                                                                  ; de lo contrario
                                                                                                                                                                                                      (begin
                                                                                                                                                                                                        (string-copy! string-juego 0 string-juego-copy)
                                                                                                                                                                                                        #f
                                                                                                                                                                                                      ); fin begin false
                                                                                                                                                                                                  ); fin if
                                                                    ]; de lo contrario
                                                                    #| solo un paso del peon |#
                                                                    [(and (and (>= (+ string-pos 16) 0) (<= (+ string-pos 16) 126) (= movimientos 1)) (equal? (substring string-juego (+ string-pos 16) (+ string-pos 17)) "0")) (string-copy! string-juego string-pos "00")
                                                                                                                                                                                                  (string-copy! string-juego (+ string-pos 16) "PN")
                                                                                                                                                                                                  (if (equal? (jaque 0 "RN") #t)
                                                                                                                                                                                                      (begin
                                                                                                                                                                                                        (string-copy! string-juego 0 string-juego-copy)
                                                                                                                                                                                                        (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                                                                                                                      ); fin begin true
                                                                                                                                                                                                  ; de lo contrario
                                                                                                                                                                                                      (begin
                                                                                                                                                                                                        (string-copy! string-juego 0 string-juego-copy)
                                                                                                                                                                                                        #f
                                                                                                                                                                                                      ); fin begin false
                                                                                                                                                                                                  ); fin if
                                                                    ]; de lo contrario
                                                                    #| peon comiendo a la izquierda |#
                                                                    [(and (and (equal? #f (equal? string-pos 30)) (equal? #f (equal? string-pos 46)) (equal? #f (equal? string-pos 62)) (equal? #f (equal? string-pos 78)) (equal? #f (equal? string-pos 94)) (equal? #f (equal? string-pos 110))) (and (>= (+ string-pos 14) 0) (<= (+ string-pos 14) 126) (= movimientos 2)) (equal? #f (equal? (substring string-juego (+ string-pos 14) (+ string-pos 15)) "0")) (equal? #f (equal? (substring string-juego (+ string-pos 15) (+ string-pos 16)) "N"))) (string-copy! string-juego string-pos "00")
                                                                                                                                                                                                              (string-copy! string-juego (+ string-pos 14) "PN")
                                                                                                                                                                                                              (if (equal? (jaque 0 "RN") #t)
                                                                                                                                                                                                                  (begin
                                                                                                                                                                                                                    (string-copy! string-juego 0 string-juego-copy)
                                                                                                                                                                                                                    (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                                                                                                                                  ); fin begin true
                                                                                                                                                                                                              ; de lo contrario
                                                                                                                                                                                                                  (begin
                                                                                                                                                                                                                    (string-copy! string-juego 0 string-juego-copy)
                                                                                                                                                                                                                     #f
                                                                                                                                                                                                                  ); fin begin false
                                                                                                                                                                                                              ); fin if
                                                                    ]; de lo contrario
                                                                    #| peon comiendo a la derecha   |#
                                                                    [(and (and (equal? #f (equal? string-pos 16)) (equal? #f (equal? string-pos 32)) (equal? #f (equal? string-pos 48)) (equal? #f (equal? string-pos 64)) (equal? #f (equal? string-pos 80)) (equal? #f (equal? string-pos 96))) (and (>= (+ string-pos 18) 0) (<= (+ string-pos 18) 126) (= movimientos 3)) (equal? #f (equal? (substring string-juego (+ string-pos 18) (+ string-pos 19)) "0")) (equal? #f (equal? (substring string-juego (+ string-pos 19) (+ string-pos 20)) "N"))) (string-copy! string-juego string-pos "00")
                                                                                                                                                                                                              (string-copy! string-juego (+ string-pos 18) "PN")
                                                                                                                                                                                                              (if (equal? (jaque 0 "RN") #t)
                                                                                                                                                                                                                  (begin
                                                                                                                                                                                                                    (string-copy! string-juego 0 string-juego-copy)
                                                                                                                                                                                                                    (jaque-mate-negro string-pos (+ movimientos 1))
                                                                                                                                                                                                                  ); fin begin true
                                                                                                                                                                                                              ; de lo contrario
                                                                                                                                                                                                                  (begin
                                                                                                                                                                                                                    (string-copy! string-juego 0 string-juego-copy)
                                                                                                                                                                                                                     #f
                                                                                                                                                                                                                  ); fin begin false
                                                                                                                                                                                                              ); fin if
                                                                    ]; de lo contrario
                                                                    ; no se puede hacer el movimiento.
                                                                    [else (jaque-mate-negro string-pos (+ movimientos 1))]
                                                                  ); fin cond
                                                              ; de lo contrario
                                                                  #| el peon no elimina el jaque o el posible mate |#
                                                                  (jaque-mate-negro (+ string-pos 2) 0)
                                                              ); fin if
        ]; de lo incrementa el contador o el string-pos
        [else (jaque-mate-negro (+ string-pos 2) 0)]
      ); fin cond
  ; de lo contrario
      (begin
        (string-copy! string-juego 0 string-juego-copy)
        #t
      ); fin begin false, existe jaque
  ); fin if, para saber si ya acabamos de revisar todas las fichas y todas sus posiciones
); fin definicion jaque mate negro

;___________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
#| Definición De La Función Que Va A Analizar Si Existe Jaque En Algun Rey |#

#| Identificadores Locales A La Función (Jaque):
   - string-pos-rey: almacena un numero que contendra la posicion en el string del rey que corresponde al turno negro o blanco.
   - ficha: contendra el string que identificara si se esta buscando jaque en el rey negro o blanco. |#
; Definción de la función jaque que buscara si algun rey esta en jaque.
(define (jaque string-pos-rey ficha)
  (if (>= 126 string-pos-rey)
      (if (equal? (substring string-juego string-pos-rey (+ string-pos-rey 2)) ficha)
          (if (equal? (substring string-juego string-pos-rey (+ string-pos-rey 2)) "rb")
              (cond #| condicional para saber si existe alguna ficha que ponga en peligro al rey blanco |#
                ; buscar jaque de algun caballo sobre el rey blanco
                [(and (and (>= (- string-pos-rey 34) 0) (<= (- string-pos-rey 34) 126)) (equal? (substring string-juego (- string-pos-rey 34) (- string-pos-rey 33)) "C") (and (> (quotient string-pos-rey 16) (quotient (- string-pos-rey 34) 16)) (> (remainder string-pos-rey 16) (remainder (- string-pos-rey 34) 16)))) #t]
                [(and (and (>= (- string-pos-rey 30) 0) (<= (- string-pos-rey 30) 126)) (equal? (substring string-juego (- string-pos-rey 30) (- string-pos-rey 29)) "C") (and (> (quotient string-pos-rey 16) (quotient (- string-pos-rey 30) 16)) (< (remainder string-pos-rey 16) (remainder (- string-pos-rey 30) 16)))) #t]
                [(and (and (>= (- string-pos-rey 20) 0) (<= (- string-pos-rey 20) 126)) (equal? (substring string-juego (- string-pos-rey 20) (- string-pos-rey 19)) "C") (and (> (quotient string-pos-rey 16) (quotient (- string-pos-rey 20) 16)) (> (remainder string-pos-rey 16) (remainder (- string-pos-rey 20) 16)))) #t]
                [(and (and (>= (- string-pos-rey 12) 0) (<= (- string-pos-rey 12) 126)) (equal? (substring string-juego (- string-pos-rey 12) (- string-pos-rey 11)) "C") (and (> (quotient string-pos-rey 16) (quotient (- string-pos-rey 12) 16)) (< (remainder string-pos-rey 16) (remainder (- string-pos-rey 12) 16)))) #t]
                [(and (and (>= (+ string-pos-rey 12) 0) (<= (+ string-pos-rey 12) 126)) (equal? (substring string-juego (+ string-pos-rey 12) (+ string-pos-rey 13)) "C") (and (< (quotient string-pos-rey 16) (quotient (+ string-pos-rey 12) 16)) (> (remainder string-pos-rey 16) (remainder (+ string-pos-rey 12) 16)))) #t]
                [(and (and (>= (+ string-pos-rey 20) 0) (<= (+ string-pos-rey 20) 126)) (equal? (substring string-juego (+ string-pos-rey 20) (+ string-pos-rey 21)) "C") (and (< (quotient string-pos-rey 16) (quotient (+ string-pos-rey 20) 16)) (< (remainder string-pos-rey 16) (remainder (+ string-pos-rey 20) 16)))) #t]
                [(and (and (>= (+ string-pos-rey 30) 0) (<= (+ string-pos-rey 30) 126)) (equal? (substring string-juego (+ string-pos-rey 30) (+ string-pos-rey 31)) "C") (and (< (quotient string-pos-rey 16) (quotient (+ string-pos-rey 30) 16)) (> (remainder string-pos-rey 16) (remainder (+ string-pos-rey 30) 16)))) #t]
                [(and (and (>= (+ string-pos-rey 34) 0) (<= (+ string-pos-rey 34) 126)) (equal? (substring string-juego (+ string-pos-rey 34) (+ string-pos-rey 35)) "C") (and (< (quotient string-pos-rey 16) (quotient (+ string-pos-rey 34) 16)) (< (remainder string-pos-rey 16) (remainder (+ string-pos-rey 34) 16)))) #t]
                ; buscar jaque por encima del rey blanco
                [(or (and (and (>= (- string-pos-rey 16 ) 0) (<= (- string-pos-rey 16 ) 126)) (or (equal? (substring string-juego (- string-pos-rey 16) (- string-pos-rey 15)) "Q") (equal? (substring string-juego (- string-pos-rey 16) (- string-pos-rey 15)) "T")))
                     (and (and (>= (- string-pos-rey 32 ) 0) (<= (- string-pos-rey 32 ) 126)) (equal? (substring string-juego (- string-pos-rey 16) (- string-pos-rey 14)) "00") (or (equal? (substring string-juego (- string-pos-rey 32) (- string-pos-rey 31)) "Q")(equal? (substring string-juego (- string-pos-rey 32) (- string-pos-rey 31)) "T")))
                     (and (and (>= (- string-pos-rey 48 ) 0) (<= (- string-pos-rey 48 ) 126)) (equal? (substring string-juego (- string-pos-rey 16) (- string-pos-rey 14)) "00") (equal? (substring string-juego (- string-pos-rey 32) (- string-pos-rey 30)) "00") (or (equal? (substring string-juego (- string-pos-rey 48) (- string-pos-rey 47)) "Q") (equal? (substring string-juego (- string-pos-rey 48) (- string-pos-rey 47)) "T")))
                     (and (and (>= (- string-pos-rey 64 ) 0) (<= (- string-pos-rey 64 ) 126)) (equal? (substring string-juego (- string-pos-rey 16) (- string-pos-rey 14)) "00") (equal? (substring string-juego (- string-pos-rey 32) (- string-pos-rey 30)) "00") (equal? (substring string-juego (- string-pos-rey 48) (- string-pos-rey 46)) "00") (or (equal? (substring string-juego (- string-pos-rey 64) (- string-pos-rey 63)) "Q")(equal? (substring string-juego (- string-pos-rey 64) (- string-pos-rey 63)) "T")))
                     (and (and (>= (- string-pos-rey 80 ) 0) (<= (- string-pos-rey 80 ) 126)) (equal? (substring string-juego (- string-pos-rey 16) (- string-pos-rey 14)) "00") (equal? (substring string-juego (- string-pos-rey 32) (- string-pos-rey 30)) "00") (equal? (substring string-juego (- string-pos-rey 48) (- string-pos-rey 46)) "00") (equal? (substring string-juego (- string-pos-rey 64) (- string-pos-rey 62)) "00") (or (equal? (substring string-juego (- string-pos-rey 80) (- string-pos-rey 79)) "Q") (equal? (substring string-juego (- string-pos-rey 80) (- string-pos-rey 79)) "T")))
                     (and (and (>= (- string-pos-rey 96 ) 0) (<= (- string-pos-rey 96 ) 126)) (equal? (substring string-juego (- string-pos-rey 16) (- string-pos-rey 14)) "00") (equal? (substring string-juego (- string-pos-rey 32) (- string-pos-rey 30)) "00") (equal? (substring string-juego (- string-pos-rey 48) (- string-pos-rey 46)) "00") (equal? (substring string-juego (- string-pos-rey 64) (- string-pos-rey 62)) "00") (equal? (substring string-juego (- string-pos-rey 80) (- string-pos-rey 78)) "00") (or (equal? (substring string-juego (- string-pos-rey 96) (- string-pos-rey 95)) "Q") (equal? (substring string-juego (- string-pos-rey 96) (- string-pos-rey 95)) "T")))
                     (and (and (>= (- string-pos-rey 112) 0) (<= (- string-pos-rey 112) 126)) (equal? (substring string-juego (- string-pos-rey 16) (- string-pos-rey 14)) "00") (equal? (substring string-juego (- string-pos-rey 32) (- string-pos-rey 30)) "00") (equal? (substring string-juego (- string-pos-rey 48) (- string-pos-rey 46)) "00") (equal? (substring string-juego (- string-pos-rey 64) (- string-pos-rey 62)) "00") (equal? (substring string-juego (- string-pos-rey 80) (- string-pos-rey 78)) "00") (equal? (substring string-juego (- string-pos-rey 96) (- string-pos-rey 94)) "00") (or (equal? (substring string-juego (- string-pos-rey 112) (- string-pos-rey 111)) "Q") (equal? (substring string-juego (- string-pos-rey 112) (- string-pos-rey 111)) "T")))
                 ); fin condicion
                  #t
                ]; de lo contrario
                ; buscar jaque por debajo del rey blanco
                [(or (and (and (>= (+ string-pos-rey 16 ) 0) (<= (+ string-pos-rey 16 ) 126)) (or (equal? (substring string-juego (+ string-pos-rey 16) (+ string-pos-rey 17)) "Q") (equal? (substring string-juego (+ string-pos-rey 16) (+ string-pos-rey 17)) "T")))
                     (and (and (>= (+ string-pos-rey 32 ) 0) (<= (+ string-pos-rey 32 ) 126)) (equal? (substring string-juego (+ string-pos-rey 16) (+ string-pos-rey 18)) "00") (or (equal? (substring string-juego (+ string-pos-rey 32) (+ string-pos-rey 33)) "Q")(equal? (substring string-juego (+ string-pos-rey 32) (+ string-pos-rey 33)) "T")))
                     (and (and (>= (+ string-pos-rey 48 ) 0) (<= (+ string-pos-rey 48 ) 126)) (equal? (substring string-juego (+ string-pos-rey 16) (+ string-pos-rey 18)) "00") (equal? (substring string-juego (+ string-pos-rey 32) (+ string-pos-rey 34)) "00") (or (equal? (substring string-juego (+ string-pos-rey 48) (+ string-pos-rey 49)) "Q") (equal? (substring string-juego (+ string-pos-rey 48) (+ string-pos-rey 49)) "T")))
                     (and (and (>= (+ string-pos-rey 64 ) 0) (<= (+ string-pos-rey 64 ) 126)) (equal? (substring string-juego (+ string-pos-rey 16) (+ string-pos-rey 18)) "00") (equal? (substring string-juego (+ string-pos-rey 32) (+ string-pos-rey 34)) "00") (equal? (substring string-juego (+ string-pos-rey 48) (+ string-pos-rey 50)) "00") (or (equal? (substring string-juego (+ string-pos-rey 64) (+ string-pos-rey 65)) "Q")(equal? (substring string-juego (+ string-pos-rey 64) (+ string-pos-rey 65)) "T")))
                     (and (and (>= (+ string-pos-rey 80 ) 0) (<= (+ string-pos-rey 80 ) 126)) (equal? (substring string-juego (+ string-pos-rey 16) (+ string-pos-rey 18)) "00") (equal? (substring string-juego (+ string-pos-rey 32) (+ string-pos-rey 34)) "00") (equal? (substring string-juego (+ string-pos-rey 48) (+ string-pos-rey 50)) "00") (equal? (substring string-juego (+ string-pos-rey 64) (+ string-pos-rey 66)) "00") (or (equal? (substring string-juego (+ string-pos-rey 80) (+ string-pos-rey 81)) "Q") (equal? (substring string-juego (+ string-pos-rey 80) (+ string-pos-rey 81)) "T")))
                     (and (and (>= (+ string-pos-rey 96 ) 0) (<= (+ string-pos-rey 96 ) 126)) (equal? (substring string-juego (+ string-pos-rey 16) (+ string-pos-rey 18)) "00") (equal? (substring string-juego (+ string-pos-rey 32) (+ string-pos-rey 34)) "00") (equal? (substring string-juego (+ string-pos-rey 48) (+ string-pos-rey 50)) "00") (equal? (substring string-juego (+ string-pos-rey 64) (+ string-pos-rey 66)) "00") (equal? (substring string-juego (+ string-pos-rey 80) (+ string-pos-rey 82)) "00") (or (equal? (substring string-juego (+ string-pos-rey 96) (+ string-pos-rey 97)) "Q") (equal? (substring string-juego (+ string-pos-rey 96) (+ string-pos-rey 97)) "T")))
                     (and (and (>= (+ string-pos-rey 112) 0) (<= (+ string-pos-rey 112) 126)) (equal? (substring string-juego (+ string-pos-rey 16) (+ string-pos-rey 18)) "00") (equal? (substring string-juego (+ string-pos-rey 32) (+ string-pos-rey 34)) "00") (equal? (substring string-juego (+ string-pos-rey 48) (+ string-pos-rey 50)) "00") (equal? (substring string-juego (+ string-pos-rey 64) (+ string-pos-rey 66)) "00") (equal? (substring string-juego (+ string-pos-rey 80) (+ string-pos-rey 82)) "00") (equal? (substring string-juego (+ string-pos-rey 96) (+ string-pos-rey 98)) "00") (or (equal? (substring string-juego (+ string-pos-rey 112) (+ string-pos-rey 113)) "Q") (equal? (substring string-juego (+ string-pos-rey 112) (+ string-pos-rey 113)) "T")))
                 ); fin condicion
                  #t
                ]; de lo contrario
                ; buscar jaque por la izquierda del rey blanco
                [(or (and (and (>= (- string-pos-rey  2 ) 0) (<= (- string-pos-rey  2 ) 126)) (= (quotient string-pos-rey 16) (quotient (- string-pos-rey 2) 16)) (or (equal? (substring string-juego (- string-pos-rey 2) (- string-pos-rey 1)) "Q") (equal? (substring string-juego (- string-pos-rey 2) (- string-pos-rey 1)) "T")))
                     (and (and (>= (- string-pos-rey  4 ) 0) (<= (- string-pos-rey  4 ) 126)) (= (quotient string-pos-rey 16) (quotient (- string-pos-rey 4) 16)) (equal? (substring string-juego (- string-pos-rey 2) (- string-pos-rey 0)) "00") (or (equal? (substring string-juego (- string-pos-rey 4) (- string-pos-rey 3)) "Q")(equal? (substring string-juego (- string-pos-rey 4) (- string-pos-rey 3)) "T")))
                     (and (and (>= (- string-pos-rey  6 ) 0) (<= (- string-pos-rey  6 ) 126)) (= (quotient string-pos-rey 16) (quotient (- string-pos-rey 6) 16)) (equal? (substring string-juego (- string-pos-rey 2) (- string-pos-rey 0)) "00") (equal? (substring string-juego (- string-pos-rey 4) (- string-pos-rey 2)) "00") (or (equal? (substring string-juego (- string-pos-rey 6) (- string-pos-rey 5)) "Q") (equal? (substring string-juego (- string-pos-rey 6) (- string-pos-rey 5)) "T")))
                     (and (and (>= (- string-pos-rey  8 ) 0) (<= (- string-pos-rey  8 ) 126)) (= (quotient string-pos-rey 16) (quotient (- string-pos-rey 8) 16)) (equal? (substring string-juego (- string-pos-rey 2) (- string-pos-rey 0)) "00") (equal? (substring string-juego (- string-pos-rey 4) (- string-pos-rey 2)) "00") (equal? (substring string-juego (- string-pos-rey 6) (- string-pos-rey 4)) "00") (or (equal? (substring string-juego (- string-pos-rey 8) (- string-pos-rey 7)) "Q")(equal? (substring string-juego (- string-pos-rey 8) (- string-pos-rey 7)) "T")))
                     (and (and (>= (- string-pos-rey 10 ) 0) (<= (- string-pos-rey 10 ) 126)) (= (quotient string-pos-rey 16) (quotient (- string-pos-rey 10) 16)) (equal? (substring string-juego (- string-pos-rey 2) (- string-pos-rey 0)) "00") (equal? (substring string-juego (- string-pos-rey 4) (- string-pos-rey 2)) "00") (equal? (substring string-juego (- string-pos-rey 6) (- string-pos-rey 4)) "00") (equal? (substring string-juego (- string-pos-rey 8) (- string-pos-rey 6)) "00") (or (equal? (substring string-juego (- string-pos-rey 10) (- string-pos-rey 9)) "Q") (equal? (substring string-juego (- string-pos-rey 10) (- string-pos-rey 9)) "T")))
                     (and (and (>= (- string-pos-rey 12 ) 0) (<= (- string-pos-rey 12 ) 126)) (= (quotient string-pos-rey 16) (quotient (- string-pos-rey 12) 16)) (equal? (substring string-juego (- string-pos-rey 2) (- string-pos-rey 0)) "00") (equal? (substring string-juego (- string-pos-rey 4) (- string-pos-rey 2)) "00") (equal? (substring string-juego (- string-pos-rey 6) (- string-pos-rey 4)) "00") (equal? (substring string-juego (- string-pos-rey 8) (- string-pos-rey 6)) "00") (equal? (substring string-juego (- string-pos-rey 10) (- string-pos-rey 8)) "00") (or (equal? (substring string-juego (- string-pos-rey 12) (- string-pos-rey 11)) "Q") (equal? (substring string-juego (- string-pos-rey 12) (- string-pos-rey 11)) "T")))
                     (and (and (>= (- string-pos-rey 14 ) 0) (<= (- string-pos-rey 14 ) 126)) (= (quotient string-pos-rey 16) (quotient (- string-pos-rey 14) 16)) (equal? (substring string-juego (- string-pos-rey 2) (- string-pos-rey 0)) "00") (equal? (substring string-juego (- string-pos-rey 4) (- string-pos-rey 2)) "00") (equal? (substring string-juego (- string-pos-rey 6) (- string-pos-rey 4)) "00") (equal? (substring string-juego (- string-pos-rey 8) (- string-pos-rey 6)) "00") (equal? (substring string-juego (- string-pos-rey 10) (- string-pos-rey 8)) "00") (equal? (substring string-juego (- string-pos-rey 12) (- string-pos-rey 10)) "00") (or (equal? (substring string-juego (- string-pos-rey 14) (- string-pos-rey 13)) "Q") (equal? (substring string-juego (- string-pos-rey 14) (- string-pos-rey 13)) "T")))
                 ); fin condicion
                  #t
                ]; de lo contrario
                ; buscar jaque por la derecha del rey blanco
                [(or (and (and (>= (+ string-pos-rey  2 ) 0) (<= (+ string-pos-rey  2 ) 126)) (= (quotient string-pos-rey 16) (quotient (+ string-pos-rey 2) 16)) (or (equal? (substring string-juego (+ string-pos-rey 2) (+ string-pos-rey 3)) "Q") (equal? (substring string-juego (+ string-pos-rey 2) (+ string-pos-rey 3)) "T")))
                     (and (and (>= (+ string-pos-rey  4 ) 0) (<= (+ string-pos-rey  4 ) 126)) (= (quotient string-pos-rey 16) (quotient (+ string-pos-rey 4) 16)) (equal? (substring string-juego (+ string-pos-rey 2) (+ string-pos-rey 4)) "00") (or (equal? (substring string-juego (+ string-pos-rey 4) (+ string-pos-rey 5)) "Q")(equal? (substring string-juego (+ string-pos-rey 4) (+ string-pos-rey 5)) "T")))
                     (and (and (>= (+ string-pos-rey  6 ) 0) (<= (+ string-pos-rey  6 ) 126)) (= (quotient string-pos-rey 16) (quotient (+ string-pos-rey 6) 16)) (equal? (substring string-juego (+ string-pos-rey 2) (+ string-pos-rey 4)) "00") (equal? (substring string-juego (+ string-pos-rey 4) (+ string-pos-rey 6)) "00") (or (equal? (substring string-juego (+ string-pos-rey 6) (+ string-pos-rey 7)) "Q") (equal? (substring string-juego (+ string-pos-rey 6) (+ string-pos-rey 7)) "T")))
                     (and (and (>= (+ string-pos-rey  8 ) 0) (<= (+ string-pos-rey  8 ) 126)) (= (quotient string-pos-rey 16) (quotient (+ string-pos-rey 8) 16)) (equal? (substring string-juego (+ string-pos-rey 2) (+ string-pos-rey 4)) "00") (equal? (substring string-juego (+ string-pos-rey 4) (+ string-pos-rey 6)) "00") (equal? (substring string-juego (+ string-pos-rey 6) (+ string-pos-rey 8)) "00") (or (equal? (substring string-juego (+ string-pos-rey 8) (+ string-pos-rey 9)) "Q")(equal? (substring string-juego (+ string-pos-rey 8) (+ string-pos-rey 9)) "T")))
                     (and (and (>= (+ string-pos-rey 10 ) 0) (<= (+ string-pos-rey 10 ) 126)) (= (quotient string-pos-rey 16) (quotient (+ string-pos-rey 10) 16)) (equal? (substring string-juego (+ string-pos-rey 2) (+ string-pos-rey 4)) "00") (equal? (substring string-juego (+ string-pos-rey 4) (+ string-pos-rey 6)) "00") (equal? (substring string-juego (+ string-pos-rey 6) (+ string-pos-rey 8)) "00") (equal? (substring string-juego (+ string-pos-rey 8) (+ string-pos-rey 10)) "00") (or (equal? (substring string-juego (+ string-pos-rey 10) (+ string-pos-rey 11)) "Q") (equal? (substring string-juego (+ string-pos-rey 10) (+ string-pos-rey 11)) "T")))
                     (and (and (>= (+ string-pos-rey 12 ) 0) (<= (+ string-pos-rey 12 ) 126)) (= (quotient string-pos-rey 16) (quotient (+ string-pos-rey 12) 16)) (equal? (substring string-juego (+ string-pos-rey 2) (+ string-pos-rey 4)) "00") (equal? (substring string-juego (+ string-pos-rey 4) (+ string-pos-rey 6)) "00") (equal? (substring string-juego (+ string-pos-rey 6) (+ string-pos-rey 8)) "00") (equal? (substring string-juego (+ string-pos-rey 8) (+ string-pos-rey 10)) "00") (equal? (substring string-juego (+ string-pos-rey 10) (+ string-pos-rey 12)) "00") (or (equal? (substring string-juego (+ string-pos-rey 12) (+ string-pos-rey 13)) "Q") (equal? (substring string-juego (+ string-pos-rey 12) (+ string-pos-rey 13)) "T")))
                     (and (and (>= (+ string-pos-rey 14 ) 0) (<= (+ string-pos-rey 14 ) 126)) (= (quotient string-pos-rey 16) (quotient (+ string-pos-rey 14) 16)) (equal? (substring string-juego (+ string-pos-rey 2) (+ string-pos-rey 4)) "00") (equal? (substring string-juego (+ string-pos-rey 4) (+ string-pos-rey 6)) "00") (equal? (substring string-juego (+ string-pos-rey 6) (+ string-pos-rey 8)) "00") (equal? (substring string-juego (+ string-pos-rey 8) (+ string-pos-rey 10)) "00") (equal? (substring string-juego (+ string-pos-rey 10) (+ string-pos-rey 12)) "00") (equal? (substring string-juego (+ string-pos-rey 12) (+ string-pos-rey 14)) "00") (or (equal? (substring string-juego (+ string-pos-rey 14) (+ string-pos-rey 15)) "Q") (equal? (substring string-juego (+ string-pos-rey 14) (+ string-pos-rey 15)) "T")))
                 ); fin condicion
                  #t
                ]; de lo contrario
                ; buscar jaque por encima a la izquierda del rey blanco
                [(or (and (and (>= (- string-pos-rey 18 ) 0) (<= (- string-pos-rey 18 ) 126)) (and (> (quotient string-pos-rey 16) (quotient (- string-pos-rey 18) 16)) (> (remainder string-pos-rey 16) (remainder (- string-pos-rey 18) 16))) (or (equal? (substring string-juego (- string-pos-rey 18) (- string-pos-rey 17)) "Q") (equal? (substring string-juego (- string-pos-rey 18) (- string-pos-rey 17)) "A") (equal? (substring string-juego (- string-pos-rey 18) (- string-pos-rey 17)) "P")))
                     (and (and (>= (- string-pos-rey 36 ) 0) (<= (- string-pos-rey 36 ) 126)) (and (> (quotient string-pos-rey 16) (quotient (- string-pos-rey 36) 16)) (> (remainder string-pos-rey 16) (remainder (- string-pos-rey 36) 16))) (equal? (substring string-juego (- string-pos-rey 18) (- string-pos-rey 16)) "00") (or (equal? (substring string-juego (- string-pos-rey 36) (- string-pos-rey 35)) "Q") (equal? (substring string-juego (- string-pos-rey 36) (- string-pos-rey 35)) "A")))
                     (and (and (>= (- string-pos-rey 54 ) 0) (<= (- string-pos-rey 54 ) 126)) (and (> (quotient string-pos-rey 16) (quotient (- string-pos-rey 54) 16)) (> (remainder string-pos-rey 16) (remainder (- string-pos-rey 54) 16))) (equal? (substring string-juego (- string-pos-rey 18) (- string-pos-rey 16)) "00") (equal? (substring string-juego (- string-pos-rey 36) (- string-pos-rey 34)) "00") (or (equal? (substring string-juego (- string-pos-rey 54) (- string-pos-rey 53)) "Q") (equal? (substring string-juego (- string-pos-rey 54) (- string-pos-rey 53)) "A")))
                     (and (and (>= (- string-pos-rey 72 ) 0) (<= (- string-pos-rey 72 ) 126)) (and (> (quotient string-pos-rey 16) (quotient (- string-pos-rey 72) 16)) (> (remainder string-pos-rey 16) (remainder (- string-pos-rey 72) 16))) (equal? (substring string-juego (- string-pos-rey 18) (- string-pos-rey 16)) "00") (equal? (substring string-juego (- string-pos-rey 36) (- string-pos-rey 34)) "00") (equal? (substring string-juego (- string-pos-rey 54) (- string-pos-rey 52)) "00") (or (equal? (substring string-juego (- string-pos-rey 72) (- string-pos-rey 71)) "Q") (equal? (substring string-juego (- string-pos-rey 72) (- string-pos-rey 71)) "A")))
                     (and (and (>= (- string-pos-rey 90 ) 0) (<= (- string-pos-rey 90 ) 126)) (and (> (quotient string-pos-rey 16) (quotient (- string-pos-rey 90) 16)) (> (remainder string-pos-rey 16) (remainder (- string-pos-rey 90) 16))) (equal? (substring string-juego (- string-pos-rey 18) (- string-pos-rey 16)) "00") (equal? (substring string-juego (- string-pos-rey 36) (- string-pos-rey 34)) "00") (equal? (substring string-juego (- string-pos-rey 54) (- string-pos-rey 52)) "00") (equal? (substring string-juego (- string-pos-rey 72) (- string-pos-rey 70)) "00") (or (equal? (substring string-juego (- string-pos-rey 90) (- string-pos-rey 89)) "Q") (equal? (substring string-juego (- string-pos-rey 90) (- string-pos-rey 89)) "A")))
                     (and (and (>= (- string-pos-rey 108) 0) (<= (- string-pos-rey 108) 126)) (and (> (quotient string-pos-rey 16) (quotient (- string-pos-rey 108) 16)) (> (remainder string-pos-rey 16) (remainder (- string-pos-rey 108) 16))) (equal? (substring string-juego (- string-pos-rey 18) (- string-pos-rey 16)) "00") (equal? (substring string-juego (- string-pos-rey 36) (- string-pos-rey 34)) "00") (equal? (substring string-juego (- string-pos-rey 54) (- string-pos-rey 52)) "00") (equal? (substring string-juego (- string-pos-rey 72) (- string-pos-rey 70)) "00") (equal? (substring string-juego (- string-pos-rey 90) (- string-pos-rey 88)) "00") (or (equal? (substring string-juego (- string-pos-rey 108) (- string-pos-rey 107)) "Q") (equal? (substring string-juego (- string-pos-rey 108) (- string-pos-rey 107)) "A")))
                     (and (and (>= (- string-pos-rey 126) 0) (<= (- string-pos-rey 126) 126)) (and (> (quotient string-pos-rey 16) (quotient (- string-pos-rey 126) 16)) (> (remainder string-pos-rey 16) (remainder (- string-pos-rey 126) 16))) (equal? (substring string-juego (- string-pos-rey 18) (- string-pos-rey 16)) "00") (equal? (substring string-juego (- string-pos-rey 36) (- string-pos-rey 34)) "00") (equal? (substring string-juego (- string-pos-rey 54) (- string-pos-rey 52)) "00") (equal? (substring string-juego (- string-pos-rey 72) (- string-pos-rey 70)) "00") (equal? (substring string-juego (- string-pos-rey 90) (- string-pos-rey 88)) "00") (equal? (substring string-juego (- string-pos-rey 108) (- string-pos-rey 106)) "00") (or (equal? (substring string-juego (- string-pos-rey 126) (- string-pos-rey 125)) "Q") (equal? (substring string-juego (- string-pos-rey 126) (- string-pos-rey 125)) "A")))
                 ); fin condicion
                  #t
                ]; de lo contrario
                ; buscar jaque por encima a la derecha del rey blanco
                [(or (and (and (>= (- string-pos-rey 14 ) 0) (<= (- string-pos-rey 14 ) 126)) (and (> (quotient string-pos-rey 16) (quotient (- string-pos-rey 14) 16)) (< (remainder string-pos-rey 16) (remainder (- string-pos-rey 14) 16))) (or (equal? (substring string-juego (- string-pos-rey 14) (- string-pos-rey 13)) "Q") (equal? (substring string-juego (- string-pos-rey 14) (- string-pos-rey 13)) "A") (equal? (substring string-juego (- string-pos-rey 14) (- string-pos-rey 13)) "P")))
                     (and (and (>= (- string-pos-rey 28 ) 0) (<= (- string-pos-rey 28 ) 126)) (and (> (quotient string-pos-rey 16) (quotient (- string-pos-rey 28) 16)) (< (remainder string-pos-rey 16) (remainder (- string-pos-rey 28) 16))) (equal? (substring string-juego (- string-pos-rey 14) (- string-pos-rey 12)) "00") (or (equal? (substring string-juego (- string-pos-rey 28) (- string-pos-rey 27)) "Q") (equal? (substring string-juego (- string-pos-rey 28) (- string-pos-rey 27)) "A")))
                     (and (and (>= (- string-pos-rey 42 ) 0) (<= (- string-pos-rey 42 ) 126)) (and (> (quotient string-pos-rey 16) (quotient (- string-pos-rey 42) 16)) (< (remainder string-pos-rey 16) (remainder (- string-pos-rey 42) 16))) (equal? (substring string-juego (- string-pos-rey 14) (- string-pos-rey 12)) "00") (equal? (substring string-juego (- string-pos-rey 28) (- string-pos-rey 26)) "00") (or (equal? (substring string-juego (- string-pos-rey 42) (- string-pos-rey 41)) "Q") (equal? (substring string-juego (- string-pos-rey 42) (- string-pos-rey 41)) "A")))
                     (and (and (>= (- string-pos-rey 56 ) 0) (<= (- string-pos-rey 56 ) 126)) (and (> (quotient string-pos-rey 16) (quotient (- string-pos-rey 56) 16)) (< (remainder string-pos-rey 16) (remainder (- string-pos-rey 56) 16))) (equal? (substring string-juego (- string-pos-rey 14) (- string-pos-rey 12)) "00") (equal? (substring string-juego (- string-pos-rey 28) (- string-pos-rey 26)) "00") (equal? (substring string-juego (- string-pos-rey 42) (- string-pos-rey 40)) "00") (or (equal? (substring string-juego (- string-pos-rey 56) (- string-pos-rey 55)) "Q") (equal? (substring string-juego (- string-pos-rey 56) (- string-pos-rey 55)) "A")))
                     (and (and (>= (- string-pos-rey 70 ) 0) (<= (- string-pos-rey 70 ) 126)) (and (> (quotient string-pos-rey 16) (quotient (- string-pos-rey 70) 16)) (< (remainder string-pos-rey 16) (remainder (- string-pos-rey 70) 16))) (equal? (substring string-juego (- string-pos-rey 14) (- string-pos-rey 12)) "00") (equal? (substring string-juego (- string-pos-rey 28) (- string-pos-rey 26)) "00") (equal? (substring string-juego (- string-pos-rey 42) (- string-pos-rey 40)) "00") (equal? (substring string-juego (- string-pos-rey 56) (- string-pos-rey 54)) "00") (or (equal? (substring string-juego (- string-pos-rey 70) (- string-pos-rey 69)) "Q") (equal? (substring string-juego (- string-pos-rey 70) (- string-pos-rey 69)) "A")))
                     (and (and (>= (- string-pos-rey 84 ) 0) (<= (- string-pos-rey 84 ) 126)) (and (> (quotient string-pos-rey 16) (quotient (- string-pos-rey 84) 16)) (< (remainder string-pos-rey 16) (remainder (- string-pos-rey 84) 16))) (equal? (substring string-juego (- string-pos-rey 14) (- string-pos-rey 12)) "00") (equal? (substring string-juego (- string-pos-rey 28) (- string-pos-rey 26)) "00") (equal? (substring string-juego (- string-pos-rey 42) (- string-pos-rey 40)) "00") (equal? (substring string-juego (- string-pos-rey 56) (- string-pos-rey 54)) "00") (equal? (substring string-juego (- string-pos-rey 70) (- string-pos-rey 68)) "00") (or (equal? (substring string-juego (- string-pos-rey 84) (- string-pos-rey 83)) "Q") (equal? (substring string-juego (- string-pos-rey 84) (- string-pos-rey 83)) "A")))
                     (and (and (>= (- string-pos-rey 98 ) 0) (<= (- string-pos-rey 98 ) 126)) (and (> (quotient string-pos-rey 16) (quotient (- string-pos-rey 98) 16)) (< (remainder string-pos-rey 16) (remainder (- string-pos-rey 98) 16))) (equal? (substring string-juego (- string-pos-rey 14) (- string-pos-rey 12)) "00") (equal? (substring string-juego (- string-pos-rey 28) (- string-pos-rey 26)) "00") (equal? (substring string-juego (- string-pos-rey 42) (- string-pos-rey 40)) "00") (equal? (substring string-juego (- string-pos-rey 56) (- string-pos-rey 54)) "00") (equal? (substring string-juego (- string-pos-rey 70) (- string-pos-rey 68)) "00") (equal? (substring string-juego (- string-pos-rey 84) (- string-pos-rey 82)) "00") (or (equal? (substring string-juego (- string-pos-rey 94) (- string-pos-rey 93)) "Q") (equal? (substring string-juego (- string-pos-rey 94) (- string-pos-rey 93)) "A")))
                 ); fin condicion
                  #t
                ]; de lo contrario
                ; buscar jaque por debajo a al derecha del rey blanco
                [(or (and (and (>= (+ string-pos-rey 18 ) 0) (<= (+ string-pos-rey 18 ) 126)) (and (< (quotient string-pos-rey 16) (quotient (+ string-pos-rey 18) 16)) (< (remainder string-pos-rey 16) (remainder (+ string-pos-rey 18) 16))) (or (equal? (substring string-juego (+ string-pos-rey 18) (+ string-pos-rey 19)) "Q") (equal? (substring string-juego (+ string-pos-rey 18) (+ string-pos-rey 19)) "A")))
                     (and (and (>= (+ string-pos-rey 36 ) 0) (<= (+ string-pos-rey 36 ) 126)) (and (< (quotient string-pos-rey 16) (quotient (+ string-pos-rey 36) 16)) (< (remainder string-pos-rey 16) (remainder (+ string-pos-rey 36) 16))) (equal? (substring string-juego (+ string-pos-rey 18) (+ string-pos-rey 20)) "00") (or (equal? (substring string-juego (+ string-pos-rey 36) (+ string-pos-rey 37)) "Q") (equal? (substring string-juego (+ string-pos-rey 36) (+ string-pos-rey 37)) "A")))
                     (and (and (>= (+ string-pos-rey 54 ) 0) (<= (+ string-pos-rey 54 ) 126)) (and (< (quotient string-pos-rey 16) (quotient (+ string-pos-rey 54) 16)) (< (remainder string-pos-rey 16) (remainder (+ string-pos-rey 54) 16))) (equal? (substring string-juego (+ string-pos-rey 18) (+ string-pos-rey 20)) "00") (equal? (substring string-juego (+ string-pos-rey 36) (+ string-pos-rey 38)) "00") (or (equal? (substring string-juego (+ string-pos-rey 54) (+ string-pos-rey 55)) "Q") (equal? (substring string-juego (+ string-pos-rey 54) (+ string-pos-rey 55)) "A")))
                     (and (and (>= (+ string-pos-rey 72 ) 0) (<= (+ string-pos-rey 72 ) 126)) (and (< (quotient string-pos-rey 16) (quotient (+ string-pos-rey 72) 16)) (< (remainder string-pos-rey 16) (remainder (+ string-pos-rey 72) 16))) (equal? (substring string-juego (+ string-pos-rey 18) (+ string-pos-rey 20)) "00") (equal? (substring string-juego (+ string-pos-rey 36) (+ string-pos-rey 38)) "00") (equal? (substring string-juego (+ string-pos-rey 54) (+ string-pos-rey 56)) "00") (or (equal? (substring string-juego (+ string-pos-rey 72) (+ string-pos-rey 73)) "Q") (equal? (substring string-juego (+ string-pos-rey 72) (+ string-pos-rey 73)) "A")))
                     (and (and (>= (+ string-pos-rey 90 ) 0) (<= (+ string-pos-rey 90 ) 126)) (and (< (quotient string-pos-rey 16) (quotient (+ string-pos-rey 90) 16)) (< (remainder string-pos-rey 16) (remainder (+ string-pos-rey 90) 16))) (equal? (substring string-juego (+ string-pos-rey 18) (+ string-pos-rey 20)) "00") (equal? (substring string-juego (+ string-pos-rey 36) (+ string-pos-rey 38)) "00") (equal? (substring string-juego (+ string-pos-rey 54) (+ string-pos-rey 56)) "00") (equal? (substring string-juego (+ string-pos-rey 72) (+ string-pos-rey 74)) "00") (or (equal? (substring string-juego (+ string-pos-rey 90) (+ string-pos-rey 91)) "Q") (equal? (substring string-juego (+ string-pos-rey 90) (+ string-pos-rey 91)) "A")))
                     (and (and (>= (+ string-pos-rey 108) 0) (<= (+ string-pos-rey 108) 126)) (and (< (quotient string-pos-rey 16) (quotient (+ string-pos-rey 108) 16)) (< (remainder string-pos-rey 16) (remainder (+ string-pos-rey 108) 16))) (equal? (substring string-juego (+ string-pos-rey 18) (+ string-pos-rey 20)) "00") (equal? (substring string-juego (+ string-pos-rey 36) (+ string-pos-rey 38)) "00") (equal? (substring string-juego (+ string-pos-rey 54) (+ string-pos-rey 56)) "00") (equal? (substring string-juego (+ string-pos-rey 72) (+ string-pos-rey 74)) "00") (equal? (substring string-juego (+ string-pos-rey 90) (+ string-pos-rey 92)) "00") (or (equal? (substring string-juego (+ string-pos-rey 108) (+ string-pos-rey 109)) "Q") (equal? (substring string-juego (+ string-pos-rey 108) (+ string-pos-rey 109)) "A")))
                     (and (and (>= (+ string-pos-rey 126) 0) (<= (+ string-pos-rey 126) 126)) (and (< (quotient string-pos-rey 16) (quotient (+ string-pos-rey 126) 16)) (< (remainder string-pos-rey 16) (remainder (+ string-pos-rey 126) 16))) (equal? (substring string-juego (+ string-pos-rey 18) (+ string-pos-rey 20)) "00") (equal? (substring string-juego (+ string-pos-rey 36) (+ string-pos-rey 38)) "00") (equal? (substring string-juego (+ string-pos-rey 54) (+ string-pos-rey 56)) "00") (equal? (substring string-juego (+ string-pos-rey 72) (+ string-pos-rey 74)) "00") (equal? (substring string-juego (+ string-pos-rey 90) (+ string-pos-rey 92)) "00") (equal? (substring string-juego (+ string-pos-rey 108) (+ string-pos-rey 110)) "00") (or (equal? (substring string-juego (+ string-pos-rey 126) (+ string-pos-rey 127)) "Q") (equal? (substring string-juego (+ string-pos-rey 126) (+ string-pos-rey 127)) "A")))
                 )
                  #t
                ]; de lo contrario
                ; buscar jaque por debajo a la izquierda del rey blanco
                [(or (and (and (>= (+ string-pos-rey 14 ) 0) (<= (+ string-pos-rey 14 ) 126)) (and (< (quotient string-pos-rey 16) (quotient (+ string-pos-rey 14) 16)) (> (remainder string-pos-rey 16) (remainder (+ string-pos-rey 14) 16))) (or (equal? (substring string-juego (+ string-pos-rey 14) (+ string-pos-rey 15)) "Q") (equal? (substring string-juego (+ string-pos-rey 14) (+ string-pos-rey 15)) "A")))
                     (and (and (>= (+ string-pos-rey 28 ) 0) (<= (+ string-pos-rey 28 ) 126)) (and (< (quotient string-pos-rey 16) (quotient (+ string-pos-rey 28) 16)) (> (remainder string-pos-rey 16) (remainder (+ string-pos-rey 28) 16))) (equal? (substring string-juego (+ string-pos-rey 14) (+ string-pos-rey 16)) "00") (or (equal? (substring string-juego (+ string-pos-rey 28) (+ string-pos-rey 29)) "Q") (equal? (substring string-juego (+ string-pos-rey 28) (+ string-pos-rey 29)) "A")))
                     (and (and (>= (+ string-pos-rey 42 ) 0) (<= (+ string-pos-rey 42 ) 126)) (and (< (quotient string-pos-rey 16) (quotient (+ string-pos-rey 42) 16)) (> (remainder string-pos-rey 16) (remainder (+ string-pos-rey 42) 16))) (equal? (substring string-juego (+ string-pos-rey 14) (+ string-pos-rey 16)) "00") (equal? (substring string-juego (+ string-pos-rey 28) (+ string-pos-rey 30)) "00") (or (equal? (substring string-juego (+ string-pos-rey 42) (+ string-pos-rey 43)) "Q") (equal? (substring string-juego (+ string-pos-rey 42) (+ string-pos-rey 43)) "A")))
                     (and (and (>= (+ string-pos-rey 56 ) 0) (<= (+ string-pos-rey 56 ) 126)) (and (< (quotient string-pos-rey 16) (quotient (+ string-pos-rey 56) 16)) (> (remainder string-pos-rey 16) (remainder (+ string-pos-rey 56) 16))) (equal? (substring string-juego (+ string-pos-rey 14) (+ string-pos-rey 16)) "00") (equal? (substring string-juego (+ string-pos-rey 28) (+ string-pos-rey 30)) "00") (equal? (substring string-juego (+ string-pos-rey 42) (+ string-pos-rey 44)) "00") (or (equal? (substring string-juego (+ string-pos-rey 56) (+ string-pos-rey 57)) "Q") (equal? (substring string-juego (+ string-pos-rey 56) (+ string-pos-rey 57)) "A")))
                     (and (and (>= (+ string-pos-rey 70 ) 0) (<= (+ string-pos-rey 70 ) 126)) (and (< (quotient string-pos-rey 16) (quotient (+ string-pos-rey 70) 16)) (> (remainder string-pos-rey 16) (remainder (+ string-pos-rey 70) 16))) (equal? (substring string-juego (+ string-pos-rey 14) (+ string-pos-rey 16)) "00") (equal? (substring string-juego (+ string-pos-rey 28) (+ string-pos-rey 30)) "00") (equal? (substring string-juego (+ string-pos-rey 42) (+ string-pos-rey 44)) "00") (equal? (substring string-juego (+ string-pos-rey 56) (+ string-pos-rey 58)) "00") (or (equal? (substring string-juego (+ string-pos-rey 70) (+ string-pos-rey 71)) "Q") (equal? (substring string-juego (+ string-pos-rey 70) (+ string-pos-rey 71)) "A")))
                     (and (and (>= (+ string-pos-rey 84 ) 0) (<= (+ string-pos-rey 84 ) 126)) (and (< (quotient string-pos-rey 16) (quotient (+ string-pos-rey 84) 16)) (> (remainder string-pos-rey 16) (remainder (+ string-pos-rey 84) 16))) (equal? (substring string-juego (+ string-pos-rey 14) (+ string-pos-rey 16)) "00") (equal? (substring string-juego (+ string-pos-rey 28) (+ string-pos-rey 30)) "00") (equal? (substring string-juego (+ string-pos-rey 42) (+ string-pos-rey 44)) "00") (equal? (substring string-juego (+ string-pos-rey 56) (+ string-pos-rey 58)) "00") (equal? (substring string-juego (+ string-pos-rey 70) (+ string-pos-rey 72)) "00") (or (equal? (substring string-juego (+ string-pos-rey 84) (+ string-pos-rey 85)) "Q") (equal? (substring string-juego (+ string-pos-rey 84) (+ string-pos-rey 85)) "A")))
                     (and (and (>= (+ string-pos-rey 98 ) 0) (<= (+ string-pos-rey 98 ) 126)) (and (< (quotient string-pos-rey 16) (quotient (+ string-pos-rey 98) 16)) (> (remainder string-pos-rey 16) (remainder (+ string-pos-rey 98) 16))) (equal? (substring string-juego (+ string-pos-rey 14) (+ string-pos-rey 16)) "00") (equal? (substring string-juego (+ string-pos-rey 28) (+ string-pos-rey 30)) "00") (equal? (substring string-juego (+ string-pos-rey 42) (+ string-pos-rey 44)) "00") (equal? (substring string-juego (+ string-pos-rey 56) (+ string-pos-rey 58)) "00") (equal? (substring string-juego (+ string-pos-rey 70) (+ string-pos-rey 72)) "00") (equal? (substring string-juego (+ string-pos-rey 84) (+ string-pos-rey 86)) "00") (or (equal? (substring string-juego (+ string-pos-rey 94) (+ string-pos-rey 95)) "Q") (equal? (substring string-juego (+ string-pos-rey 94) (+ string-pos-rey 95)) "A")))
                 ); fin condicion
                  #t
                ]; de lo contrario
                ; se asegura de que no se puede acercar al rey contrario
                [(or (and (and (>= (- string-pos-rey 14 ) 0) (<= (- string-pos-rey 14 ) 126)) (equal? (substring string-juego (- string-pos-rey 14) (- string-pos-rey 13)) "R")) (and (and (>= (- string-pos-rey 16 ) 0) (<= (- string-pos-rey 16 ) 126)) (equal? (substring string-juego (- string-pos-rey 16) (- string-pos-rey 15)) "R")) (and (and (>= (- string-pos-rey 18 ) 0) (<= (- string-pos-rey 18 ) 126)) (equal? (substring string-juego (- string-pos-rey 18) (- string-pos-rey 17)) "R"))
                     (and (and (>= (- string-pos-rey  2 ) 0) (<= (- string-pos-rey  2 ) 126)) (equal? (substring string-juego (- string-pos-rey 2) (- string-pos-rey 1)) "R"  ))                                                         #| Posición Del Rey que se esta analizando |#                                                       (and (and (>= (+ string-pos-rey  2 ) 0) (<= (+ string-pos-rey  2 ) 126)) (equal? (substring string-juego (+ string-pos-rey 2) (+ string-pos-rey 3)) "R"  ))
                     (and (and (>= (+ string-pos-rey 14 ) 0) (<= (+ string-pos-rey 14 ) 126)) (equal? (substring string-juego (+ string-pos-rey 14) (+ string-pos-rey 15)) "R")) (and (and (>= (+ string-pos-rey 16 ) 0) (<= (+ string-pos-rey 16 ) 126)) (equal? (substring string-juego (+ string-pos-rey 16) (+ string-pos-rey 17)) "R")) (and (and (>= (+ string-pos-rey 18 ) 0) (<= (+ string-pos-rey 18 ) 126)) (equal? (substring string-juego (+ string-pos-rey 18) (+ string-pos-rey 19)) "R"))
                 ); fin condicion
                 #t
                ]; de lo contrario no esta en peligro o en jaque
                [else #f]
              ); fin cond
          ; de lo contrario
              (cond #| condicional para saber si existe alguna ficha que ponga en peligro al rey negro |#
                ; buscar jaque de algun caballo sobre el rey negro
                [(and (and (>= (- string-pos-rey 34) 0) (<= (- string-pos-rey 34) 126)) (equal? (substring string-juego (- string-pos-rey 34) (- string-pos-rey 33)) "c") (and (> (quotient string-pos-rey 16) (quotient (- string-pos-rey 34) 16)) (> (remainder string-pos-rey 16) (remainder (- string-pos-rey 34) 16)))) #t]
                [(and (and (>= (- string-pos-rey 30) 0) (<= (- string-pos-rey 30) 126)) (equal? (substring string-juego (- string-pos-rey 30) (- string-pos-rey 29)) "c") (and (> (quotient string-pos-rey 16) (quotient (- string-pos-rey 30) 16)) (< (remainder string-pos-rey 16) (remainder (- string-pos-rey 30) 16)))) #t]
                [(and (and (>= (- string-pos-rey 20) 0) (<= (- string-pos-rey 20) 126)) (equal? (substring string-juego (- string-pos-rey 20) (- string-pos-rey 19)) "c") (and (> (quotient string-pos-rey 16) (quotient (- string-pos-rey 20) 16)) (> (remainder string-pos-rey 16) (remainder (- string-pos-rey 20) 16)))) #t]
                [(and (and (>= (- string-pos-rey 12) 0) (<= (- string-pos-rey 12) 126)) (equal? (substring string-juego (- string-pos-rey 12) (- string-pos-rey 11)) "c") (and (> (quotient string-pos-rey 16) (quotient (- string-pos-rey 12) 16)) (< (remainder string-pos-rey 16) (remainder (- string-pos-rey 12) 16)))) #t]
                [(and (and (>= (+ string-pos-rey 12) 0) (<= (+ string-pos-rey 12) 126)) (equal? (substring string-juego (+ string-pos-rey 12) (+ string-pos-rey 13)) "c") (and (< (quotient string-pos-rey 16) (quotient (+ string-pos-rey 12) 16)) (> (remainder string-pos-rey 16) (remainder (+ string-pos-rey 12) 16)))) #t]
                [(and (and (>= (+ string-pos-rey 20) 0) (<= (+ string-pos-rey 20) 126)) (equal? (substring string-juego (+ string-pos-rey 20) (+ string-pos-rey 21)) "c") (and (< (quotient string-pos-rey 16) (quotient (+ string-pos-rey 20) 16)) (< (remainder string-pos-rey 16) (remainder (+ string-pos-rey 20) 16)))) #t]
                [(and (and (>= (+ string-pos-rey 30) 0) (<= (+ string-pos-rey 30) 126)) (equal? (substring string-juego (+ string-pos-rey 30) (+ string-pos-rey 31)) "c") (and (< (quotient string-pos-rey 16) (quotient (+ string-pos-rey 30) 16)) (> (remainder string-pos-rey 16) (remainder (+ string-pos-rey 30) 16)))) #t]
                [(and (and (>= (+ string-pos-rey 34) 0) (<= (+ string-pos-rey 34) 126)) (equal? (substring string-juego (+ string-pos-rey 34) (+ string-pos-rey 35)) "c") (and (< (quotient string-pos-rey 16) (quotient (+ string-pos-rey 34) 16)) (< (remainder string-pos-rey 16) (remainder (+ string-pos-rey 34) 16)))) #t]
                ; buscar jaque por encima del rey negro
                [(or (and (and (>= (- string-pos-rey 16 ) 0) (<= (- string-pos-rey 16 ) 126)) (or (equal? (substring string-juego (- string-pos-rey 16) (- string-pos-rey 15)) "q") (equal? (substring string-juego (- string-pos-rey 16) (- string-pos-rey 15)) "t")))
                     (and (and (>= (- string-pos-rey 32 ) 0) (<= (- string-pos-rey 32 ) 126)) (equal? (substring string-juego (- string-pos-rey 16) (- string-pos-rey 14)) "00") (or (equal? (substring string-juego (- string-pos-rey 32) (- string-pos-rey 31)) "q")(equal? (substring string-juego (- string-pos-rey 32) (- string-pos-rey 31)) "t")))
                     (and (and (>= (- string-pos-rey 48 ) 0) (<= (- string-pos-rey 48 ) 126)) (equal? (substring string-juego (- string-pos-rey 16) (- string-pos-rey 14)) "00") (equal? (substring string-juego (- string-pos-rey 32) (- string-pos-rey 30)) "00") (or (equal? (substring string-juego (- string-pos-rey 48) (- string-pos-rey 47)) "q") (equal? (substring string-juego (- string-pos-rey 48) (- string-pos-rey 47)) "t")))
                     (and (and (>= (- string-pos-rey 64 ) 0) (<= (- string-pos-rey 64 ) 126)) (equal? (substring string-juego (- string-pos-rey 16) (- string-pos-rey 14)) "00") (equal? (substring string-juego (- string-pos-rey 32) (- string-pos-rey 30)) "00") (equal? (substring string-juego (- string-pos-rey 48) (- string-pos-rey 46)) "00") (or (equal? (substring string-juego (- string-pos-rey 64) (- string-pos-rey 63)) "q")(equal? (substring string-juego (- string-pos-rey 64) (- string-pos-rey 63)) "t")))
                     (and (and (>= (- string-pos-rey 80 ) 0) (<= (- string-pos-rey 80 ) 126)) (equal? (substring string-juego (- string-pos-rey 16) (- string-pos-rey 14)) "00") (equal? (substring string-juego (- string-pos-rey 32) (- string-pos-rey 30)) "00") (equal? (substring string-juego (- string-pos-rey 48) (- string-pos-rey 46)) "00") (equal? (substring string-juego (- string-pos-rey 64) (- string-pos-rey 62)) "00") (or (equal? (substring string-juego (- string-pos-rey 80) (- string-pos-rey 79)) "q") (equal? (substring string-juego (- string-pos-rey 80) (- string-pos-rey 79)) "t")))
                     (and (and (>= (- string-pos-rey 96 ) 0) (<= (- string-pos-rey 96 ) 126)) (equal? (substring string-juego (- string-pos-rey 16) (- string-pos-rey 14)) "00") (equal? (substring string-juego (- string-pos-rey 32) (- string-pos-rey 30)) "00") (equal? (substring string-juego (- string-pos-rey 48) (- string-pos-rey 46)) "00") (equal? (substring string-juego (- string-pos-rey 64) (- string-pos-rey 62)) "00") (equal? (substring string-juego (- string-pos-rey 80) (- string-pos-rey 78)) "00") (or (equal? (substring string-juego (- string-pos-rey 96) (- string-pos-rey 95)) "q") (equal? (substring string-juego (- string-pos-rey 96) (- string-pos-rey 95)) "t")))
                     (and (and (>= (- string-pos-rey 112) 0) (<= (- string-pos-rey 112) 126)) (equal? (substring string-juego (- string-pos-rey 16) (- string-pos-rey 14)) "00") (equal? (substring string-juego (- string-pos-rey 32) (- string-pos-rey 30)) "00") (equal? (substring string-juego (- string-pos-rey 48) (- string-pos-rey 46)) "00") (equal? (substring string-juego (- string-pos-rey 64) (- string-pos-rey 62)) "00") (equal? (substring string-juego (- string-pos-rey 80) (- string-pos-rey 78)) "00") (equal? (substring string-juego (- string-pos-rey 96) (- string-pos-rey 94)) "00") (or (equal? (substring string-juego (- string-pos-rey 112) (- string-pos-rey 111)) "q") (equal? (substring string-juego (- string-pos-rey 112) (- string-pos-rey 111)) "t")))
                 ); fin condicion
                  #t
                ]; de lo contrario
                ; buscar jaque debajo del rey negro
                [(or (and (and (>= (+ string-pos-rey 16 ) 0) (<= (+ string-pos-rey 16 ) 126)) (or (equal? (substring string-juego (+ string-pos-rey 16) (+ string-pos-rey 17)) "q") (equal? (substring string-juego (+ string-pos-rey 16) (+ string-pos-rey 17)) "t")))
                     (and (and (>= (+ string-pos-rey 32 ) 0) (<= (+ string-pos-rey 32 ) 126)) (equal? (substring string-juego (+ string-pos-rey 16) (+ string-pos-rey 18)) "00") (or (equal? (substring string-juego (+ string-pos-rey 32) (+ string-pos-rey 33)) "q")(equal? (substring string-juego (+ string-pos-rey 32) (+ string-pos-rey 33)) "t")))
                     (and (and (>= (+ string-pos-rey 48 ) 0) (<= (+ string-pos-rey 48 ) 126)) (equal? (substring string-juego (+ string-pos-rey 16) (+ string-pos-rey 18)) "00") (equal? (substring string-juego (+ string-pos-rey 32) (+ string-pos-rey 34)) "00") (or (equal? (substring string-juego (+ string-pos-rey 48) (+ string-pos-rey 49)) "q") (equal? (substring string-juego (+ string-pos-rey 48) (+ string-pos-rey 49)) "t")))
                     (and (and (>= (+ string-pos-rey 64 ) 0) (<= (+ string-pos-rey 64 ) 126)) (equal? (substring string-juego (+ string-pos-rey 16) (+ string-pos-rey 18)) "00") (equal? (substring string-juego (+ string-pos-rey 32) (+ string-pos-rey 34)) "00") (equal? (substring string-juego (+ string-pos-rey 48) (+ string-pos-rey 50)) "00") (or (equal? (substring string-juego (+ string-pos-rey 64) (+ string-pos-rey 65)) "q")(equal? (substring string-juego (+ string-pos-rey 64) (+ string-pos-rey 65)) "t")))
                     (and (and (>= (+ string-pos-rey 80 ) 0) (<= (+ string-pos-rey 80 ) 126)) (equal? (substring string-juego (+ string-pos-rey 16) (+ string-pos-rey 18)) "00") (equal? (substring string-juego (+ string-pos-rey 32) (+ string-pos-rey 34)) "00") (equal? (substring string-juego (+ string-pos-rey 48) (+ string-pos-rey 50)) "00") (equal? (substring string-juego (+ string-pos-rey 64) (+ string-pos-rey 66)) "00") (or (equal? (substring string-juego (+ string-pos-rey 80) (+ string-pos-rey 81)) "q") (equal? (substring string-juego (+ string-pos-rey 80) (+ string-pos-rey 81)) "t")))
                     (and (and (>= (+ string-pos-rey 96 ) 0) (<= (+ string-pos-rey 96 ) 126)) (equal? (substring string-juego (+ string-pos-rey 16) (+ string-pos-rey 18)) "00") (equal? (substring string-juego (+ string-pos-rey 32) (+ string-pos-rey 34)) "00") (equal? (substring string-juego (+ string-pos-rey 48) (+ string-pos-rey 50)) "00") (equal? (substring string-juego (+ string-pos-rey 64) (+ string-pos-rey 66)) "00") (equal? (substring string-juego (+ string-pos-rey 80) (+ string-pos-rey 82)) "00") (or (equal? (substring string-juego (+ string-pos-rey 96) (+ string-pos-rey 97)) "q") (equal? (substring string-juego (+ string-pos-rey 96) (+ string-pos-rey 97)) "t")))
                     (and (and (>= (+ string-pos-rey 112) 0) (<= (+ string-pos-rey 112) 126)) (equal? (substring string-juego (+ string-pos-rey 16) (+ string-pos-rey 18)) "00") (equal? (substring string-juego (+ string-pos-rey 32) (+ string-pos-rey 34)) "00") (equal? (substring string-juego (+ string-pos-rey 48) (+ string-pos-rey 50)) "00") (equal? (substring string-juego (+ string-pos-rey 64) (+ string-pos-rey 66)) "00") (equal? (substring string-juego (+ string-pos-rey 80) (+ string-pos-rey 82)) "00") (equal? (substring string-juego (+ string-pos-rey 96) (+ string-pos-rey 98)) "00") (or (equal? (substring string-juego (+ string-pos-rey 112) (+ string-pos-rey 113)) "q") (equal? (substring string-juego (+ string-pos-rey 112) (+ string-pos-rey 113)) "t")))
                 ); fin condicion
                  #t
                ]; de lo contrario
                ; buscar jaque por la izquierda del rey negro
                [(or (and (and (>= (- string-pos-rey  2 ) 0) (<= (- string-pos-rey  2 ) 126)) (= (quotient string-pos-rey 16) (quotient (- string-pos-rey 2) 16)) (or (equal? (substring string-juego (- string-pos-rey 2) (- string-pos-rey 1)) "q") (equal? (substring string-juego (- string-pos-rey 2) (- string-pos-rey 1)) "t")))
                     (and (and (>= (- string-pos-rey  4 ) 0) (<= (- string-pos-rey  4 ) 126)) (= (quotient string-pos-rey 16) (quotient (- string-pos-rey 4) 16)) (equal? (substring string-juego (- string-pos-rey 2) (- string-pos-rey 0)) "00") (or (equal? (substring string-juego (- string-pos-rey 4) (- string-pos-rey 3)) "q")(equal? (substring string-juego (- string-pos-rey 4) (- string-pos-rey 3)) "t")))
                     (and (and (>= (- string-pos-rey  6 ) 0) (<= (- string-pos-rey  6 ) 126)) (= (quotient string-pos-rey 16) (quotient (- string-pos-rey 6) 16)) (equal? (substring string-juego (- string-pos-rey 2) (- string-pos-rey 0)) "00") (equal? (substring string-juego (- string-pos-rey 4) (- string-pos-rey 2)) "00") (or (equal? (substring string-juego (- string-pos-rey 6) (- string-pos-rey 5)) "q") (equal? (substring string-juego (- string-pos-rey 6) (- string-pos-rey 5)) "t")))
                     (and (and (>= (- string-pos-rey  8 ) 0) (<= (- string-pos-rey  8 ) 126)) (= (quotient string-pos-rey 16) (quotient (- string-pos-rey 8) 16)) (equal? (substring string-juego (- string-pos-rey 2) (- string-pos-rey 0)) "00") (equal? (substring string-juego (- string-pos-rey 4) (- string-pos-rey 2)) "00") (equal? (substring string-juego (- string-pos-rey 6) (- string-pos-rey 4)) "00") (or (equal? (substring string-juego (- string-pos-rey 8) (- string-pos-rey 7)) "q")(equal? (substring string-juego (- string-pos-rey 8) (- string-pos-rey 7)) "t")))
                     (and (and (>= (- string-pos-rey 10 ) 0) (<= (- string-pos-rey 10 ) 126)) (= (quotient string-pos-rey 16) (quotient (- string-pos-rey 10) 16)) (equal? (substring string-juego (- string-pos-rey 2) (- string-pos-rey 0)) "00") (equal? (substring string-juego (- string-pos-rey 4) (- string-pos-rey 2)) "00") (equal? (substring string-juego (- string-pos-rey 6) (- string-pos-rey 4)) "00") (equal? (substring string-juego (- string-pos-rey 8) (- string-pos-rey 6)) "00") (or (equal? (substring string-juego (- string-pos-rey 10) (- string-pos-rey 9)) "q") (equal? (substring string-juego (- string-pos-rey 10) (- string-pos-rey 9)) "t")))
                     (and (and (>= (- string-pos-rey 12 ) 0) (<= (- string-pos-rey 12 ) 126)) (= (quotient string-pos-rey 16) (quotient (- string-pos-rey 12) 16)) (equal? (substring string-juego (- string-pos-rey 2) (- string-pos-rey 0)) "00") (equal? (substring string-juego (- string-pos-rey 4) (- string-pos-rey 2)) "00") (equal? (substring string-juego (- string-pos-rey 6) (- string-pos-rey 4)) "00") (equal? (substring string-juego (- string-pos-rey 8) (- string-pos-rey 6)) "00") (equal? (substring string-juego (- string-pos-rey 10) (- string-pos-rey 8)) "00") (or (equal? (substring string-juego (- string-pos-rey 12) (- string-pos-rey 11)) "q") (equal? (substring string-juego (- string-pos-rey 12) (- string-pos-rey 11)) "t")))
                     (and (and (>= (- string-pos-rey 14 ) 0) (<= (- string-pos-rey 14 ) 126)) (= (quotient string-pos-rey 16) (quotient (- string-pos-rey 14) 16)) (equal? (substring string-juego (- string-pos-rey 2) (- string-pos-rey 0)) "00") (equal? (substring string-juego (- string-pos-rey 4) (- string-pos-rey 2)) "00") (equal? (substring string-juego (- string-pos-rey 6) (- string-pos-rey 4)) "00") (equal? (substring string-juego (- string-pos-rey 8) (- string-pos-rey 6)) "00") (equal? (substring string-juego (- string-pos-rey 10) (- string-pos-rey 8)) "00") (equal? (substring string-juego (- string-pos-rey 12) (- string-pos-rey 10)) "00") (or (equal? (substring string-juego (- string-pos-rey 14) (- string-pos-rey 13)) "q") (equal? (substring string-juego (- string-pos-rey 14) (- string-pos-rey 13)) "t")))
                 ); fin condicion
                  #t
                ]; de lo contrario
                ; buscar jaque por la derecha del rey negro
                [(or (and (and (>= (+ string-pos-rey  2 ) 0) (<= (+ string-pos-rey  2 ) 126)) (= (quotient string-pos-rey 16) (quotient (+ string-pos-rey 2) 16)) (or (equal? (substring string-juego (+ string-pos-rey 2) (+ string-pos-rey 3)) "q") (equal? (substring string-juego (+ string-pos-rey 2) (+ string-pos-rey 3)) "t")))
                     (and (and (>= (+ string-pos-rey  4 ) 0) (<= (+ string-pos-rey  4 ) 126)) (= (quotient string-pos-rey 16) (quotient (+ string-pos-rey 4) 16)) (equal? (substring string-juego (+ string-pos-rey 2) (+ string-pos-rey 4)) "00") (or (equal? (substring string-juego (+ string-pos-rey 4) (+ string-pos-rey 5)) "q")(equal? (substring string-juego (+ string-pos-rey 4) (+ string-pos-rey 5)) "t")))
                     (and (and (>= (+ string-pos-rey  6 ) 0) (<= (+ string-pos-rey  6 ) 126)) (= (quotient string-pos-rey 16) (quotient (+ string-pos-rey 6) 16)) (equal? (substring string-juego (+ string-pos-rey 2) (+ string-pos-rey 4)) "00") (equal? (substring string-juego (+ string-pos-rey 4) (+ string-pos-rey 6)) "00") (or (equal? (substring string-juego (+ string-pos-rey 6) (+ string-pos-rey 7)) "q") (equal? (substring string-juego (+ string-pos-rey 6) (+ string-pos-rey 7)) "t")))
                     (and (and (>= (+ string-pos-rey  8 ) 0) (<= (+ string-pos-rey  8 ) 126)) (= (quotient string-pos-rey 16) (quotient (+ string-pos-rey 8) 16)) (equal? (substring string-juego (+ string-pos-rey 2) (+ string-pos-rey 4)) "00") (equal? (substring string-juego (+ string-pos-rey 4) (+ string-pos-rey 6)) "00") (equal? (substring string-juego (+ string-pos-rey 6) (+ string-pos-rey 8)) "00") (or (equal? (substring string-juego (+ string-pos-rey 8) (+ string-pos-rey 9)) "q")(equal? (substring string-juego (+ string-pos-rey 8) (+ string-pos-rey 9)) "t")))
                     (and (and (>= (+ string-pos-rey 10 ) 0) (<= (+ string-pos-rey 10 ) 126)) (= (quotient string-pos-rey 16) (quotient (+ string-pos-rey 10) 16)) (equal? (substring string-juego (+ string-pos-rey 2) (+ string-pos-rey 4)) "00") (equal? (substring string-juego (+ string-pos-rey 4) (+ string-pos-rey 6)) "00") (equal? (substring string-juego (+ string-pos-rey 6) (+ string-pos-rey 8)) "00") (equal? (substring string-juego (+ string-pos-rey 8) (+ string-pos-rey 10)) "00") (or (equal? (substring string-juego (+ string-pos-rey 10) (+ string-pos-rey 11)) "q") (equal? (substring string-juego (+ string-pos-rey 10) (+ string-pos-rey 11)) "t")))
                     (and (and (>= (+ string-pos-rey 12 ) 0) (<= (+ string-pos-rey 12 ) 126)) (= (quotient string-pos-rey 16) (quotient (+ string-pos-rey 12) 16)) (equal? (substring string-juego (+ string-pos-rey 2) (+ string-pos-rey 4)) "00") (equal? (substring string-juego (+ string-pos-rey 4) (+ string-pos-rey 6)) "00") (equal? (substring string-juego (+ string-pos-rey 6) (+ string-pos-rey 8)) "00") (equal? (substring string-juego (+ string-pos-rey 8) (+ string-pos-rey 10)) "00") (equal? (substring string-juego (+ string-pos-rey 10) (+ string-pos-rey 12)) "00") (or (equal? (substring string-juego (+ string-pos-rey 12) (+ string-pos-rey 13)) "q") (equal? (substring string-juego (+ string-pos-rey 12) (+ string-pos-rey 13)) "t")))
                     (and (and (>= (+ string-pos-rey 14 ) 0) (<= (+ string-pos-rey 14 ) 126)) (= (quotient string-pos-rey 16) (quotient (+ string-pos-rey 14) 16)) (equal? (substring string-juego (+ string-pos-rey 2) (+ string-pos-rey 4)) "00") (equal? (substring string-juego (+ string-pos-rey 4) (+ string-pos-rey 6)) "00") (equal? (substring string-juego (+ string-pos-rey 6) (+ string-pos-rey 8)) "00") (equal? (substring string-juego (+ string-pos-rey 8) (+ string-pos-rey 10)) "00") (equal? (substring string-juego (+ string-pos-rey 10) (+ string-pos-rey 12)) "00") (equal? (substring string-juego (+ string-pos-rey 12) (+ string-pos-rey 14)) "00") (or (equal? (substring string-juego (+ string-pos-rey 14) (+ string-pos-rey 15)) "q") (equal? (substring string-juego (+ string-pos-rey 14) (+ string-pos-rey 15)) "t")))
                 ); fin condicion
                  #t
                ]; de lo contrario
                ; buscar jaque por encima a la izquierda del rey negro
                [(or (and (and (>= (- string-pos-rey 18 ) 0) (<= (- string-pos-rey 18 ) 126)) (and (> (quotient string-pos-rey 16) (quotient (- string-pos-rey 18) 16)) (> (remainder string-pos-rey 16) (remainder (- string-pos-rey 18) 16))) (or (equal? (substring string-juego (- string-pos-rey 18) (- string-pos-rey 17)) "q") (equal? (substring string-juego (- string-pos-rey 18) (- string-pos-rey 17)) "a")))
                     (and (and (>= (- string-pos-rey 36 ) 0) (<= (- string-pos-rey 36 ) 126)) (and (> (quotient string-pos-rey 16) (quotient (- string-pos-rey 36) 16)) (> (remainder string-pos-rey 16) (remainder (- string-pos-rey 36) 16))) (equal? (substring string-juego (- string-pos-rey 18) (- string-pos-rey 16)) "00") (or (equal? (substring string-juego (- string-pos-rey 36) (- string-pos-rey 35)) "q") (equal? (substring string-juego (- string-pos-rey 36) (- string-pos-rey 35)) "a")))
                     (and (and (>= (- string-pos-rey 54 ) 0) (<= (- string-pos-rey 54 ) 126)) (and (> (quotient string-pos-rey 16) (quotient (- string-pos-rey 54) 16)) (> (remainder string-pos-rey 16) (remainder (- string-pos-rey 54) 16))) (equal? (substring string-juego (- string-pos-rey 18) (- string-pos-rey 16)) "00") (equal? (substring string-juego (- string-pos-rey 36) (- string-pos-rey 34)) "00") (or (equal? (substring string-juego (- string-pos-rey 54) (- string-pos-rey 53)) "q") (equal? (substring string-juego (- string-pos-rey 54) (- string-pos-rey 53)) "a")))
                     (and (and (>= (- string-pos-rey 72 ) 0) (<= (- string-pos-rey 72 ) 126)) (and (> (quotient string-pos-rey 16) (quotient (- string-pos-rey 72) 16)) (> (remainder string-pos-rey 16) (remainder (- string-pos-rey 72) 16))) (equal? (substring string-juego (- string-pos-rey 18) (- string-pos-rey 16)) "00") (equal? (substring string-juego (- string-pos-rey 36) (- string-pos-rey 34)) "00") (equal? (substring string-juego (- string-pos-rey 54) (- string-pos-rey 52)) "00") (or (equal? (substring string-juego (- string-pos-rey 72) (- string-pos-rey 71)) "q") (equal? (substring string-juego (- string-pos-rey 72) (- string-pos-rey 71)) "a")))
                     (and (and (>= (- string-pos-rey 90 ) 0) (<= (- string-pos-rey 90 ) 126)) (and (> (quotient string-pos-rey 16) (quotient (- string-pos-rey 90) 16)) (> (remainder string-pos-rey 16) (remainder (- string-pos-rey 90) 16))) (equal? (substring string-juego (- string-pos-rey 18) (- string-pos-rey 16)) "00") (equal? (substring string-juego (- string-pos-rey 36) (- string-pos-rey 34)) "00") (equal? (substring string-juego (- string-pos-rey 54) (- string-pos-rey 52)) "00") (equal? (substring string-juego (- string-pos-rey 72) (- string-pos-rey 70)) "00") (or (equal? (substring string-juego (- string-pos-rey 90) (- string-pos-rey 89)) "q") (equal? (substring string-juego (- string-pos-rey 90) (- string-pos-rey 89)) "a")))
                     (and (and (>= (- string-pos-rey 108) 0) (<= (- string-pos-rey 108) 126)) (and (> (quotient string-pos-rey 16) (quotient (- string-pos-rey 108) 16)) (> (remainder string-pos-rey 16) (remainder (- string-pos-rey 108) 16))) (equal? (substring string-juego (- string-pos-rey 18) (- string-pos-rey 16)) "00") (equal? (substring string-juego (- string-pos-rey 36) (- string-pos-rey 34)) "00") (equal? (substring string-juego (- string-pos-rey 54) (- string-pos-rey 52)) "00") (equal? (substring string-juego (- string-pos-rey 72) (- string-pos-rey 70)) "00") (equal? (substring string-juego (- string-pos-rey 90) (- string-pos-rey 88)) "00") (or (equal? (substring string-juego (- string-pos-rey 108) (- string-pos-rey 107)) "q") (equal? (substring string-juego (- string-pos-rey 108) (- string-pos-rey 107)) "a")))
                     (and (and (>= (- string-pos-rey 126) 0) (<= (- string-pos-rey 126) 126)) (and (> (quotient string-pos-rey 16) (quotient (- string-pos-rey 126) 16)) (> (remainder string-pos-rey 16) (remainder (- string-pos-rey 126) 16))) (equal? (substring string-juego (- string-pos-rey 18) (- string-pos-rey 16)) "00") (equal? (substring string-juego (- string-pos-rey 36) (- string-pos-rey 34)) "00") (equal? (substring string-juego (- string-pos-rey 54) (- string-pos-rey 52)) "00") (equal? (substring string-juego (- string-pos-rey 72) (- string-pos-rey 70)) "00") (equal? (substring string-juego (- string-pos-rey 90) (- string-pos-rey 88)) "00") (equal? (substring string-juego (- string-pos-rey 108) (- string-pos-rey 106)) "00") (or (equal? (substring string-juego (- string-pos-rey 126) (- string-pos-rey 125)) "q") (equal? (substring string-juego (- string-pos-rey 126) (- string-pos-rey 125)) "a")))
                 ); fin condicion
                  #t
                ]; de lo contrario
                ; buscar jaque por encima a la derecha del rey negro
                [(or (and (and (>= (- string-pos-rey 14 ) 0) (<= (- string-pos-rey 14 ) 126)) (and (> (quotient string-pos-rey 16) (quotient (- string-pos-rey 14) 16)) (< (remainder string-pos-rey 16) (remainder (- string-pos-rey 14) 16))) (or (equal? (substring string-juego (- string-pos-rey 14) (- string-pos-rey 13)) "q") (equal? (substring string-juego (- string-pos-rey 14) (- string-pos-rey 13)) "a")))
                     (and (and (>= (- string-pos-rey 28 ) 0) (<= (- string-pos-rey 28 ) 126)) (and (> (quotient string-pos-rey 16) (quotient (- string-pos-rey 28) 16)) (< (remainder string-pos-rey 16) (remainder (- string-pos-rey 28) 16))) (equal? (substring string-juego (- string-pos-rey 14) (- string-pos-rey 12)) "00") (or (equal? (substring string-juego (- string-pos-rey 28) (- string-pos-rey 27)) "q") (equal? (substring string-juego (- string-pos-rey 28) (- string-pos-rey 27)) "a")))
                     (and (and (>= (- string-pos-rey 42 ) 0) (<= (- string-pos-rey 42 ) 126)) (and (> (quotient string-pos-rey 16) (quotient (- string-pos-rey 42) 16)) (< (remainder string-pos-rey 16) (remainder (- string-pos-rey 42) 16))) (equal? (substring string-juego (- string-pos-rey 14) (- string-pos-rey 12)) "00") (equal? (substring string-juego (- string-pos-rey 28) (- string-pos-rey 26)) "00") (or (equal? (substring string-juego (- string-pos-rey 42) (- string-pos-rey 41)) "q") (equal? (substring string-juego (- string-pos-rey 42) (- string-pos-rey 41)) "a")))
                     (and (and (>= (- string-pos-rey 56 ) 0) (<= (- string-pos-rey 56 ) 126)) (and (> (quotient string-pos-rey 16) (quotient (- string-pos-rey 56) 16)) (< (remainder string-pos-rey 16) (remainder (- string-pos-rey 56) 16))) (equal? (substring string-juego (- string-pos-rey 14) (- string-pos-rey 12)) "00") (equal? (substring string-juego (- string-pos-rey 28) (- string-pos-rey 26)) "00") (equal? (substring string-juego (- string-pos-rey 42) (- string-pos-rey 40)) "00") (or (equal? (substring string-juego (- string-pos-rey 56) (- string-pos-rey 55)) "q") (equal? (substring string-juego (- string-pos-rey 56) (- string-pos-rey 55)) "a")))
                     (and (and (>= (- string-pos-rey 70 ) 0) (<= (- string-pos-rey 70 ) 126)) (and (> (quotient string-pos-rey 16) (quotient (- string-pos-rey 70) 16)) (< (remainder string-pos-rey 16) (remainder (- string-pos-rey 70) 16))) (equal? (substring string-juego (- string-pos-rey 14) (- string-pos-rey 12)) "00") (equal? (substring string-juego (- string-pos-rey 28) (- string-pos-rey 26)) "00") (equal? (substring string-juego (- string-pos-rey 42) (- string-pos-rey 40)) "00") (equal? (substring string-juego (- string-pos-rey 56) (- string-pos-rey 54)) "00") (or (equal? (substring string-juego (- string-pos-rey 70) (- string-pos-rey 69)) "q") (equal? (substring string-juego (- string-pos-rey 70) (- string-pos-rey 69)) "a")))
                     (and (and (>= (- string-pos-rey 84 ) 0) (<= (- string-pos-rey 84 ) 126)) (and (> (quotient string-pos-rey 16) (quotient (- string-pos-rey 84) 16)) (< (remainder string-pos-rey 16) (remainder (- string-pos-rey 84) 16))) (equal? (substring string-juego (- string-pos-rey 14) (- string-pos-rey 12)) "00") (equal? (substring string-juego (- string-pos-rey 28) (- string-pos-rey 26)) "00") (equal? (substring string-juego (- string-pos-rey 42) (- string-pos-rey 40)) "00") (equal? (substring string-juego (- string-pos-rey 56) (- string-pos-rey 54)) "00") (equal? (substring string-juego (- string-pos-rey 70) (- string-pos-rey 68)) "00") (or (equal? (substring string-juego (- string-pos-rey 84) (- string-pos-rey 83)) "q") (equal? (substring string-juego (- string-pos-rey 84) (- string-pos-rey 83)) "a")))
                     (and (and (>= (- string-pos-rey 98 ) 0) (<= (- string-pos-rey 98 ) 126)) (and (> (quotient string-pos-rey 16) (quotient (- string-pos-rey 98) 16)) (< (remainder string-pos-rey 16) (remainder (- string-pos-rey 98) 16))) (equal? (substring string-juego (- string-pos-rey 14) (- string-pos-rey 12)) "00") (equal? (substring string-juego (- string-pos-rey 28) (- string-pos-rey 26)) "00") (equal? (substring string-juego (- string-pos-rey 42) (- string-pos-rey 40)) "00") (equal? (substring string-juego (- string-pos-rey 56) (- string-pos-rey 54)) "00") (equal? (substring string-juego (- string-pos-rey 70) (- string-pos-rey 68)) "00") (equal? (substring string-juego (- string-pos-rey 84) (- string-pos-rey 82)) "00") (or (equal? (substring string-juego (- string-pos-rey 94) (- string-pos-rey 93)) "q") (equal? (substring string-juego (- string-pos-rey 94) (- string-pos-rey 93)) "a")))
                 ); fin condicion
                  #t
                ]; de lo contrario
                ; buscar jaque por debajo a al derecha del rey negro
                [(or (and (and (>= (+ string-pos-rey 18 ) 0) (<= (+ string-pos-rey 18 ) 126)) (and (< (quotient string-pos-rey 16) (quotient (+ string-pos-rey 18) 16)) (< (remainder string-pos-rey 16) (remainder (+ string-pos-rey 18) 16))) (or (equal? (substring string-juego (+ string-pos-rey 18) (+ string-pos-rey 19)) "q") (equal? (substring string-juego (+ string-pos-rey 18) (+ string-pos-rey 19)) "a") (equal? (substring string-juego (+ string-pos-rey 18) (+ string-pos-rey 19)) "p")))
                     (and (and (>= (+ string-pos-rey 36 ) 0) (<= (+ string-pos-rey 36 ) 126)) (and (< (quotient string-pos-rey 16) (quotient (+ string-pos-rey 36) 16)) (< (remainder string-pos-rey 16) (remainder (+ string-pos-rey 36) 16))) (equal? (substring string-juego (+ string-pos-rey 18) (+ string-pos-rey 20)) "00") (or (equal? (substring string-juego (+ string-pos-rey 36) (+ string-pos-rey 37)) "q") (equal? (substring string-juego (+ string-pos-rey 36) (+ string-pos-rey 37)) "a")))
                     (and (and (>= (+ string-pos-rey 54 ) 0) (<= (+ string-pos-rey 54 ) 126)) (and (< (quotient string-pos-rey 16) (quotient (+ string-pos-rey 54) 16)) (< (remainder string-pos-rey 16) (remainder (+ string-pos-rey 54) 16))) (equal? (substring string-juego (+ string-pos-rey 18) (+ string-pos-rey 20)) "00") (equal? (substring string-juego (+ string-pos-rey 36) (+ string-pos-rey 38)) "00") (or (equal? (substring string-juego (+ string-pos-rey 54) (+ string-pos-rey 55)) "q") (equal? (substring string-juego (+ string-pos-rey 54) (+ string-pos-rey 55)) "a")))
                     (and (and (>= (+ string-pos-rey 72 ) 0) (<= (+ string-pos-rey 72 ) 126)) (and (< (quotient string-pos-rey 16) (quotient (+ string-pos-rey 72) 16)) (< (remainder string-pos-rey 16) (remainder (+ string-pos-rey 72) 16))) (equal? (substring string-juego (+ string-pos-rey 18) (+ string-pos-rey 20)) "00") (equal? (substring string-juego (+ string-pos-rey 36) (+ string-pos-rey 38)) "00") (equal? (substring string-juego (+ string-pos-rey 54) (+ string-pos-rey 56)) "00") (or (equal? (substring string-juego (+ string-pos-rey 72) (+ string-pos-rey 73)) "q") (equal? (substring string-juego (+ string-pos-rey 72) (+ string-pos-rey 73)) "a")))
                     (and (and (>= (+ string-pos-rey 90 ) 0) (<= (+ string-pos-rey 90 ) 126)) (and (< (quotient string-pos-rey 16) (quotient (+ string-pos-rey 90) 16)) (< (remainder string-pos-rey 16) (remainder (+ string-pos-rey 90) 16))) (equal? (substring string-juego (+ string-pos-rey 18) (+ string-pos-rey 20)) "00") (equal? (substring string-juego (+ string-pos-rey 36) (+ string-pos-rey 38)) "00") (equal? (substring string-juego (+ string-pos-rey 54) (+ string-pos-rey 56)) "00") (equal? (substring string-juego (+ string-pos-rey 72) (+ string-pos-rey 74)) "00") (or (equal? (substring string-juego (+ string-pos-rey 90) (+ string-pos-rey 91)) "q") (equal? (substring string-juego (+ string-pos-rey 90) (+ string-pos-rey 91)) "a")))
                     (and (and (>= (+ string-pos-rey 108) 0) (<= (+ string-pos-rey 108) 126)) (and (< (quotient string-pos-rey 16) (quotient (+ string-pos-rey 108) 16)) (< (remainder string-pos-rey 16) (remainder (+ string-pos-rey 108) 16))) (equal? (substring string-juego (+ string-pos-rey 18) (+ string-pos-rey 20)) "00") (equal? (substring string-juego (+ string-pos-rey 36) (+ string-pos-rey 38)) "00") (equal? (substring string-juego (+ string-pos-rey 54) (+ string-pos-rey 56)) "00") (equal? (substring string-juego (+ string-pos-rey 72) (+ string-pos-rey 74)) "00") (equal? (substring string-juego (+ string-pos-rey 90) (+ string-pos-rey 92)) "00") (or (equal? (substring string-juego (+ string-pos-rey 108) (+ string-pos-rey 109)) "q") (equal? (substring string-juego (+ string-pos-rey 108) (+ string-pos-rey 109)) "a")))
                     (and (and (>= (+ string-pos-rey 126) 0) (<= (+ string-pos-rey 126) 126)) (and (< (quotient string-pos-rey 16) (quotient (+ string-pos-rey 126) 16)) (< (remainder string-pos-rey 16) (remainder (+ string-pos-rey 126) 16))) (equal? (substring string-juego (+ string-pos-rey 18) (+ string-pos-rey 20)) "00") (equal? (substring string-juego (+ string-pos-rey 36) (+ string-pos-rey 38)) "00") (equal? (substring string-juego (+ string-pos-rey 54) (+ string-pos-rey 56)) "00") (equal? (substring string-juego (+ string-pos-rey 72) (+ string-pos-rey 74)) "00") (equal? (substring string-juego (+ string-pos-rey 90) (+ string-pos-rey 92)) "00") (equal? (substring string-juego (+ string-pos-rey 108) (+ string-pos-rey 110)) "00") (or (equal? (substring string-juego (+ string-pos-rey 126) (+ string-pos-rey 127)) "q") (equal? (substring string-juego (+ string-pos-rey 126) (+ string-pos-rey 127)) "a")))
                 ); fin condicion
                  #t
                ]; de lo contrario
                ; buscar jaque por debajo a la izquierda del rey negro
                [(or (and (and (>= (+ string-pos-rey 14 ) 0) (<= (+ string-pos-rey 14 ) 126)) (and (< (quotient string-pos-rey 16) (quotient (+ string-pos-rey 14) 16)) (> (remainder string-pos-rey 16) (remainder (+ string-pos-rey 14) 16))) (or (equal? (substring string-juego (+ string-pos-rey 14) (+ string-pos-rey 15)) "q") (equal? (substring string-juego (+ string-pos-rey 14) (+ string-pos-rey 15)) "a") (equal? (substring string-juego (+ string-pos-rey 14) (+ string-pos-rey 15)) "p")))
                     (and (and (>= (+ string-pos-rey 28 ) 0) (<= (+ string-pos-rey 28 ) 126)) (and (< (quotient string-pos-rey 16) (quotient (+ string-pos-rey 28) 16)) (> (remainder string-pos-rey 16) (remainder (+ string-pos-rey 28) 16))) (equal? (substring string-juego (+ string-pos-rey 14) (+ string-pos-rey 16)) "00") (or (equal? (substring string-juego (+ string-pos-rey 28) (+ string-pos-rey 29)) "q") (equal? (substring string-juego (+ string-pos-rey 28) (+ string-pos-rey 29)) "a")))
                     (and (and (>= (+ string-pos-rey 42 ) 0) (<= (+ string-pos-rey 42 ) 126)) (and (< (quotient string-pos-rey 16) (quotient (+ string-pos-rey 42) 16)) (> (remainder string-pos-rey 16) (remainder (+ string-pos-rey 42) 16))) (equal? (substring string-juego (+ string-pos-rey 14) (+ string-pos-rey 16)) "00") (equal? (substring string-juego (+ string-pos-rey 28) (+ string-pos-rey 30)) "00") (or (equal? (substring string-juego (+ string-pos-rey 42) (+ string-pos-rey 43)) "q") (equal? (substring string-juego (+ string-pos-rey 42) (+ string-pos-rey 43)) "a")))
                     (and (and (>= (+ string-pos-rey 56 ) 0) (<= (+ string-pos-rey 56 ) 126)) (and (< (quotient string-pos-rey 16) (quotient (+ string-pos-rey 56) 16)) (> (remainder string-pos-rey 16) (remainder (+ string-pos-rey 56) 16))) (equal? (substring string-juego (+ string-pos-rey 14) (+ string-pos-rey 16)) "00") (equal? (substring string-juego (+ string-pos-rey 28) (+ string-pos-rey 30)) "00") (equal? (substring string-juego (+ string-pos-rey 42) (+ string-pos-rey 44)) "00") (or (equal? (substring string-juego (+ string-pos-rey 56) (+ string-pos-rey 57)) "q") (equal? (substring string-juego (+ string-pos-rey 56) (+ string-pos-rey 57)) "a")))
                     (and (and (>= (+ string-pos-rey 70 ) 0) (<= (+ string-pos-rey 70 ) 126)) (and (< (quotient string-pos-rey 16) (quotient (+ string-pos-rey 70) 16)) (> (remainder string-pos-rey 16) (remainder (+ string-pos-rey 70) 16))) (equal? (substring string-juego (+ string-pos-rey 14) (+ string-pos-rey 16)) "00") (equal? (substring string-juego (+ string-pos-rey 28) (+ string-pos-rey 30)) "00") (equal? (substring string-juego (+ string-pos-rey 42) (+ string-pos-rey 44)) "00") (equal? (substring string-juego (+ string-pos-rey 56) (+ string-pos-rey 58)) "00") (or (equal? (substring string-juego (+ string-pos-rey 70) (+ string-pos-rey 71)) "q") (equal? (substring string-juego (+ string-pos-rey 70) (+ string-pos-rey 71)) "a")))
                     (and (and (>= (+ string-pos-rey 84 ) 0) (<= (+ string-pos-rey 84 ) 126)) (and (< (quotient string-pos-rey 16) (quotient (+ string-pos-rey 84) 16)) (> (remainder string-pos-rey 16) (remainder (+ string-pos-rey 84) 16))) (equal? (substring string-juego (+ string-pos-rey 14) (+ string-pos-rey 16)) "00") (equal? (substring string-juego (+ string-pos-rey 28) (+ string-pos-rey 30)) "00") (equal? (substring string-juego (+ string-pos-rey 42) (+ string-pos-rey 44)) "00") (equal? (substring string-juego (+ string-pos-rey 56) (+ string-pos-rey 58)) "00") (equal? (substring string-juego (+ string-pos-rey 70) (+ string-pos-rey 72)) "00") (or (equal? (substring string-juego (+ string-pos-rey 84) (+ string-pos-rey 85)) "q") (equal? (substring string-juego (+ string-pos-rey 84) (+ string-pos-rey 85)) "a")))
                     (and (and (>= (+ string-pos-rey 98 ) 0) (<= (+ string-pos-rey 98 ) 126)) (and (< (quotient string-pos-rey 16) (quotient (+ string-pos-rey 98) 16)) (> (remainder string-pos-rey 16) (remainder (+ string-pos-rey 98) 16))) (equal? (substring string-juego (+ string-pos-rey 14) (+ string-pos-rey 16)) "00") (equal? (substring string-juego (+ string-pos-rey 28) (+ string-pos-rey 30)) "00") (equal? (substring string-juego (+ string-pos-rey 42) (+ string-pos-rey 44)) "00") (equal? (substring string-juego (+ string-pos-rey 56) (+ string-pos-rey 58)) "00") (equal? (substring string-juego (+ string-pos-rey 70) (+ string-pos-rey 72)) "00") (equal? (substring string-juego (+ string-pos-rey 84) (+ string-pos-rey 86)) "00") (or (equal? (substring string-juego (+ string-pos-rey 94) (+ string-pos-rey 95)) "q") (equal? (substring string-juego (+ string-pos-rey 94) (+ string-pos-rey 95)) "a")))
                 ); fin condicion
                  #t
                ]; de lo contrario
                ; se asegura de que no se puede acercar al rey contrario
                [(or (and (and (>= (- string-pos-rey 14 ) 0) (<= (- string-pos-rey 14 ) 126)) (equal? (substring string-juego (- string-pos-rey 14) (- string-pos-rey 13)) "r")) (and (and (>= (- string-pos-rey 16 ) 0) (<= (- string-pos-rey 16 ) 126)) (equal? (substring string-juego (- string-pos-rey 16) (- string-pos-rey 15)) "r")) (and (and (>= (- string-pos-rey 18 ) 0) (<= (- string-pos-rey 18 ) 126)) (equal? (substring string-juego (- string-pos-rey 18) (- string-pos-rey 17)) "r"))
                     (and (and (>= (- string-pos-rey  2 ) 0) (<= (- string-pos-rey  2 ) 126)) (equal? (substring string-juego (- string-pos-rey 2) (- string-pos-rey 1)) "r"  ))                                                         #| Posición Del Rey que se esta analizando |#                                                       (and (and (>= (+ string-pos-rey  2 ) 0) (<= (+ string-pos-rey  2 ) 126)) (equal? (substring string-juego (+ string-pos-rey 2) (+ string-pos-rey 3)) "r"  ))
                     (and (and (>= (+ string-pos-rey 14 ) 0) (<= (+ string-pos-rey 14 ) 126)) (equal? (substring string-juego (+ string-pos-rey 14) (+ string-pos-rey 15)) "r")) (and (and (>= (+ string-pos-rey 16 ) 0) (<= (+ string-pos-rey 16 ) 126)) (equal? (substring string-juego (+ string-pos-rey 16) (+ string-pos-rey 17)) "r")) (and (and (>= (+ string-pos-rey 18 ) 0) (<= (+ string-pos-rey 18 ) 126)) (equal? (substring string-juego (+ string-pos-rey 18) (+ string-pos-rey 19)) "r"))
                 ); fin condicion
                 #t
                ]; de lo contrario no esta en peligro o en jaque
                [else #f]
              ); fin cond
          ); fin if, para saber si se analizara el jaque es en las negras o en las blancas
      ; de lo contrario
          (jaque (+ string-pos-rey 2) ficha)
      ); fin if, para ir cambiando de posicion
  ; de lo contrario
      (void) #| fin del string |#
  ); fin if, para saber si ya revisamos todas las fichas
); fin definicion, jaque

;___________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
#| Definición De La Funcion Que Va A Analizar Si Un Peon A Llegado A Su Coronacrón Para Cambiarlo Por Otra Ficha |#

#| Identificadores Locales A La Función (Coronación):
   - click-mouse: guarda la informacion acerca del ultimo olick dado
   - pixeles-x: almacena las coordenadas en x del primer cuadro del tablero, la cual va contando aumentando su valor hasta ser la del cuadro seleccionado
   - pixeles-y: almacena las coordenadas en y del primer cuadro del tablero, la cual va contando aumentando su valor hasta ser la del cuadro seleccionado
   - pixeles-x-ant: almacena las coordenadas en x donde se encuentra la ficha ya seleccionada
   - pixeles-y-ant: almacena las coordenadas en y donde se encuentra la ficha ya seleccionada
   - string-pos-ant: almacena la posicion númerica de la ficha en el string
   - string-pos: almacena un valor númerico con relacion en el string, el cual va contando hasta ser la posicion a la que se deasea llevar la ficha
   - ficha: almacena un substring que identifica la ficha, en este caso almacena un peon
   - direccion: guarda la dirección de la imagen que se quiere imprimir en la posicion que el usuario desea
; Definicion de la funcion coronacion que espera a que un peon llegue a su casilla maxima para preguntar por cual lo desea intercambiar. |#
(define (coronacion click-mouse pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant string-pos-ant string-pos ficha ventana-coronacion turno)
  (if (= turno 0)
      (begin #| coronana las blancas |#
        (((draw-pixmap-posn "Imagenes/Coronacion 400x400.jpg" ) ventana-coronacion) (make-posn  0   0))
        (((draw-pixmap-posn "Imagenes/CaballoBlanco 60X60.png") ventana-coronacion) (make-posn 40  40))
        (((draw-pixmap-posn "Imagenes/TorreBlanco 60X60.png"  ) ventana-coronacion) (make-posn 40 120))
        (((draw-pixmap-posn "Imagenes/AlfilBlanco 60X60.png"  ) ventana-coronacion) (make-posn 40 200))
        (((draw-pixmap-posn "Imagenes/ReinaBlanco 60X60.png"  ) ventana-coronacion) (make-posn 40 280))
        (cond
          [(and (and (>= (posn-x (mouse-click-posn click-mouse))  40) (<= (posn-x (mouse-click-posn click-mouse)) 100)) (and (>= (posn-y (mouse-click-posn click-mouse))  40) (<= (posn-y (mouse-click-posn click-mouse)) 100))) (string-copy! string-juego string-pos-ant "00") (string-copy! string-juego string-pos "cb") (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant "Imagenes/CaballoBlanco 60X60.png") (close-viewport ventana-coronacion)]
          [(and (and (>= (posn-x (mouse-click-posn click-mouse))  40) (<= (posn-x (mouse-click-posn click-mouse)) 100)) (and (>= (posn-y (mouse-click-posn click-mouse)) 120) (<= (posn-y (mouse-click-posn click-mouse)) 180))) (string-copy! string-juego string-pos-ant "00") (string-copy! string-juego string-pos "tb") (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant "Imagenes/TorreBlanco 60X60.png"  ) (close-viewport ventana-coronacion)]
          [(and (and (>= (posn-x (mouse-click-posn click-mouse))  40) (<= (posn-x (mouse-click-posn click-mouse)) 100)) (and (>= (posn-y (mouse-click-posn click-mouse)) 200) (<= (posn-y (mouse-click-posn click-mouse)) 260))) (string-copy! string-juego string-pos-ant "00") (string-copy! string-juego string-pos "ab") (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant "Imagenes/AlfilBlanco 60X60.png"  ) (close-viewport ventana-coronacion)]
          [(and (and (>= (posn-x (mouse-click-posn click-mouse))  40) (<= (posn-x (mouse-click-posn click-mouse)) 100)) (and (>= (posn-y (mouse-click-posn click-mouse)) 280) (<= (posn-y (mouse-click-posn click-mouse)) 340))) (string-copy! string-juego string-pos-ant "00") (string-copy! string-juego string-pos "qb") (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant "Imagenes/ReinaBlanco 60X60.png"  ) (close-viewport ventana-coronacion)]
          [else (coronacion (get-mouse-click ventana-coronacion) pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant string-pos-ant string-pos ficha ventana-coronacion turno)]
        ); fin cond
      ); fin begin true, coronana las blancas
  ; de lo contrario
      (begin #| coronana las negras |#
        (((draw-pixmap-posn "Imagenes/Coronacion 400x400.jpg") ventana-coronacion) (make-posn  0   0))
        (((draw-pixmap-posn "Imagenes/CaballoNegro 60X60.png") ventana-coronacion) (make-posn 40  40))
        (((draw-pixmap-posn "Imagenes/TorreNegro 60X60.png"  ) ventana-coronacion) (make-posn 40 120))
        (((draw-pixmap-posn "Imagenes/AlfilNegro 60X60.png"  ) ventana-coronacion) (make-posn 40 200))
        (((draw-pixmap-posn "Imagenes/ReinaNegro 60X60.png"  ) ventana-coronacion) (make-posn 40 280))
        (cond
          [(and (and (>= (posn-x (mouse-click-posn click-mouse))  40) (<= (posn-x (mouse-click-posn click-mouse)) 100)) (and (>= (posn-y (mouse-click-posn click-mouse))  40) (<= (posn-y (mouse-click-posn click-mouse)) 100))) (string-copy! string-juego string-pos-ant "00") (string-copy! string-juego string-pos "CN") (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant "Imagenes/CaballoNegro 60X60.png") (close-viewport ventana-coronacion)]
          [(and (and (>= (posn-x (mouse-click-posn click-mouse))  40) (<= (posn-x (mouse-click-posn click-mouse)) 100)) (and (>= (posn-y (mouse-click-posn click-mouse)) 120) (<= (posn-y (mouse-click-posn click-mouse)) 180))) (string-copy! string-juego string-pos-ant "00") (string-copy! string-juego string-pos "TN") (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant "Imagenes/TorreNegro 60X60.png"  ) (close-viewport ventana-coronacion)]
          [(and (and (>= (posn-x (mouse-click-posn click-mouse))  40) (<= (posn-x (mouse-click-posn click-mouse)) 100)) (and (>= (posn-y (mouse-click-posn click-mouse)) 200) (<= (posn-y (mouse-click-posn click-mouse)) 260))) (string-copy! string-juego string-pos-ant "00") (string-copy! string-juego string-pos "AN") (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant "Imagenes/AlfilNegro 60X60.png"  ) (close-viewport ventana-coronacion)]
          [(and (and (>= (posn-x (mouse-click-posn click-mouse))  40) (<= (posn-x (mouse-click-posn click-mouse)) 100)) (and (>= (posn-y (mouse-click-posn click-mouse)) 280) (<= (posn-y (mouse-click-posn click-mouse)) 340))) (string-copy! string-juego string-pos-ant "00") (string-copy! string-juego string-pos "QN") (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant "Imagenes/ReinaNegro 60X60.png"  ) (close-viewport ventana-coronacion)]
          [else (coronacion (get-mouse-click ventana-coronacion) pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant string-pos-ant string-pos ficha ventana-coronacion turno)]
        ); fin cond
      ); fin begin true, coronana las negras
  ); fin if, para saber quien corono
); fin definicion coronacion, funcion que cambia un peon coronado por otra ficha que se elije a gusto

;___________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
#| Definición De Laa Función Que Se Encargara De Ir Actualizando El Modo Grafico A Partir De La Informacion Que Le Llegue De Otras Funciones |#

#| Identificadores Locales A La Funcion (Actualizacion Grafica):
   - pixeles-x: almacena las coordenadas en x del cuadro del tablero a donde se desea mover.
   - pixeles-y: almacena las coordenadas en y del cuadro del tablero a donde se desea mover
   - pixeles-x-ant: almacena las coordenadas en x desde la que se quiere mover
   - pixeles-y-ant: almacena las coordenadas en y desde la que se quiere mover
   - direccion: guarda la dirección de la imagen que se quiere imprimir en la posicion que el usuario desea
; Definicion de la funcion actualizacion grafica para ir actualizando lo que el usuario ve en la partida. |#
(define (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
  (if (or (and (= pixeles-x-ant 80 ) (= pixeles-y-ant 80 )) (and (= pixeles-x-ant 240) (= pixeles-y-ant 80 )) (and (= pixeles-x-ant 400) (= pixeles-y-ant 80 )) (and (= pixeles-x-ant 560) (= pixeles-y-ant 80 )) #| FILA 1 |#
          (and (= pixeles-x-ant 160) (= pixeles-y-ant 160)) (and (= pixeles-x-ant 320) (= pixeles-y-ant 160)) (and (= pixeles-x-ant 480) (= pixeles-y-ant 160)) (and (= pixeles-x-ant 640) (= pixeles-y-ant 160)) #| FILA 2 |#
          (and (= pixeles-x-ant 80 ) (= pixeles-y-ant 240)) (and (= pixeles-x-ant 240) (= pixeles-y-ant 240)) (and (= pixeles-x-ant 400) (= pixeles-y-ant 240)) (and (= pixeles-x-ant 560) (= pixeles-y-ant 240)) #| FILA 3 |#
          (and (= pixeles-x-ant 160) (= pixeles-y-ant 320)) (and (= pixeles-x-ant 320) (= pixeles-y-ant 320)) (and (= pixeles-x-ant 480) (= pixeles-y-ant 320)) (and (= pixeles-x-ant 640) (= pixeles-y-ant 320)) #| FILA 4 |#
          (and (= pixeles-x-ant 80 ) (= pixeles-y-ant 400)) (and (= pixeles-x-ant 240) (= pixeles-y-ant 400)) (and (= pixeles-x-ant 400) (= pixeles-y-ant 400)) (and (= pixeles-x-ant 560) (= pixeles-y-ant 400)) #| FILA 5 |#
          (and (= pixeles-x-ant 160) (= pixeles-y-ant 480)) (and (= pixeles-x-ant 320) (= pixeles-y-ant 480)) (and (= pixeles-x-ant 480) (= pixeles-y-ant 480)) (and (= pixeles-x-ant 640) (= pixeles-y-ant 480)) #| FILA 6 |#
          (and (= pixeles-x-ant 80 ) (= pixeles-y-ant 560)) (and (= pixeles-x-ant 240) (= pixeles-y-ant 560)) (and (= pixeles-x-ant 400) (= pixeles-y-ant 560)) (and (= pixeles-x-ant 560) (= pixeles-y-ant 560)) #| FILA 7 |#
          (and (= pixeles-x-ant 160) (= pixeles-y-ant 640)) (and (= pixeles-x-ant 320) (= pixeles-y-ant 640)) (and (= pixeles-x-ant 480) (= pixeles-y-ant 640)) (and (= pixeles-x-ant 640) (= pixeles-y-ant 640)) #| FILA 8 |#
      )#| Fin condicion posicion de la ficha ubicada en un cuadro blanco |#
      (begin
        (((draw-pixmap-posn "Imagenes/CUADROBLANCO 80X80.jpg") juego-grafico) (make-posn pixeles-x-ant pixeles-y-ant))
        (if (or (and (= pixeles-x 80 ) (= pixeles-y 80 )) (and (= pixeles-x 240) (= pixeles-y 80 )) (and (= pixeles-x 400) (= pixeles-y 80 )) (and (= pixeles-x 560) (= pixeles-y 80 )) #| FILA 1 |#
                (and (= pixeles-x 160) (= pixeles-y 160)) (and (= pixeles-x 320) (= pixeles-y 160)) (and (= pixeles-x 480) (= pixeles-y 160)) (and (= pixeles-x 640) (= pixeles-y 160)) #| FILA 2 |#
                (and (= pixeles-x 80 ) (= pixeles-y 240)) (and (= pixeles-x 240) (= pixeles-y 240)) (and (= pixeles-x 400) (= pixeles-y 240)) (and (= pixeles-x 560) (= pixeles-y 240)) #| FILA 3 |#
                (and (= pixeles-x 160) (= pixeles-y 320)) (and (= pixeles-x 320) (= pixeles-y 320)) (and (= pixeles-x 480) (= pixeles-y 320)) (and (= pixeles-x 640) (= pixeles-y 320)) #| FILA 4 |#
                (and (= pixeles-x 80 ) (= pixeles-y 400)) (and (= pixeles-x 240) (= pixeles-y 400)) (and (= pixeles-x 400) (= pixeles-y 400)) (and (= pixeles-x 560) (= pixeles-y 400)) #| FILA 5 |#
                (and (= pixeles-x 160) (= pixeles-y 480)) (and (= pixeles-x 320) (= pixeles-y 480)) (and (= pixeles-x 480) (= pixeles-y 480)) (and (= pixeles-x 640) (= pixeles-y 480)) #| FILA 6 |#
                (and (= pixeles-x 80 ) (= pixeles-y 560)) (and (= pixeles-x 240) (= pixeles-y 560)) (and (= pixeles-x 400) (= pixeles-y 560)) (and (= pixeles-x 560) (= pixeles-y 560)) #| FILA 7 |#
                (and (= pixeles-x 160) (= pixeles-y 640)) (and (= pixeles-x 320) (= pixeles-y 640)) (and (= pixeles-x 480) (= pixeles-y 640)) (and (= pixeles-x 640) (= pixeles-y 640)) #| FILA 8 |#
            )#| Fin condicion posicion de la ficha ubicada en un cuadro blanco |#
            (begin
              (((draw-pixmap-posn "Imagenes/CUADROBLANCO 80X80.jpg") juego-grafico) (make-posn pixeles-x pixeles-y)) (((draw-pixmap-posn direccion) juego-grafico) (make-posn (+ pixeles-x 10) (+ pixeles-y 10)))
            ); fin begin true, es cuadro blanco
        ; de lo contrario
            (begin
              (((draw-pixmap-posn "Imagenes/CUADRONEGRO 80X80.jpg") juego-grafico) (make-posn pixeles-x pixeles-y)) (((draw-pixmap-posn direccion) juego-grafico) (make-posn (+ pixeles-x 10) (+ pixeles-y 10)))
            ); fin begin false, es cuadro negro
        ); fin if, ubicacion nueva en un cuadro blanco o negro
      ); fin begin true, ubicacion anterior en un cuadro blanco
  ; de lo contrario
      (begin
        (((draw-pixmap-posn "Imagenes/CUADRONEGRO 80X80.jpg") juego-grafico) (make-posn pixeles-x-ant pixeles-y-ant))
        (if (or (and (= pixeles-x 80 ) (= pixeles-y 80 )) (and (= pixeles-x 240) (= pixeles-y 80 )) (and (= pixeles-x 400) (= pixeles-y 80 )) (and (= pixeles-x 560) (= pixeles-y 80 )) #| FILA 1 |#
                (and (= pixeles-x 160) (= pixeles-y 160)) (and (= pixeles-x 320) (= pixeles-y 160)) (and (= pixeles-x 480) (= pixeles-y 160)) (and (= pixeles-x 640) (= pixeles-y 160)) #| FILA 2 |#
                (and (= pixeles-x 80 ) (= pixeles-y 240)) (and (= pixeles-x 240) (= pixeles-y 240)) (and (= pixeles-x 400) (= pixeles-y 240)) (and (= pixeles-x 560) (= pixeles-y 240)) #| FILA 3 |#
                (and (= pixeles-x 160) (= pixeles-y 320)) (and (= pixeles-x 320) (= pixeles-y 320)) (and (= pixeles-x 480) (= pixeles-y 320)) (and (= pixeles-x 640) (= pixeles-y 320)) #| FILA 4 |#
                (and (= pixeles-x 80 ) (= pixeles-y 400)) (and (= pixeles-x 240) (= pixeles-y 400)) (and (= pixeles-x 400) (= pixeles-y 400)) (and (= pixeles-x 560) (= pixeles-y 400)) #| FILA 5 |#
                (and (= pixeles-x 160) (= pixeles-y 480)) (and (= pixeles-x 320) (= pixeles-y 480)) (and (= pixeles-x 480) (= pixeles-y 480)) (and (= pixeles-x 640) (= pixeles-y 480)) #| FILA 6 |#
                (and (= pixeles-x 80 ) (= pixeles-y 560)) (and (= pixeles-x 240) (= pixeles-y 560)) (and (= pixeles-x 400) (= pixeles-y 560)) (and (= pixeles-x 560) (= pixeles-y 560)) #| FILA 7 |#
                (and (= pixeles-x 160) (= pixeles-y 640)) (and (= pixeles-x 320) (= pixeles-y 640)) (and (= pixeles-x 480) (= pixeles-y 640)) (and (= pixeles-x 640) (= pixeles-y 640)) #| FILA 8 |#
            )#| Fin condicion posicion de la ficha ubicada en un cuadro blanco |#
            (begin
              (((draw-pixmap-posn "Imagenes/CUADROBLANCO 80X80.jpg") juego-grafico) (make-posn pixeles-x pixeles-y)) (((draw-pixmap-posn direccion) juego-grafico) (make-posn (+ pixeles-x 10) (+ pixeles-y 10)))
            ); fin begin true, es cuadro blanco
        ; de lo contrario
            (begin
              (((draw-pixmap-posn "Imagenes/CUADRONEGRO 80X80.jpg") juego-grafico) (make-posn pixeles-x pixeles-y)) (((draw-pixmap-posn direccion) juego-grafico) (make-posn (+ pixeles-x 10) (+ pixeles-y 10)))
            ); fin begin false, es cuadro negro
        ); fin if, ubicacion nueva en un cuadro blanco o negro
      ); fin begin false, ubicacion anterior no esta en un cuadro blanco
  ); fin if, ubicacion anterior en un cuadro blanco o negro
); fin definicion, de la funcion actualizacion grafica que imprimira en la ventana de juego los cambios causados por la interaccion del usuario con el ajedrez

;___________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
#| Definición De Las Funciones Para El Movimiento De Las Fichas |#


; Inicio De La Definicion De Las Funciones Encargadas Del Movimiento De Los Peones
#| Identificadores Locales A La Funcion (Move Peon Blanco):
   - click-mouse: guarda la informacion acerca del ultimo olick dado
   - pixeles-x: almacena las coordenadas en x del primer cuadro del tablero, la cual va contando aumentando su valor hasta ser la del cuadro seleccionado
   - pixeles-y: almacena las coordenadas en y del primer cuadro del tablero, la cual va contando aumentando su valor hasta ser la del cuadro seleccionado
   - pixeles-x-ant: almacena las coordenadas en x donde se encuentra la ficha ya seleccionada
   - pixeles-y-ant: almacena las coordenadas en y donde se encuentra la ficha ya seleccionada
   - string-pos-ant: almacena la posicion númerica de la ficha en el string
   - string-pos: almacena un valor númerico con relacion en el string, el cual va contando hasta ser la posicion a la que se deasea llevar la ficha
   - ficha: almacena un substring que identifica la ficha especifica que se va a mover
   - direccion: guarda la dirección de la imagen que se quiere imprimir en la posicion que el usuario desea
; Definicion de la funcion para dar movimiento a los peones blancos. |#
(define (move-peon-blanco click-mouse pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant string-pos-ant string-pos ficha direccion)
  (if (and (and (>= (posn-x (mouse-click-posn click-mouse)) 80) (<= (posn-x (mouse-click-posn click-mouse)) 720)) (and (>= (posn-y (mouse-click-posn click-mouse)) 80) (<= (posn-y (mouse-click-posn click-mouse)) 720))) #| se asegura de que el click sea dentro del tablero |#
      (if (and (and (>= (posn-x (mouse-click-posn click-mouse)) pixeles-x) (<= (posn-x (mouse-click-posn click-mouse)) (+ pixeles-x 80))) (and (>= (posn-y (mouse-click-posn click-mouse)) pixeles-y) (<= (posn-y (mouse-click-posn click-mouse)) (+ pixeles-y 80))))
          (if (equal? (substring string-juego string-pos (+ string-pos 2)) "00")
              (cond #| condicional para mover pero sin comer ficha |#
                [(and (= pixeles-y-ant 560) (= (- string-pos-ant 32) string-pos) (equal? (substring string-juego string-pos (+ string-pos 2)) "00")) (string-copy! string-juego string-pos-ant "00")
                                                                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                                                                     (if (equal? (jaque 0 "rb") #t)
                                                                                                                                                         (begin
                                                                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                                                                         ); fin begin true, existe jaque
                                                                                                                                                     ; de lo contrario
                                                                                                                                                         (begin
                                                                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                                                                         ); fin begin false, dibuja en la ventana grafica
                                                                                                                                                     ); fin if, para saber si existe jaque
                ]; de lo contrario
                [(and (= (- string-pos-ant 16) string-pos) (equal? (substring string-juego string-pos (+ string-pos 2)) "00")) (string-copy! string-juego string-pos-ant "00")
                                                                                                                               (string-copy! string-juego string-pos ficha)
                                                                                                                               (if (equal? (jaque 0 "rb") #t)
                                                                                                                                   (begin
                                                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                                                   ); fin begin true, existe jaque
                                                                                                                               ; de lo contrario
                                                                                                                                   (begin
                                                                                                                                     (if (= pixeles-y 80 )
                                                                                                                                         (coronacion click-mouse pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant string-pos-ant string-pos ficha (open-viewport "ELIJA LA FICHA QUE DESEA" 400 400) 0)
                                                                                                                                     ; de lo contrario
                                                                                                                                         (begin
                                                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                                                         ); fin begin false, dibuja en la ventana grafica
                                                                                                                                     ); fin if para saber si hay coronacion
                                                                                                                                   ); fin begin false, no hay jaque
                                                                                                                               ); fin if, para saber si existe jaque                                               
                ]; de lo contrario imprime que es un movimiento no valido
                [else ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "red") (sleep 0.6) ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "white") (busqueda (get-mouse-click juego-grafico) 80 80 0 0)]
              ); fin cond
          ; de lo contrario
              #| condicional que se asegura que la ficha que se quiera comer no sea del mismo color |#
              (if (or (equal? (substring string-juego string-pos (+ string-pos 1)) "P") (equal? (substring string-juego string-pos (+ string-pos 1)) "T") (equal? (substring string-juego string-pos (+ string-pos 1)) "C") (equal? (substring string-juego string-pos (+ string-pos 1)) "A") (equal? (substring string-juego string-pos (+ string-pos 1)) "Q"))
                  (cond #| condicional para mover pero comiendo ficha |#
                    [(and (and (equal? #f (equal? string-pos-ant 16)) (equal? #f (equal? string-pos-ant 32)) (equal? #f (equal? string-pos-ant 48)) (equal? #f (equal? string-pos-ant 64)) (equal? #f (equal? string-pos-ant 80)) (equal? #f (equal? string-pos-ant 96))) (and (<= (- string-pos-ant 18) 126) (>= (- string-pos-ant 18) 0)) (= string-pos (- string-pos-ant 18)) (equal? #f (equal? (substring string-juego string-pos (+ string-pos 2)) "00"))) (string-copy! string-juego string-pos-ant "00")
                                                                                                                                                                                                                 (string-copy! string-juego string-pos ficha)
                                                                                                                                                                                                                 (if (equal? (jaque 0 "rb") #t)
                                                                                                                                                                                                                     (begin
                                                                                                                                                                                                                       ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                                                                                                                                       (string-copy! string-juego 0 string-juego-copy)
                                                                                                                                                                                                                     ); fin begin true, existe jaque
                                                                                                                                                                                                                 ; de lo contrario
                                                                                                                                                                                                                     (begin
                                                                                                                                                                                                                       (if (= pixeles-y 80 )
                                                                                                                                                                                                                           (coronacion click-mouse pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant string-pos-ant string-pos ficha (open-viewport "ELIJA LA FICHA QUE DESEA" 400 400) 0)
                                                                                                                                                                                                                       ; de lo contrario
                                                                                                                                                                                                                           (begin
                                                                                                                                                                                                                             (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                                                                                                                                           ); fin begin false, dibuja en la ventana grafica
                                                                                                                                                                                                                       ); fin if para saber si hay coronacion
                                                                                                                                                                                                                     ); fin begin false, no hay jaque
                                                                                                                                                                                                                 ); fin if, para saber si existe jaque
                                                                                                                                                                                                                 
                    ]; de lo contrario
                    [(and (and (equal? #f (equal? string-pos-ant 30)) (equal? #f (equal? string-pos-ant 46)) (equal? #f (equal? string-pos-ant 62)) (equal? #f (equal? string-pos-ant 78)) (equal? #f (equal? string-pos-ant 94)) (equal? #f (equal? string-pos-ant 110))) (and (<= (- string-pos-ant 14) 126) (>= (- string-pos-ant 14) 0)) (= string-pos (- string-pos-ant 14)) (equal? #f (equal? (substring string-juego string-pos (+ string-pos 2)) "00"))) (string-copy! string-juego string-pos-ant "00")
                                                                                                                                                                                                                 (string-copy! string-juego string-pos ficha)
                                                                                                                                                                                                                 (if (equal? (jaque 0 "rb") #t)
                                                                                                                                                                                                                     (begin
                                                                                                                                                                                                                       ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                                                                                                                                       (string-copy! string-juego 0 string-juego-copy)
                                                                                                                                                                                                                     ); fin begin true, existe jaque
                                                                                                                                                                                                                 ; de lo contrario
                                                                                                                                                                                                                     (begin
                                                                                                                                                                                                                       (if (= pixeles-y 80 )
                                                                                                                                                                                                                           (coronacion click-mouse pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant string-pos-ant string-pos ficha (open-viewport "ELIJA LA FICHA QUE DESEA" 400 400) 0)
                                                                                                                                                                                                                       ; de lo contrario
                                                                                                                                                                                                                           (begin
                                                                                                                                                                                                                             (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                                                                                                                                           ); fin begin false, dibuja en la ventana grafica
                                                                                                                                                                                                                       ); fin if para saber si hay coronacion
                                                                                                                                                                                                                     ); fin begin false, no hay jaque
                                                                                                                                                                                                                 ); fin if, para saber si existe jaque
                   ]; de lo contrario
                    [else ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "red") (sleep 0.6) ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "white")(busqueda (get-mouse-click juego-grafico) 80 80 0 0)]
                  ); fin cond
              ; de lo contrario
                  (begin
                    ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "red") (sleep 0.6) ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "white")
                    (busqueda (get-mouse-click juego-grafico) 80 80 0 0)
                  ); fin begin false, movimiento no valido
              ); fin if, para saber si es un movimiento valido
          ); fin if, para saber si el peon va a comer ficha
      ; de lo contrario
          (move-peon-blanco click-mouse (if (= pixeles-x 640) 80 (+ pixeles-x 80)) (if (= pixeles-x 640) (+ pixeles-y 80) pixeles-y) pixeles-x-ant pixeles-y-ant string-pos-ant (+ string-pos 2) ficha direccion)
      ); fin if, para saber donde se dio click
  ; de lo contrario
      (if (and (and (>= (posn-x (mouse-click-posn click-mouse)) 85 ) (<= (posn-x (mouse-click-posn click-mouse)) 195)) (and (>= (posn-y (mouse-click-posn click-mouse)) 740) (<= (posn-y (mouse-click-posn click-mouse)) 758)))
          (begin
            ((draw-string juego-grafico) (make-posn 840 430) "JUEGO TERMINADO" "black")
            (string-set! string-juego-copy 127 #\-) (string-set! string-juego 127 #\-)
          ); fin begin true, se dio click en el boton de terminar
      ; de lo contrario
         (begin
           ((draw-string juego-grafico) (make-posn 840 430) "CLICK NO VALIDO" "red") (sleep 0.6) ((draw-string juego-grafico) (make-posn 840 430) "CLICK NO VALIDO" "white")
           (busqueda (get-mouse-click juego-grafico) 80 80 0 0)
         ); fin begin false, click no valido
     ); fin if, termino el juego
  ); fin if, principal
); fin definicion, movimiento del peon blanco

#| Identificadores Locales A La Funcion (Move Peon Negro):
   - click-mouse: guarda la informacion acerca del ultimo olick dado
   - pixeles-x: almacena las coordenadas en x del primer cuadro del tablero, la cual va contando aumentando su valor hasta ser la del cuadro seleccionado
   - pixeles-y: almacena las coordenadas en y del primer cuadro del tablero, la cual va contando aumentando su valor hasta ser la del cuadro seleccionado
   - pixeles-x-ant: almacena las coordenadas en x donde se encuentra la ficha ya seleccionada
   - pixeles-y-ant: almacena las coordenadas en y donde se encuentra la ficha ya seleccionada
   - string-pos-ant: almacena la posicion númerica de la ficha en el string
   - string-pos: almacena un valor númerico con relacion en el string, el cual va contando hasta ser la posicion a la que se deasea llevar la ficha
   - ficha: almacena un substring que identifica la ficha especifica que se va a mover
   - direccion: guarda la dirección de la imagen que se quiere imprimir en la posicion que el usuario desea
; Definicion de la funcion para dar movimiento a los peones negros. |#
(define (move-peon-negro click-mouse pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant string-pos-ant string-pos ficha direccion)
  (if (and (and (>= (posn-x (mouse-click-posn click-mouse)) 80) (<= (posn-x (mouse-click-posn click-mouse)) 720)) (and (>= (posn-y (mouse-click-posn click-mouse)) 80) (<= (posn-y (mouse-click-posn click-mouse)) 720))) #| se asegura de que el click sea dentro del tablero |#
      (if (and (and (>= (posn-x (mouse-click-posn click-mouse)) pixeles-x) (<= (posn-x (mouse-click-posn click-mouse)) (+ pixeles-x 80))) (and (>= (posn-y (mouse-click-posn click-mouse)) pixeles-y) (<= (posn-y (mouse-click-posn click-mouse)) (+ pixeles-y 80))))
          (if (equal? (substring string-juego string-pos (+ string-pos 2)) "00")
              (cond #| condicional para mover pero sin comer ficha |#
                [(and (= pixeles-y-ant 160) (= (+ string-pos-ant 32) string-pos) (equal? (substring string-juego string-pos (+ string-pos 2)) "00")) (string-copy! string-juego string-pos-ant "00")
                                                                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                                                                     (if (equal? (jaque 0 "RN") #t)
                                                                                                                                                         (begin
                                                                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                                                                         ); fin begin true, existe jaque
                                                                                                                                                     ; de lo contrario
                                                                                                                                                         (begin
                                                                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                                                                         ); fin begin false, dibuja en la ventana grafica
                                                                                                                                                     ); fin if, para saber si existe jaque
                ]; de lo contrario
                [(and (= (+ string-pos-ant 16) string-pos) (equal? (substring string-juego string-pos (+ string-pos 2)) "00")) (string-copy! string-juego string-pos-ant "00")
                                                                                                                               (string-copy! string-juego string-pos ficha)
                                                                                                                               (if (equal? (jaque 0 "RN") #t)
                                                                                                                                   (begin
                                                                                                                                     ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                                                     (string-copy! string-juego 0 string-juego-copy)
                                                                                                                                   ); fin begin true, existe jaque
                                                                                                                               ; de lo contrario
                                                                                                                                   (begin
                                                                                                                                     (if (= pixeles-y 640)
                                                                                                                                         (coronacion click-mouse pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant string-pos-ant string-pos ficha (open-viewport "ELIJA LA FICHA QUE DESEA" 400 400) 1)
                                                                                                                                     ; de lo contrario
                                                                                                                                         (begin
                                                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                                                         ); fin begin false, dibuja en la ventana grafica
                                                                                                                                     ); fin if para saber si hay coronacion
                                                                                                                                   ); fin begin false, no hay jaque
                                                                                                                               ); fin if, para saber si hay jaque                                                                      
                ]; de lo contrario imprime que es un movimiento no valido
                [else ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "red") (sleep 0.6) ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "white") (busqueda (get-mouse-click juego-grafico) 80 80 0 1)]
              ); fin cond
          ; de lo contrario
              #| condicional que se asegura que la ficha que se quiera comer no sea del mismo color |#
              (if (or (equal? (substring string-juego string-pos (+ string-pos 1)) "p") (equal? (substring string-juego string-pos (+ string-pos 1)) "t") (equal? (substring string-juego string-pos (+ string-pos 1)) "c") (equal? (substring string-juego string-pos (+ string-pos 1)) "a") (equal? (substring string-juego string-pos (+ string-pos 1)) "q"))
                  (cond #| condicional para mover pero comiendo ficha |#
                    [(and (and (equal? #f (equal? string-pos-ant 30)) (equal? #f (equal? string-pos-ant 46)) (equal? #f (equal? string-pos-ant 62)) (equal? #f (equal? string-pos-ant 78)) (equal? #f (equal? string-pos-ant 94)) (equal? #f (equal? string-pos-ant 110))) (and (<= (+ string-pos-ant 18) 126) (>= (+ string-pos-ant 18) 0)) (= string-pos (+ string-pos-ant 18)) (equal? #f (equal? (substring string-juego string-pos (+ string-pos 2)) "00"))) (string-copy! string-juego string-pos-ant "00")
                                                                                                                                                                                                                 (string-copy! string-juego string-pos ficha)
                                                                                                                                                                                                                 (if (equal? (jaque 0 "RN") #t)
                                                                                                                                                                                                                     (begin
                                                                                                                                                                                                                       ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                                                                                                                                       (string-copy! string-juego 0 string-juego-copy)
                                                                                                                                                                                                                     ); fin begin true, existe jaque
                                                                                                                                                                                                                 ; de lo contrario
                                                                                                                                                                                                                     (begin
                                                                                                                                                                                                                       (if (= pixeles-y 640)
                                                                                                                                                                                                                           (coronacion click-mouse pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant string-pos-ant string-pos ficha (open-viewport "ELIJA LA FICHA QUE DESEA" 400 400) 1)
                                                                                                                                                                                                                       ; de lo contrario
                                                                                                                                                                                                                           (begin
                                                                                                                                                                                                                             (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                                                                                                                                           ); fin begin false, dibuja en la ventana grafica
                                                                                                                                                                                                                       ); fin if para saber si hay coronacion
                                                                                                                                                                                                                     ); fin begin falee, no hay jaque
                                                                                                                                                                                                                 ); fin if, para saber si hay jaque   
                                                                                                                                                                                                                 
                    ]; de lo contrario
                    [(and (and (equal? #f (equal? string-pos-ant 16)) (equal? #f (equal? string-pos-ant 32)) (equal? #f (equal? string-pos-ant 48)) (equal? #f (equal? string-pos-ant 64)) (equal? #f (equal? string-pos-ant 80)) (equal? #f (equal? string-pos-ant 96))) (and (<= (+ string-pos-ant 14) 126) (>= (+ string-pos-ant 14) 0)) (= string-pos (+ string-pos-ant 14)) (equal? #f (equal? (substring string-juego string-pos (+ string-pos 2)) "00"))) (string-copy! string-juego string-pos-ant "00")
                                                                                                                                                                                                                 (string-copy! string-juego string-pos ficha)
                                                                                                                                                                                                                 (if (equal? (jaque 0 "RN") #t)
                                                                                                                                                                                                                     (begin
                                                                                                                                                                                                                       ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                                                                                                                                       (string-copy! string-juego 0 string-juego-copy)
                                                                                                                                                                                                                     ); fin begin true, existe jaque
                                                                                                                                                                                                                 ; de lo contrario
                                                                                                                                                                                                                     (begin
                                                                                                                                                                                                                       (if (= pixeles-y 640)
                                                                                                                                                                                                                           (coronacion click-mouse pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant string-pos-ant string-pos ficha (open-viewport "ELIJA LA FICHA QUE DESEA" 400 400) 1)
                                                                                                                                                                                                                       ; de lo contrario
                                                                                                                                                                                                                           (begin
                                                                                                                                                                                                                             (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                                                                                                                                           ); fin begin false, dibuja en la ventana grafica
                                                                                                                                                                                                                       ); fin if para saber si hay coronacion
                                                                                                                                                                                                                     ); fin begin falee, no hay jaque
                                                                                                                                                                                                                 ); fin if, para saber si hay jaque  
                   ]; de lo contrario
                    [else ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "red") (sleep 0.6) ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "white")(busqueda (get-mouse-click juego-grafico) 80 80 0 1)]
                  ); fin cond
              ; de lo contrario
                  (begin
                    ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "red") (sleep 0.6) ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "white")
                    (busqueda (get-mouse-click juego-grafico) 80 80 0 1)
                  ); fin begin false
              ); fin if, para saber si es un movimiento valido
          ); fin if, para saber si el peon va a comer ficha
      ; de lo contrario
          (move-peon-negro click-mouse (if (= pixeles-x 640) 80 (+ pixeles-x 80)) (if (= pixeles-x 640) (+ pixeles-y 80) pixeles-y) pixeles-x-ant pixeles-y-ant string-pos-ant (+ string-pos 2) ficha direccion)
      ); fin if, para saber donde se dio click
  ; de lo contrario
      (if (and (and (>= (posn-x (mouse-click-posn click-mouse)) 85 ) (<= (posn-x (mouse-click-posn click-mouse)) 195)) (and (>= (posn-y (mouse-click-posn click-mouse)) 740) (<= (posn-y (mouse-click-posn click-mouse)) 758)))
          (begin
            ((draw-string juego-grafico) (make-posn 840 430) "JUEGO TERMINADO" "black")
            (string-set! string-juego-copy 127 #\-) (string-set! string-juego 127 #\-)
          ); fin begin true, se dio click en el boton de terminar
      ; de lo contrario
         (begin
           ((draw-string juego-grafico) (make-posn 840 430) "CLICK NO VALIDO" "red") (sleep 0.6) ((draw-string juego-grafico) (make-posn 840 430) "CLICK NO VALIDO" "white")
           (busqueda (get-mouse-click juego-grafico) 80 80 0 1)
         ); fin begin false, click no valido
     ); fin if, termino el juego
  ); fin if, principal
); fin definicion, movimiento del peon negro
; Fin De La Definciion DE Las Funciones Encargadas Del Movimiento De Los Peones


; Inicio De La Definicion De Las Funciones Encargadas Del Movimiento De Las Torres.
#| Identificadores Locales A La Funcion (Move Torre Blanco):
   - click-mouse: guarda la informacion acerca del ultimo olick dado
   - pixeles-x: almacena las coordenadas en x del primer cuadro del tablero, la cual va contando aumentando su valor hasta ser la del cuadro seleccionado
   - pixeles-y: almacena las coordenadas en y del primer cuadro del tablero, la cual va contando aumentando su valor hasta ser la del cuadro seleccionado
   - pixeles-x-ant: almacena las coordenadas en x donde se encuentra la ficha ya seleccionada
   - pixeles-y-ant: almacena las coordenadas en y donde se encuentra la ficha ya seleccionada
   - string-pos-ant: almacena la posicion númerica de la ficha en el string
   - string-pos: almacena un valor númerico con relacion en el string, el cual va contando hasta ser la posicion a la que se deasea llevar la ficha
   - ficha: almacena un substring que identifica la ficha especifica que se va a mover
   - direccion: guarda la dirección de la imagen que se quiere imprimir en la posicion que el usuario desea
; Definicion de la funcion para dar movimiento a las torres blancas. |#
(define (move-torre-blanco click-mouse pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant string-pos-ant string-pos ficha direccion)
  (if (and (and (>= (posn-x (mouse-click-posn click-mouse)) 80) (<= (posn-x (mouse-click-posn click-mouse)) 720)) (and (>= (posn-y (mouse-click-posn click-mouse)) 80) (<= (posn-y (mouse-click-posn click-mouse)) 720))) #| se asegura de que el click sea dentro del tablero |#
      (if (and (and (>= (posn-x (mouse-click-posn click-mouse)) pixeles-x) (<= (posn-x (mouse-click-posn click-mouse)) (+ pixeles-x 80))) (and (>= (posn-y (mouse-click-posn click-mouse)) pixeles-y) (<= (posn-y (mouse-click-posn click-mouse)) (+ pixeles-y 80))))
          (if (or (equal? (substring string-juego string-pos (+ string-pos 1)) "0") (equal? (substring string-juego string-pos (+ string-pos 1)) "P") (equal? (substring string-juego string-pos (+ string-pos 1)) "T") (equal? (substring string-juego string-pos (+ string-pos 1)) "C")  (equal? (substring string-juego string-pos (+ string-pos 1)) "A") (equal? (substring string-juego string-pos (+ string-pos 1)) "Q"))
              (cond #| condicionales en el siguiente orden: mover arriba, mover abajo, mover a la derecha o mover a la izquierda |#
                 ; busca el segundo click arriba 
                [(>= (- string-pos-ant 16) string-pos) (cond
                                                         [(= string-pos (- string-pos-ant 16 ))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "rb") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (- string-pos-ant 32 )) (equal? (substring string-juego (- string-pos-ant 16) (- string-pos-ant 14)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "rb") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (- string-pos-ant 48 )) (equal? (substring string-juego (- string-pos-ant 16) (- string-pos-ant 14)) "00") (equal? (substring string-juego (- string-pos-ant 32) (- string-pos-ant 30)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "rb") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (- string-pos-ant 64 )) (equal? (substring string-juego (- string-pos-ant 16) (- string-pos-ant 14)) "00") (equal? (substring string-juego (- string-pos-ant 32) (- string-pos-ant 30)) "00") (equal? (substring string-juego (- string-pos-ant 48) (- string-pos-ant 46)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "rb") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (- string-pos-ant 80 )) (equal? (substring string-juego (- string-pos-ant 16) (- string-pos-ant 14)) "00") (equal? (substring string-juego (- string-pos-ant 32) (- string-pos-ant 30)) "00") (equal? (substring string-juego (- string-pos-ant 48) (- string-pos-ant 46)) "00") (equal? (substring string-juego (- string-pos-ant 64) (- string-pos-ant 62)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "rb") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (- string-pos-ant 96 )) (equal? (substring string-juego (- string-pos-ant 16) (- string-pos-ant 14)) "00") (equal? (substring string-juego (- string-pos-ant 32) (- string-pos-ant 30)) "00") (equal? (substring string-juego (- string-pos-ant 48) (- string-pos-ant 46)) "00") (equal? (substring string-juego (- string-pos-ant 64) (- string-pos-ant 62)) "00") (equal? (substring string-juego (- string-pos-ant 80) (- string-pos-ant 78)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "rb") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (- string-pos-ant 112)) (equal? (substring string-juego (- string-pos-ant 16) (- string-pos-ant 14)) "00") (equal? (substring string-juego (- string-pos-ant 32) (- string-pos-ant 30)) "00") (equal? (substring string-juego (- string-pos-ant 48) (- string-pos-ant 46)) "00") (equal? (substring string-juego (- string-pos-ant 64) (- string-pos-ant 62)) "00") (equal? (substring string-juego (- string-pos-ant 80) (- string-pos-ant 78)) "00") (equal? (substring string-juego (- string-pos-ant 96) (- string-pos-ant 94)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "rb") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [else ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "red") (sleep 0.6) ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "white") (busqueda (get-mouse-click juego-grafico) 80 80 0 0)]
                                                       ); fin cond
                ]; de lo contrario busca el segundo click abajo
                [(<= (+ string-pos-ant 16) string-pos) (cond
                                                         [(= string-pos (+ string-pos-ant 16 ))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "rb") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (+ string-pos-ant 32 )) (equal? (substring string-juego (+ string-pos-ant 16) (+ string-pos-ant 18)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "rb") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (+ string-pos-ant 48 )) (equal? (substring string-juego (+ string-pos-ant 16) (+ string-pos-ant 18)) "00") (equal? (substring string-juego (+ string-pos-ant 32) (+ string-pos-ant 34)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "rb") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (+ string-pos-ant 64 )) (equal? (substring string-juego (+ string-pos-ant 16) (+ string-pos-ant 18)) "00") (equal? (substring string-juego (+ string-pos-ant 32) (+ string-pos-ant 34)) "00") (equal? (substring string-juego (+ string-pos-ant 48) (+ string-pos-ant 50)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "rb") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (+ string-pos-ant 80 )) (equal? (substring string-juego (+ string-pos-ant 16) (+ string-pos-ant 18)) "00") (equal? (substring string-juego (+ string-pos-ant 32) (+ string-pos-ant 34)) "00") (equal? (substring string-juego (+ string-pos-ant 48) (+ string-pos-ant 50)) "00") (equal? (substring string-juego (+ string-pos-ant 64) (+ string-pos-ant 66)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "rb") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (+ string-pos-ant 96 )) (equal? (substring string-juego (+ string-pos-ant 16) (+ string-pos-ant 18)) "00") (equal? (substring string-juego (+ string-pos-ant 32) (+ string-pos-ant 34)) "00") (equal? (substring string-juego (+ string-pos-ant 48) (+ string-pos-ant 50)) "00") (equal? (substring string-juego (+ string-pos-ant 64) (+ string-pos-ant 66)) "00") (equal? (substring string-juego (+ string-pos-ant 80) (+ string-pos-ant 82)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "rb") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (+ string-pos-ant 112)) (equal? (substring string-juego (+ string-pos-ant 16) (+ string-pos-ant 18)) "00") (equal? (substring string-juego (+ string-pos-ant 32) (+ string-pos-ant 34)) "00") (equal? (substring string-juego (+ string-pos-ant 48) (+ string-pos-ant 50)) "00") (equal? (substring string-juego (+ string-pos-ant 64) (+ string-pos-ant 66)) "00") (equal? (substring string-juego (+ string-pos-ant 80) (+ string-pos-ant 82)) "00") (equal? (substring string-juego (+ string-pos-ant 96) (+ string-pos-ant 98)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "rb") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [else ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "red") (sleep 0.6) ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "white") (busqueda (get-mouse-click juego-grafico) 80 80 0 0)]
                                                       ); fin cond
                ]; de lo contrario busca el segundo click a la derecha
                [(and (<= string-pos-ant string-pos) (= (quotient string-pos-ant 16) (quotient string-pos 16)))
                                                (cond
                                                  [(= string-pos (+ string-pos-ant 2 ))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "rb") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (+ string-pos-ant 4 )) (equal? (substring string-juego (+ string-pos-ant 2) (+ string-pos-ant 4)) "00"))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "rb") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (+ string-pos-ant 6 )) (equal? (substring string-juego (+ string-pos-ant 2) (+ string-pos-ant 4)) "00") (equal? (substring string-juego (+ string-pos-ant 4) (+ string-pos-ant 6)) "00"))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "rb") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (+ string-pos-ant 8 )) (equal? (substring string-juego (+ string-pos-ant 2) (+ string-pos-ant 4)) "00") (equal? (substring string-juego (+ string-pos-ant 4) (+ string-pos-ant 6)) "00") (equal? (substring string-juego (+ string-pos-ant 6) (+ string-pos-ant 8)) "00"))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "rb") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (+ string-pos-ant 10 )) (equal? (substring string-juego (+ string-pos-ant 2) (+ string-pos-ant 4)) "00") (equal? (substring string-juego (+ string-pos-ant 4) (+ string-pos-ant 6)) "00") (equal? (substring string-juego (+ string-pos-ant 6) (+ string-pos-ant 8)) "00") (equal? (substring string-juego (+ string-pos-ant 8) (+ string-pos-ant 10)) "00"))
                                                                                              (string-copy! string-juego string-pos-ant "00")
                                                                                              (string-copy! string-juego string-pos ficha)
                                                                                              (if (equal? (jaque 0 "rb") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (+ string-pos-ant 12 )) (equal? (substring string-juego (+ string-pos-ant 2) (+ string-pos-ant 4)) "00") (equal? (substring string-juego (+ string-pos-ant 4) (+ string-pos-ant 6)) "00") (equal? (substring string-juego (+ string-pos-ant 6) (+ string-pos-ant 8)) "00") (equal? (substring string-juego (+ string-pos-ant 8) (+ string-pos-ant 10)) "00") (equal? (substring string-juego (+ string-pos-ant 10) (+ string-pos-ant 12)) "00"))
                                                                                              (string-copy! string-juego string-pos-ant "00")
                                                                                              (string-copy! string-juego string-pos ficha)
                                                                                              (if (equal? (jaque 0 "rb") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (+ string-pos-ant 14 )) (equal? (substring string-juego (+ string-pos-ant 2) (+ string-pos-ant 4)) "00") (equal? (substring string-juego (+ string-pos-ant 4) (+ string-pos-ant 6)) "00") (equal? (substring string-juego (+ string-pos-ant 6) (+ string-pos-ant 8)) "00") (equal? (substring string-juego (+ string-pos-ant 8) (+ string-pos-ant 10)) "00") (equal? (substring string-juego (+ string-pos-ant 10) (+ string-pos-ant 12)) "00") (equal? (substring string-juego (+ string-pos-ant 12) (+ string-pos-ant 14)) "00"))
                                                                                              (string-copy! string-juego string-pos-ant "00")
                                                                                              (string-copy! string-juego string-pos ficha)
                                                                                              (if (equal? (jaque 0 "rb") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [else ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "red") (sleep 0.6) ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "white") (busqueda (get-mouse-click juego-grafico) 80 80 0 0)]
                                                ); fin cond
                ]; de lo contrario busca el segundo click a la izquierda
                [(and (>= string-pos-ant string-pos) (= (quotient string-pos-ant 16) (quotient string-pos 16)))
                                                (cond
                                                  [(= string-pos (- string-pos-ant 2 ))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "rb") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (- string-pos-ant 4 )) (equal? (substring string-juego (- string-pos-ant 2) (- string-pos-ant 0)) "00"))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "rb") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (- string-pos-ant 6 )) (equal? (substring string-juego (- string-pos-ant 2) (- string-pos-ant 0)) "00") (equal? (substring string-juego (- string-pos-ant 4) (- string-pos-ant 2)) "00"))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "rb") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (- string-pos-ant 8 )) (equal? (substring string-juego (- string-pos-ant 2) (- string-pos-ant 0)) "00") (equal? (substring string-juego (- string-pos-ant 4) (- string-pos-ant 2)) "00") (equal? (substring string-juego (- string-pos-ant 6) (- string-pos-ant 4)) "00"))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "rb") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (- string-pos-ant 10)) (equal? (substring string-juego (- string-pos-ant 2) (- string-pos-ant 0)) "00") (equal? (substring string-juego (- string-pos-ant 4) (- string-pos-ant 2)) "00") (equal? (substring string-juego (- string-pos-ant 6) (- string-pos-ant 4)) "00") (equal? (substring string-juego (- string-pos-ant 8) (- string-pos-ant 6)) "00"))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "rb") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (- string-pos-ant 12)) (equal? (substring string-juego (- string-pos-ant 2) (- string-pos-ant 0)) "00") (equal? (substring string-juego (- string-pos-ant 4) (- string-pos-ant 2)) "00") (equal? (substring string-juego (- string-pos-ant 6) (- string-pos-ant 4)) "00") (equal? (substring string-juego (- string-pos-ant 8) (- string-pos-ant 6)) "00") (equal? (substring string-juego (- string-pos-ant 10) (- string-pos-ant 8)) "00"))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "rb") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (- string-pos-ant 14)) (equal? (substring string-juego (- string-pos-ant 2) (- string-pos-ant 0)) "00") (equal? (substring string-juego (- string-pos-ant 4) (- string-pos-ant 2)) "00") (equal? (substring string-juego (- string-pos-ant 6) (- string-pos-ant 4)) "00") (equal? (substring string-juego (- string-pos-ant 8) (- string-pos-ant 6)) "00") (equal? (substring string-juego (- string-pos-ant 10) (- string-pos-ant 8)) "00") (equal? (substring string-juego (- string-pos-ant 12) (- string-pos-ant 10)) "00"))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "rb") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [else ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "red") (sleep 0.6) ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "white") (busqueda (get-mouse-click juego-grafico) 80 80 0 0)]
                                                ); fin cond
                ]; de lo contrario imprime que es un movimiento no valido
                [else ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "red") (sleep 0.6) ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "white") (busqueda (get-mouse-click juego-grafico) 80 80 0 0)]
              ); fin cond
          ; de lo contrario
             (begin
               ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "white")
               (busqueda (get-mouse-click juego-grafico) 80 80 0 0)
             ); fin begin false
          ); fin if, para saber si es un movimiento no valido
      ; de lo contrario
          (move-torre-blanco click-mouse (if (= pixeles-x 640) 80 (+ pixeles-x 80)) (if (= pixeles-x 640) (+ pixeles-y 80) pixeles-y) pixeles-x-ant pixeles-y-ant string-pos-ant (+ string-pos 2) ficha direccion)
      ); fin if, para saber donde se dio click
  ; de lo contrario
      (if (and (and (>= (posn-x (mouse-click-posn click-mouse)) 85 ) (<= (posn-x (mouse-click-posn click-mouse)) 195)) (and (>= (posn-y (mouse-click-posn click-mouse)) 740) (<= (posn-y (mouse-click-posn click-mouse)) 758)))
          (begin
            ((draw-string juego-grafico) (make-posn 840 430) "JUEGO TERMINADO" "black")
            (string-set! string-juego-copy 127 #\-) (string-set! string-juego 127 #\-)
          ); fin begin true, se dio click en el boton de terminar
      ; de lo contrario
         (begin
           ((draw-string juego-grafico) (make-posn 840 430) "CLICK NO VALIDO" "red") (sleep 0.6) ((draw-string juego-grafico) (make-posn 840 430) "CLICK NO VALIDO" "white")
           (busqueda (get-mouse-click juego-grafico) 80 80 0 0)
         ); fin begin false, click no valido
     ); fin if, termino el juego
  ); fin if, principal
); fin definicion, movimiento de la torre blanca

#| Identificadores Locales A La Funcion (Move Torre Negro):
   - click-mouse: guarda la informacion acerca del ultimo olick dado
   - pixeles-x: almacena las coordenadas en x del primer cuadro del tablero, la cual va contando aumentando su valor hasta ser la del cuadro seleccionado
   - pixeles-y: almacena las coordenadas en y del primer cuadro del tablero, la cual va contando aumentando su valor hasta ser la del cuadro seleccionado
   - pixeles-x-ant: almacena las coordenadas en x donde se encuentra la ficha ya seleccionada
   - pixeles-y-ant: almacena las coordenadas en y donde se encuentra la ficha ya seleccionada
   - string-pos-ant: almacena la posicion númerica de la ficha en el string
   - string-pos: almacena un valor númerico con relacion en el string, el cual va contando hasta ser la posicion a la que se deasea llevar la ficha
   - ficha: almacena un substring que identifica la ficha especifica que se va a mover
   - direccion: guarda la dirección de la imagen que se quiere imprimir en la posicion que el usuario desea
; Definicion de la funcion para dar movimiento a las torres negras. |#
(define (move-torre-negro click-mouse pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant string-pos-ant string-pos ficha direccion)
  (if (and (and (>= (posn-x (mouse-click-posn click-mouse)) 80) (<= (posn-x (mouse-click-posn click-mouse)) 720)) (and (>= (posn-y (mouse-click-posn click-mouse)) 80) (<= (posn-y (mouse-click-posn click-mouse)) 720))) #| se asegura de que el click sea dentro del tablero |#
      (if (and (and (>= (posn-x (mouse-click-posn click-mouse)) pixeles-x) (<= (posn-x (mouse-click-posn click-mouse)) (+ pixeles-x 80))) (and (>= (posn-y (mouse-click-posn click-mouse)) pixeles-y) (<= (posn-y (mouse-click-posn click-mouse)) (+ pixeles-y 80))))
          (if (or (equal? (substring string-juego string-pos (+ string-pos 1)) "0") (equal? (substring string-juego string-pos (+ string-pos 1)) "p") (equal? (substring string-juego string-pos (+ string-pos 1)) "t") (equal? (substring string-juego string-pos (+ string-pos 1)) "c")  (equal? (substring string-juego string-pos (+ string-pos 1)) "a") (equal? (substring string-juego string-pos (+ string-pos 1)) "q"))
              (cond #| condicionales en el siguiente orden: mover arriba, mover abajo, mover a la derecha o mover a la izquierda |#
                 ; busca el segundo click arriba 
                [(>= (- string-pos-ant 16) string-pos) (cond
                                                         [(= string-pos (- string-pos-ant 16 ))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "RN") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (- string-pos-ant 32 )) (equal? (substring string-juego (- string-pos-ant 16) (- string-pos-ant 14)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "RN") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (- string-pos-ant 48 )) (equal? (substring string-juego (- string-pos-ant 16) (- string-pos-ant 14)) "00") (equal? (substring string-juego (- string-pos-ant 32) (- string-pos-ant 30)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "RN") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (- string-pos-ant 64 )) (equal? (substring string-juego (- string-pos-ant 16) (- string-pos-ant 14)) "00") (equal? (substring string-juego (- string-pos-ant 32) (- string-pos-ant 30)) "00") (equal? (substring string-juego (- string-pos-ant 48) (- string-pos-ant 46)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "RN") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (- string-pos-ant 80 )) (equal? (substring string-juego (- string-pos-ant 16) (- string-pos-ant 14)) "00") (equal? (substring string-juego (- string-pos-ant 32) (- string-pos-ant 30)) "00") (equal? (substring string-juego (- string-pos-ant 48) (- string-pos-ant 46)) "00") (equal? (substring string-juego (- string-pos-ant 64) (- string-pos-ant 62)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "RN") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (- string-pos-ant 96 )) (equal? (substring string-juego (- string-pos-ant 16) (- string-pos-ant 14)) "00") (equal? (substring string-juego (- string-pos-ant 32) (- string-pos-ant 30)) "00") (equal? (substring string-juego (- string-pos-ant 48) (- string-pos-ant 46)) "00") (equal? (substring string-juego (- string-pos-ant 64) (- string-pos-ant 62)) "00") (equal? (substring string-juego (- string-pos-ant 80) (- string-pos-ant 78)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "RN") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (- string-pos-ant 112)) (equal? (substring string-juego (- string-pos-ant 16) (- string-pos-ant 14)) "00") (equal? (substring string-juego (- string-pos-ant 32) (- string-pos-ant 30)) "00") (equal? (substring string-juego (- string-pos-ant 48) (- string-pos-ant 46)) "00") (equal? (substring string-juego (- string-pos-ant 64) (- string-pos-ant 62)) "00") (equal? (substring string-juego (- string-pos-ant 80) (- string-pos-ant 78)) "00") (equal? (substring string-juego (- string-pos-ant 96) (- string-pos-ant 94)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "RN") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [else ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "red") (sleep 0.6) ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "white") (busqueda (get-mouse-click juego-grafico) 80 80 0 1)]
                                                       ); fin cond
                ]; de lo contrario busca el segundo click abajo
                [(<= (+ string-pos-ant 16) string-pos) (cond
                                                         [(= string-pos (+ string-pos-ant 16 ))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "RN") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (+ string-pos-ant 32 )) (equal? (substring string-juego (+ string-pos-ant 16) (+ string-pos-ant 18)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "RN") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (+ string-pos-ant 48 )) (equal? (substring string-juego (+ string-pos-ant 16) (+ string-pos-ant 18)) "00") (equal? (substring string-juego (+ string-pos-ant 32) (+ string-pos-ant 34)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "RN") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (+ string-pos-ant 64 )) (equal? (substring string-juego (+ string-pos-ant 16) (+ string-pos-ant 18)) "00") (equal? (substring string-juego (+ string-pos-ant 32) (+ string-pos-ant 34)) "00") (equal? (substring string-juego (+ string-pos-ant 48) (+ string-pos-ant 50)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "RN") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (+ string-pos-ant 80 )) (equal? (substring string-juego (+ string-pos-ant 16) (+ string-pos-ant 18)) "00") (equal? (substring string-juego (+ string-pos-ant 32) (+ string-pos-ant 34)) "00") (equal? (substring string-juego (+ string-pos-ant 48) (+ string-pos-ant 50)) "00") (equal? (substring string-juego (+ string-pos-ant 64) (+ string-pos-ant 66)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "RN") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (+ string-pos-ant 96 )) (equal? (substring string-juego (+ string-pos-ant 16) (+ string-pos-ant 18)) "00") (equal? (substring string-juego (+ string-pos-ant 32) (+ string-pos-ant 34)) "00") (equal? (substring string-juego (+ string-pos-ant 48) (+ string-pos-ant 50)) "00") (equal? (substring string-juego (+ string-pos-ant 64) (+ string-pos-ant 66)) "00") (equal? (substring string-juego (+ string-pos-ant 80) (+ string-pos-ant 82)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "RN") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (+ string-pos-ant 112)) (equal? (substring string-juego (+ string-pos-ant 16) (+ string-pos-ant 18)) "00") (equal? (substring string-juego (+ string-pos-ant 32) (+ string-pos-ant 34)) "00") (equal? (substring string-juego (+ string-pos-ant 48) (+ string-pos-ant 50)) "00") (equal? (substring string-juego (+ string-pos-ant 64) (+ string-pos-ant 66)) "00") (equal? (substring string-juego (+ string-pos-ant 80) (+ string-pos-ant 82)) "00") (equal? (substring string-juego (+ string-pos-ant 96) (+ string-pos-ant 98)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "RN") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [else ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "red") (sleep 0.6) ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "white") (busqueda (get-mouse-click juego-grafico) 80 80 0 1)]
                                                       ); fin cond
                ]; de lo contrario busca el segundo click a la derecha
                [(and (<= string-pos-ant string-pos)  (= (quotient string-pos-ant 16) (quotient string-pos 16)))
                                                (cond
                                                  [(= string-pos (+ string-pos-ant 2 ))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "RN") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (+ string-pos-ant 4 )) (equal? (substring string-juego (+ string-pos-ant 2) (+ string-pos-ant 4)) "00"))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "RN") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (+ string-pos-ant 6 )) (equal? (substring string-juego (+ string-pos-ant 2) (+ string-pos-ant 4)) "00") (equal? (substring string-juego (+ string-pos-ant 4) (+ string-pos-ant 6)) "00"))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "RN") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (+ string-pos-ant 8 )) (equal? (substring string-juego (+ string-pos-ant 2) (+ string-pos-ant 4)) "00") (equal? (substring string-juego (+ string-pos-ant 4) (+ string-pos-ant 6)) "00") (equal? (substring string-juego (+ string-pos-ant 6) (+ string-pos-ant 8)) "00"))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "RN") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (+ string-pos-ant 10 )) (equal? (substring string-juego (+ string-pos-ant 2) (+ string-pos-ant 4)) "00") (equal? (substring string-juego (+ string-pos-ant 4) (+ string-pos-ant 6)) "00") (equal? (substring string-juego (+ string-pos-ant 6) (+ string-pos-ant 8)) "00") (equal? (substring string-juego (+ string-pos-ant 8) (+ string-pos-ant 10)) "00"))
                                                                                              (string-copy! string-juego string-pos-ant "00")
                                                                                              (string-copy! string-juego string-pos ficha)
                                                                                              (if (equal? (jaque 0 "RN") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (+ string-pos-ant 12 )) (equal? (substring string-juego (+ string-pos-ant 2) (+ string-pos-ant 4)) "00") (equal? (substring string-juego (+ string-pos-ant 4) (+ string-pos-ant 6)) "00") (equal? (substring string-juego (+ string-pos-ant 6) (+ string-pos-ant 8)) "00") (equal? (substring string-juego (+ string-pos-ant 8) (+ string-pos-ant 10)) "00") (equal? (substring string-juego (+ string-pos-ant 10) (+ string-pos-ant 12)) "00"))
                                                                                              (string-copy! string-juego string-pos-ant "00")
                                                                                              (string-copy! string-juego string-pos ficha)
                                                                                              (if (equal? (jaque 0 "RN") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (+ string-pos-ant 14 )) (equal? (substring string-juego (+ string-pos-ant 2) (+ string-pos-ant 4)) "00") (equal? (substring string-juego (+ string-pos-ant 4) (+ string-pos-ant 6)) "00") (equal? (substring string-juego (+ string-pos-ant 6) (+ string-pos-ant 8)) "00") (equal? (substring string-juego (+ string-pos-ant 8) (+ string-pos-ant 10)) "00") (equal? (substring string-juego (+ string-pos-ant 10) (+ string-pos-ant 12)) "00") (equal? (substring string-juego (+ string-pos-ant 12) (+ string-pos-ant 14)) "00"))
                                                                                              (string-copy! string-juego string-pos-ant "00")
                                                                                              (string-copy! string-juego string-pos ficha)
                                                                                              (if (equal? (jaque 0 "RN") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [else ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "red") (sleep 0.6) ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "white") (busqueda (get-mouse-click juego-grafico) 80 80 0 1)]
                                                ); fin cond
                ]; de lo contrario busca el segundo click a la izquierda
                [(and (>= string-pos-ant string-pos)  (= (quotient string-pos-ant 16) (quotient string-pos 16)))
                                                (cond
                                                  [(= string-pos (- string-pos-ant 2 ))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "RN") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (- string-pos-ant 4 )) (equal? (substring string-juego (- string-pos-ant 2) (- string-pos-ant 0)) "00"))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "RN") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (- string-pos-ant 6 )) (equal? (substring string-juego (- string-pos-ant 2) (- string-pos-ant 0)) "00") (equal? (substring string-juego (- string-pos-ant 4) (- string-pos-ant 2)) "00"))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "RN") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (- string-pos-ant 8 )) (equal? (substring string-juego (- string-pos-ant 2) (- string-pos-ant 0)) "00") (equal? (substring string-juego (- string-pos-ant 4) (- string-pos-ant 2)) "00") (equal? (substring string-juego (- string-pos-ant 6) (- string-pos-ant 4)) "00"))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "RN") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (- string-pos-ant 10)) (equal? (substring string-juego (- string-pos-ant 2) (- string-pos-ant 0)) "00") (equal? (substring string-juego (- string-pos-ant 4) (- string-pos-ant 2)) "00") (equal? (substring string-juego (- string-pos-ant 6) (- string-pos-ant 4)) "00") (equal? (substring string-juego (- string-pos-ant 8) (- string-pos-ant 6)) "00"))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "RN") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (- string-pos-ant 12)) (equal? (substring string-juego (- string-pos-ant 2) (- string-pos-ant 0)) "00") (equal? (substring string-juego (- string-pos-ant 4) (- string-pos-ant 2)) "00") (equal? (substring string-juego (- string-pos-ant 6) (- string-pos-ant 4)) "00") (equal? (substring string-juego (- string-pos-ant 8) (- string-pos-ant 6)) "00") (equal? (substring string-juego (- string-pos-ant 10) (- string-pos-ant 8)) "00"))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "RN") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (- string-pos-ant 14)) (equal? (substring string-juego (- string-pos-ant 2) (- string-pos-ant 0)) "00") (equal? (substring string-juego (- string-pos-ant 4) (- string-pos-ant 2)) "00") (equal? (substring string-juego (- string-pos-ant 6) (- string-pos-ant 4)) "00") (equal? (substring string-juego (- string-pos-ant 8) (- string-pos-ant 6)) "00") (equal? (substring string-juego (- string-pos-ant 10) (- string-pos-ant 8)) "00") (equal? (substring string-juego (- string-pos-ant 12) (- string-pos-ant 10)) "00"))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "RN") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [else ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "red") (sleep 0.6) ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "white") (busqueda (get-mouse-click juego-grafico) 80 80 0 1)]
                                                ); fin cond
                ]; de lo contrario imprime que es un movimiento no valido
                [else ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "red") (sleep 0.6) ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "white") (busqueda (get-mouse-click juego-grafico) 80 80 0 1)]
              ); fin cond
          ; de lo contrario
             (begin
               ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "white")
               (busqueda (get-mouse-click juego-grafico) 80 80 0 1)
             ); fin begin false, movimiento no valido
          ); fin if, para sabber si el movimiento es valido
      ; de lo contrario
          (move-torre-negro click-mouse (if (= pixeles-x 640) 80 (+ pixeles-x 80)) (if (= pixeles-x 640) (+ pixeles-y 80) pixeles-y) pixeles-x-ant pixeles-y-ant string-pos-ant (+ string-pos 2) ficha direccion)
      ); fin if, para saber donde se dio click
  ; de lo contrario
      (if (and (and (>= (posn-x (mouse-click-posn click-mouse)) 85 ) (<= (posn-x (mouse-click-posn click-mouse)) 195)) (and (>= (posn-y (mouse-click-posn click-mouse)) 740) (<= (posn-y (mouse-click-posn click-mouse)) 758)))
          (begin
            ((draw-string juego-grafico) (make-posn 840 430) "JUEGO TERMINADO" "black")
            (string-set! string-juego-copy 127 #\-) (string-set! string-juego 127 #\-)
          ); fin begin true, se dio click en el boton de terminar
      ; de lo contrario
         (begin
           ((draw-string juego-grafico) (make-posn 840 430) "CLICK NO VALIDO" "red") (sleep 0.6) ((draw-string juego-grafico) (make-posn 840 430) "CLICK NO VALIDO" "white")
           (busqueda (get-mouse-click juego-grafico) 80 80 0 1)
         ); fin begin false, click no valido
     ); fin if, termino el juego
  ); fin if, principal
); fin definicion, movimiento de la torre negra
; Fin De La Definicion De Las Funciones Encargadas Del Movimiento De Las Torres.


; Inicio De La Definicion De Las Funciones Encargadas Del Movimiento De Los Caballos.
#| Identificadores Locales A La Funcion (Move Caballo Blanco):
   - click-mouse: guarda la informacion acerca del ultimo olick dado
   - pixeles-x: almacena las coordenadas en x del primer cuadro del tablero, la cual va contando aumentando su valor hasta ser la del cuadro seleccionado
   - pixeles-y: almacena las coordenadas en y del primer cuadro del tablero, la cual va contando aumentando su valor hasta ser la del cuadro seleccionado
   - pixeles-x-ant: almacena las coordenadas en x donde se encuentra la ficha ya seleccionada
   - pixeles-y-ant: almacena las coordenadas en y donde se encuentra la ficha ya seleccionada
   - string-pos-ant: almacena la posicion númerica de la ficha en el string
   - string-pos: almacena un valor númerico con relacion en el string, el cual va contando hasta ser la posicion a la que se deasea llevar la ficha
   - ficha: almacena un substring que identifica la ficha especifica que se va a mover
   - direccion: guarda la dirección de la imagen que se quiere imprimir en la posicion que el usuario desea
; Definicion de la funcion para dar movimiento a los caballo blanco. |#
(define (move-caballo-blanco click-mouse pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant string-pos-ant string-pos ficha direccion)
  (if (and (and (>= (posn-x (mouse-click-posn click-mouse)) 80) (<= (posn-x (mouse-click-posn click-mouse)) 720)) (and (>= (posn-y (mouse-click-posn click-mouse)) 80) (<= (posn-y (mouse-click-posn click-mouse)) 720))) #| se asegura de que el click sea dentro del tablero |#
      (if (and (and (>= (posn-x (mouse-click-posn click-mouse)) pixeles-x) (<= (posn-x (mouse-click-posn click-mouse)) (+ pixeles-x 80))) (and (>= (posn-y (mouse-click-posn click-mouse)) pixeles-y) (<= (posn-y (mouse-click-posn click-mouse)) (+ pixeles-y 80))))
          (if (or (equal? (substring string-juego string-pos (+ string-pos 1)) "0") (equal? (substring string-juego string-pos (+ string-pos 1)) "P") (equal? (substring string-juego string-pos (+ string-pos 1)) "T") (equal? (substring string-juego string-pos (+ string-pos 1)) "C")  (equal? (substring string-juego string-pos (+ string-pos 1)) "A") (equal? (substring string-juego string-pos (+ string-pos 1)) "Q"))
              (cond #| condicional para mover |#
                [(and (equal? string-pos (- string-pos-ant 34)) (and (> (quotient string-pos-ant 16) (quotient string-pos 16)) (> (remainder string-pos-ant 16) (remainder string-pos 16))))
                                                           (string-copy! string-juego string-pos-ant "00")
                                                           (string-copy! string-juego string-pos ficha)
                                                           (if (equal? (jaque 0 "rb") #t)
                                                               (begin
                                                                 ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                 (string-copy! string-juego 0 string-juego-copy)
                                                               ); fin begin true, existe jaque
                                                          ; de lo contrario
                                                               (begin
                                                                 (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                               ); fin begin falee, dibuja en la ventana grafica
                                                          ); fin if, para saber si hay jaque
                ]; de lo contrario comprueba otra posicion
                [(and (equal? string-pos (- string-pos-ant 30)) (and (> (quotient string-pos-ant 16) (quotient string-pos 16)) (< (remainder string-pos-ant 16) (remainder string-pos 16))))
                                                           (string-copy! string-juego string-pos-ant "00")
                                                           (string-copy! string-juego string-pos ficha)
                                                           (if (equal? (jaque 0 "rb") #t)
                                                               (begin
                                                                 ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                 (string-copy! string-juego 0 string-juego-copy)
                                                               ); fin begin true, existe jaque
                                                          ; de lo contrario
                                                               (begin
                                                                 (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                               ); fin begin falee, dibuja en la ventana grafica
                                                          ); fin if, para saber si hay jaque
                ]; de lo contrario comprueba otra posicion
                [(and (equal? string-pos (- string-pos-ant 20)) (and (> (quotient string-pos-ant 16) (quotient string-pos 16)) (> (remainder string-pos-ant 16) (remainder string-pos 16))))
                                                           (string-copy! string-juego string-pos-ant "00")
                                                           (string-copy! string-juego string-pos ficha)
                                                           (if (equal? (jaque 0 "rb") #t)
                                                               (begin
                                                                 ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                 (string-copy! string-juego 0 string-juego-copy)
                                                               ); fin begin true, existe jaque
                                                          ; de lo contrario
                                                               (begin
                                                                 (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                               ); fin begin falee, dibuja en la ventana grafica
                                                          ); fin if, para saber si hay jaque
                ]; de lo contrario comprueba otra posicion
                [(and (equal? string-pos (- string-pos-ant 12)) (and (> (quotient string-pos-ant 16) (quotient string-pos 16)) (< (remainder string-pos-ant 16) (remainder string-pos 16))))
                                                           (string-copy! string-juego string-pos-ant "00")
                                                           (string-copy! string-juego string-pos ficha)
                                                           (if (equal? (jaque 0 "rb") #t)
                                                               (begin
                                                                 ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                 (string-copy! string-juego 0 string-juego-copy)
                                                               ); fin begin true, existe jaque
                                                          ; de lo contrario
                                                               (begin
                                                                 (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                               ); fin begin falee, dibuja en la ventana grafica
                                                          ); fin if, para saber si hay jaque
                ]; de lo contrario comprueba otra posicion
                [(and (equal? string-pos (+ string-pos-ant 12)) (and (< (quotient string-pos-ant 16) (quotient string-pos 16)) (> (remainder string-pos-ant 16) (remainder string-pos 16))))
                                                           (string-copy! string-juego string-pos-ant "00")
                                                           (string-copy! string-juego string-pos ficha)
                                                           (if (equal? (jaque 0 "rb") #t)
                                                               (begin
                                                                 ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                 (string-copy! string-juego 0 string-juego-copy)
                                                               ); fin begin true, existe jaque
                                                          ; de lo contrario
                                                               (begin
                                                                 (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                               ); fin begin falee, dibuja en la ventana grafica
                                                          ); fin if, para saber si hay jaque
                ]; de lo contrario comprueba otra posicion
                [(and (equal? string-pos (+ string-pos-ant 20)) (and (< (quotient string-pos-ant 16) (quotient string-pos 16)) (< (remainder string-pos-ant 16) (remainder string-pos 16))))
                                                           (string-copy! string-juego string-pos-ant "00")
                                                           (string-copy! string-juego string-pos ficha)
                                                           (if (equal? (jaque 0 "rb") #t)
                                                               (begin
                                                                 ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                 (string-copy! string-juego 0 string-juego-copy)
                                                               ); fin begin true, existe jaque
                                                          ; de lo contrario
                                                               (begin
                                                                 (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                               ); fin begin falee, dibuja en la ventana grafica
                                                          ); fin if, para saber si hay jaque
                ]; de lo contrario comprueba otra posicion
                [(and (equal? string-pos (+ string-pos-ant 30)) (and (< (quotient string-pos-ant 16) (quotient string-pos 16)) (> (remainder string-pos-ant 16) (remainder string-pos 16))))
                                                           (string-copy! string-juego string-pos-ant "00")
                                                           (string-copy! string-juego string-pos ficha)
                                                           (if (equal? (jaque 0 "rb") #t)
                                                               (begin
                                                                 ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                 (string-copy! string-juego 0 string-juego-copy)
                                                               ); fin begin true, existe jaque
                                                          ; de lo contrario
                                                               (begin
                                                                 (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                               ); fin begin falee, dibuja en la ventana grafica
                                                          ); fin if, para saber si hay jaque
                ]; de lo contrario comprueba otra posicion
                [(and (equal? string-pos (+ string-pos-ant 34)) (and (< (quotient string-pos-ant 16) (quotient string-pos 16)) (< (remainder string-pos-ant 16) (remainder string-pos 16))))
                                                           (string-copy! string-juego string-pos-ant "00")
                                                           (string-copy! string-juego string-pos ficha)
                                                           (if (equal? (jaque 0 "rb") #t)
                                                               (begin
                                                                 ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                 (string-copy! string-juego 0 string-juego-copy)
                                                               ); fin begin true, existe jaque
                                                          ; de lo contrario
                                                               (begin
                                                                 (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                               ); fin begin falee, dibuja en la ventana grafica
                                                          ); fin if, para saber si hay jaque
                ]; de lo contrario es un movimiento no valido
                [else ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "white")(busqueda (get-mouse-click juego-grafico) 80 80 0 0)]
              ); fin cond
          ; de lo contrairo
              (begin
                ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "white")
                (busqueda (get-mouse-click juego-grafico) 80 80 0 0)
              ); fin begin false, movimiento no valido
          ); fin if, para saber si el movimiento es valido
      ; de lo contrario
          (move-caballo-blanco click-mouse (if (= pixeles-x 640) 80 (+ pixeles-x 80)) (if (= pixeles-x 640) (+ pixeles-y 80) pixeles-y) pixeles-x-ant pixeles-y-ant string-pos-ant (+ string-pos 2) ficha direccion)
      ); fin if, para saber donde se dio click
  ; de lo contrario
      (if (and (and (>= (posn-x (mouse-click-posn click-mouse)) 85 ) (<= (posn-x (mouse-click-posn click-mouse)) 195)) (and (>= (posn-y (mouse-click-posn click-mouse)) 740) (<= (posn-y (mouse-click-posn click-mouse)) 758)))
          (begin
            ((draw-string juego-grafico) (make-posn 840 430) "JUEGO TERMINADO" "black")
            (string-set! string-juego-copy 127 #\-) (string-set! string-juego 127 #\-)
          ); fin begin true, se dio click en el boton de terminar
      ; de lo contrario
         (begin
           ((draw-string juego-grafico) (make-posn 840 430) "CLICK NO VALIDO" "red") (sleep 0.6) ((draw-string juego-grafico) (make-posn 840 430) "CLICK NO VALIDO" "white")
           (busqueda (get-mouse-click juego-grafico) 80 80 0 0)
         ); fin begin false, click no valido
     ); fin if, termino el juego
  ); fin if, principal
); fin definicion, movimiento del caballo blanco

#| Identificadores Locales A La Funcion (Move-Caballo-Negro):
   - click-mouse: guarda la informacion acerca del ultimo olick dado
   - pixeles-x: almacena las coordenadas en x del primer cuadro del tablero, la cual va contando aumentando su valor hasta ser la del cuadro seleccionado
   - pixeles-y: almacena las coordenadas en y del primer cuadro del tablero, la cual va contando aumentando su valor hasta ser la del cuadro seleccionado
   - pixeles-x-ant: almacena las coordenadas en x donde se encuentra la ficha ya seleccionada
   - pixeles-y-ant: almacena las coordenadas en y donde se encuentra la ficha ya seleccionada
   - string-pos-ant: almacena la posicion númerica de la ficha en el string
   - string-pos: almacena un valor númerico con relacion en el string, el cual va contando hasta ser la posicion a la que se deasea llevar la ficha
   - ficha: almacena un substring que identifica la ficha especifica que se va a mover
   - direccion: guarda la dirección de la imagen que se quiere imprimir en la posicion que el usuario desea
; Definicion de la funcion para dar movimiento a los caballo negro. |#
(define (move-caballo-negro click-mouse pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant string-pos-ant string-pos ficha direccion)
  (if (and (and (>= (posn-x (mouse-click-posn click-mouse)) 80) (<= (posn-x (mouse-click-posn click-mouse)) 720)) (and (>= (posn-y (mouse-click-posn click-mouse)) 80) (<= (posn-y (mouse-click-posn click-mouse)) 720))) #| se asegura de que el click sea dentro del tablero |#
      (if (and (and (>= (posn-x (mouse-click-posn click-mouse)) pixeles-x) (<= (posn-x (mouse-click-posn click-mouse)) (+ pixeles-x 80))) (and (>= (posn-y (mouse-click-posn click-mouse)) pixeles-y) (<= (posn-y (mouse-click-posn click-mouse)) (+ pixeles-y 80))))
          (if (or (equal? (substring string-juego string-pos (+ string-pos 1)) "0") (equal? (substring string-juego string-pos (+ string-pos 1)) "p") (equal? (substring string-juego string-pos (+ string-pos 1)) "t") (equal? (substring string-juego string-pos (+ string-pos 1)) "c")  (equal? (substring string-juego string-pos (+ string-pos 1)) "a") (equal? (substring string-juego string-pos (+ string-pos 1)) "q"))
              (cond #| condicional para mover sin comer ficha |#
                [(and (equal? string-pos (- string-pos-ant 34)) (and (> (quotient string-pos-ant 16) (quotient string-pos 16)) (> (remainder string-pos-ant 16) (remainder string-pos 16))))
                                                           (string-copy! string-juego string-pos-ant "00")
                                                           (string-copy! string-juego string-pos ficha)
                                                           (if (equal? (jaque 0 "RN") #t)
                                                               (begin
                                                                 ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                 (string-copy! string-juego 0 string-juego-copy)
                                                               ); fin begin true, existe jaque
                                                           ; de lo contrario
                                                               (begin
                                                                 (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                               ); fin begin falee, dibuja en la ventana grafica
                                                          ); fin if, para saber si hay jaque
                ]; de lo contrario comprueba otra posicion
                [(and (equal? string-pos (- string-pos-ant 30)) (and (> (quotient string-pos-ant 16) (quotient string-pos 16)) (< (remainder string-pos-ant 16) (remainder string-pos 16))))
                                                           (string-copy! string-juego string-pos-ant "00")
                                                           (string-copy! string-juego string-pos ficha)
                                                           (if (equal? (jaque 0 "RN") #t)
                                                               (begin
                                                                 ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                 (string-copy! string-juego 0 string-juego-copy)
                                                               ); fin begin true, existe jaque
                                                           ; de lo contrario
                                                               (begin
                                                                 (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                               ); fin begin falee, dibuja en la ventana grafica
                                                          ); fin if, para saber si hay jaque
                ]; de lo contrario comprueba otra posicion
                [(and (equal? string-pos (- string-pos-ant 20)) (and (> (quotient string-pos-ant 16) (quotient string-pos 16)) (> (remainder string-pos-ant 16) (remainder string-pos 16))))
                                                           (string-copy! string-juego string-pos-ant "00")
                                                           (string-copy! string-juego string-pos ficha)
                                                           (if (equal? (jaque 0 "RN") #t)
                                                               (begin
                                                                 ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                 (string-copy! string-juego 0 string-juego-copy)
                                                               ); fin begin true, existe jaque
                                                           ; de lo contrario
                                                               (begin
                                                                 (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                               ); fin begin falee, dibuja en la ventana grafica
                                                          ); fin if, para saber si hay jaque
                ]; de lo contrario comprueba otra posicion
                [(and (equal? string-pos (- string-pos-ant 12)) (and (> (quotient string-pos-ant 16) (quotient string-pos 16)) (< (remainder string-pos-ant 16) (remainder string-pos 16))))
                                                           (string-copy! string-juego string-pos-ant "00")
                                                           (string-copy! string-juego string-pos ficha)
                                                           (if (equal? (jaque 0 "RN") #t)
                                                               (begin
                                                                 ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                 (string-copy! string-juego 0 string-juego-copy)
                                                               ); fin begin true, existe jaque
                                                           ; de lo contrario
                                                               (begin
                                                                 (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                               ); fin begin falee, dibuja en la ventana grafica
                                                          ); fin if, para saber si hay jaque
                ]; de lo contrario comprueba otra posicion
                [(and (equal? string-pos (+ string-pos-ant 12)) (and (< (quotient string-pos-ant 16) (quotient string-pos 16)) (> (remainder string-pos-ant 16) (remainder string-pos 16))))
                                                           (string-copy! string-juego string-pos-ant "00")
                                                           (string-copy! string-juego string-pos ficha)
                                                           (if (equal? (jaque 0 "RN") #t)
                                                               (begin
                                                                 ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                 (string-copy! string-juego 0 string-juego-copy)
                                                               ); fin begin true, existe jaque
                                                           ; de lo contrario
                                                               (begin
                                                                 (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                               ); fin begin falee, dibuja en la ventana grafica
                                                          ); fin if, para saber si hay jaque
                ]; de lo contrario comprueba otra posicion
                [(and (equal? string-pos (+ string-pos-ant 20)) (and (< (quotient string-pos-ant 16) (quotient string-pos 16)) (< (remainder string-pos-ant 16) (remainder string-pos 16))))
                                                           (string-copy! string-juego string-pos-ant "00")
                                                           (string-copy! string-juego string-pos ficha)
                                                           (if (equal? (jaque 0 "RN") #t)
                                                               (begin
                                                                 ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                 (string-copy! string-juego 0 string-juego-copy)
                                                               ); fin begin true, existe jaque
                                                           ; de lo contrario
                                                               (begin
                                                                 (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                               ); fin begin falee, dibuja en la ventana grafica
                                                          ); fin if, para saber si hay jaque
                ]; de lo contrario comprueba otra posicion
                [(and (equal? string-pos (+ string-pos-ant 30)) (and (< (quotient string-pos-ant 16) (quotient string-pos 16)) (> (remainder string-pos-ant 16) (remainder string-pos 16))))
                                                           (string-copy! string-juego string-pos-ant "00")
                                                           (string-copy! string-juego string-pos ficha)
                                                           (if (equal? (jaque 0 "RN") #t)
                                                               (begin
                                                                 ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                 (string-copy! string-juego 0 string-juego-copy)
                                                               ); fin begin true, existe jaque
                                                           ; de lo contrario
                                                               (begin
                                                                 (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                               ); fin begin falee, dibuja en la ventana grafica
                                                          ); fin if, para saber si hay jaque
                ]; de lo contrario comprueba otra posicion
                [(and (equal? string-pos (+ string-pos-ant 34)) (and (< (quotient string-pos-ant 16) (quotient string-pos 16)) (< (remainder string-pos-ant 16) (remainder string-pos 16))))
                                                           (string-copy! string-juego string-pos-ant "00")
                                                           (string-copy! string-juego string-pos ficha)
                                                           (if (equal? (jaque 0 "RN") #t)
                                                               (begin
                                                                 ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                 (string-copy! string-juego 0 string-juego-copy)
                                                               ); fin begin true, existe jaque
                                                           ; de lo contrario
                                                               (begin
                                                                 (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                               ); fin begin falee, dibuja en la ventana grafica
                                                          ); fin if, para saber si hay jaque
                ]; de lo contrario es un movimiento no valido
                [else ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "white")(busqueda (get-mouse-click juego-grafico) 80 80 0 1)]
              ); fin cond
          ; de lo contrairo
              (begin
                ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "white")
                (busqueda (get-mouse-click juego-grafico) 80 80 0 1)
              ); fin begin false, movimiento no valido
          ); fin if, para saber si el movimiento es valido
      ; de lo contrario
          (move-caballo-negro click-mouse (if (= pixeles-x 640) 80 (+ pixeles-x 80)) (if (= pixeles-x 640) (+ pixeles-y 80) pixeles-y) pixeles-x-ant pixeles-y-ant string-pos-ant (+ string-pos 2) ficha direccion)
      ); fin if, para saber donde se dio click
  ; de lo contrario
      (if (and (and (>= (posn-x (mouse-click-posn click-mouse)) 85 ) (<= (posn-x (mouse-click-posn click-mouse)) 195)) (and (>= (posn-y (mouse-click-posn click-mouse)) 740) (<= (posn-y (mouse-click-posn click-mouse)) 758)))
          (begin
            ((draw-string juego-grafico) (make-posn 840 430) "JUEGO TERMINADO" "black")
            (string-set! string-juego-copy 127 #\-) (string-set! string-juego 127 #\-)
          ); fin begin true, se dio click en el boton de terminar
      ; de lo contrario
         (begin
           ((draw-string juego-grafico) (make-posn 840 430) "CLICK NO VALIDO" "red") (sleep 0.6) ((draw-string juego-grafico) (make-posn 840 430) "CLICK NO VALIDO" "white")
           (busqueda (get-mouse-click juego-grafico) 80 80 0 1)
         ); fin begin false, click no valido
     ); fin if, termino el juego
  ); fin if, principal
); fin definicion, movimiento del caballo negro
; Fin De La Definicion De Las Funciones Que Dan Movimiento A Los Caballos.

; Inicio De La Definicion De Las Funciones Qur Dan Movimiento A Los Alfiles.
#| Identificadores Locales A La Funcion (Move Alfil Blanco):
   - click-mouse: guarda la informacion acerca del ultimo olick dado.
   - pixeles-x: almacena las coordenadas en x del primer cuadro del tablero, la cual va contando aumentando su valor hasta ser la del cuadro seleccionado. 
   - pixeles-y: almacena las coordenadas en y del primer cuadro del tablero, la cual va contando aumentando su valor hasta ser la del cuadro seleccionado.
   - pixeles-x-ant: almacena las coordenadas en x donde se encuentra la ficha ya seleccionada.
   - pixeles-y-ant: almacena las coordenadas en y donde se encuentra la ficha ya seleccionada.
   - string-pos-ant: almacena la posicion númerica de la ficha en el string.
   - string-pos: almacena un valor númerico con relacion en el string, el cual va contando hasta ser la posicion a la que se deasea llevar la ficha.
   - ficha: almacena un substring que identifica la ficha especifica que se va a mover.
   - direccion: guarda la dirección de la imagen que se quiere imprimir en la posicion que el usuario desea. |#
; Definicion de la funcion para dar movimiento a los alfiles blancos.
(define (move-alfil-blanco click-mouse pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant string-pos-ant string-pos ficha direccion)
  (if (and (and (>= (posn-x (mouse-click-posn click-mouse)) 80) (<= (posn-x (mouse-click-posn click-mouse)) 720)) (and (>= (posn-y (mouse-click-posn click-mouse)) 80) (<= (posn-y (mouse-click-posn click-mouse)) 720))) #| se asegura de que el click sea dentro del tablero |#
      (if (and (and (>= (posn-x (mouse-click-posn click-mouse)) pixeles-x) (<= (posn-x (mouse-click-posn click-mouse)) (+ pixeles-x 80))) (and (>= (posn-y (mouse-click-posn click-mouse)) pixeles-y) (<= (posn-y (mouse-click-posn click-mouse)) (+ pixeles-y 80))))
          (if (or (equal? (substring string-juego string-pos (+ string-pos 1)) "0") (equal? (substring string-juego string-pos (+ string-pos 1)) "P") (equal? (substring string-juego string-pos (+ string-pos 1)) "T") (equal? (substring string-juego string-pos (+ string-pos 1)) "C")  (equal? (substring string-juego string-pos (+ string-pos 1)) "A") (equal? (substring string-juego string-pos (+ string-pos 1)) "Q"))
              (cond #| condicionales en el siguiente orden: mover arriba izquierda, abajo izquierda, abajo derecha y arriba derecha |#
                ; inicio que busca el segundo click arriba a la izquierda
                [(or (equal? (- string-pos-ant 18) string-pos) (and (> (quotient string-pos-ant 16) (quotient string-pos 16)) (> (remainder string-pos-ant 16) (remainder string-pos 16))) (equal? (- string-pos-ant 36) string-pos) (equal? (- string-pos-ant 54) string-pos) (equal? (- string-pos-ant 72) string-pos) (equal? (- string-pos-ant 90) string-pos) (equal? (- string-pos-ant 108) string-pos) (equal? (- string-pos-ant 126) string-pos))
                                                       (cond
                                                         [(= string-pos (- string-pos-ant 18 ))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "rb") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (- string-pos-ant 36 )) (equal? (substring string-juego (- string-pos-ant 18) (- string-pos-ant 16)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "rb") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (- string-pos-ant 54 )) (equal? (substring string-juego (- string-pos-ant 18) (- string-pos-ant 16)) "00") (equal? (substring string-juego (- string-pos-ant 36) (- string-pos-ant 34)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "rb") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (- string-pos-ant 72 )) (equal? (substring string-juego (- string-pos-ant 18) (- string-pos-ant 16)) "00") (equal? (substring string-juego (- string-pos-ant 36) (- string-pos-ant 34)) "00") (equal? (substring string-juego (- string-pos-ant 54) (- string-pos-ant 52)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "rb") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (- string-pos-ant 90 )) (equal? (substring string-juego (- string-pos-ant 18) (- string-pos-ant 16)) "00") (equal? (substring string-juego (- string-pos-ant 36) (- string-pos-ant 34)) "00") (equal? (substring string-juego (- string-pos-ant 54) (- string-pos-ant 52)) "00") (equal? (substring string-juego (- string-pos-ant 72) (- string-pos-ant 70)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "rb") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (- string-pos-ant 108)) (equal? (substring string-juego (- string-pos-ant 18) (- string-pos-ant 16)) "00") (equal? (substring string-juego (- string-pos-ant 36) (- string-pos-ant 34)) "00") (equal? (substring string-juego (- string-pos-ant 54) (- string-pos-ant 52)) "00") (equal? (substring string-juego (- string-pos-ant 72) (- string-pos-ant 70)) "00") (equal? (substring string-juego (- string-pos-ant 90) (- string-pos-ant 88)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "rb") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (- string-pos-ant 126)) (equal? (substring string-juego (- string-pos-ant 18) (- string-pos-ant 16)) "00") (equal? (substring string-juego (- string-pos-ant 36) (- string-pos-ant 34)) "00") (equal? (substring string-juego (- string-pos-ant 54) (- string-pos-ant 52)) "00") (equal? (substring string-juego (- string-pos-ant 72) (- string-pos-ant 70)) "00") (equal? (substring string-juego (- string-pos-ant 90) (- string-pos-ant 88)) "00") (equal? (substring string-juego (- string-pos-ant 108) (- string-pos-ant 106)) "00") (equal? (substring string-juego (- string-pos-ant 126) (- string-pos-ant 124)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "rb") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario imprime que es un movimiento no valido
                                                         [else ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "red") (sleep 0.6) ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "white") (busqueda (get-mouse-click juego-grafico) 80 80 0 0)]
                                                       ); fin cond
                ]; de lo contrario busca el segundo click abajo a la izquierda
                [(or (equal? (+ string-pos-ant 14) string-pos) (and (< (quotient string-pos-ant 16) (quotient string-pos 16)) (> (remainder string-pos-ant 16) (remainder string-pos 16))) (equal? (+ string-pos-ant 28) string-pos) (equal? (+ string-pos-ant 42) string-pos) (equal? (+ string-pos-ant 56) string-pos) (equal? (+ string-pos-ant 70) string-pos) (equal? (+ string-pos-ant 84)string-pos) (equal? (+ string-pos-ant 98) string-pos))
                                                       (cond
                                                         [(= string-pos (+ string-pos-ant 14 ))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "rb") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (+ string-pos-ant 28 )) (equal? (substring string-juego (+ string-pos-ant 14) (+ string-pos-ant 16)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "rb") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (+ string-pos-ant 42 )) (equal? (substring string-juego (+ string-pos-ant 14) (+ string-pos-ant 16)) "00") (equal? (substring string-juego (+ string-pos-ant 28) (+ string-pos-ant 30)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "rb") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (+ string-pos-ant 56 )) (equal? (substring string-juego (+ string-pos-ant 14) (+ string-pos-ant 16)) "00") (equal? (substring string-juego (+ string-pos-ant 28) (+ string-pos-ant 30)) "00") (equal? (substring string-juego (+ string-pos-ant 42) (+ string-pos-ant 44)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "rb") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (+ string-pos-ant 70 )) (equal? (substring string-juego (+ string-pos-ant 14) (+ string-pos-ant 16)) "00") (equal? (substring string-juego (+ string-pos-ant 28) (+ string-pos-ant 30)) "00") (equal? (substring string-juego (+ string-pos-ant 42) (+ string-pos-ant 44)) "00") (equal? (substring string-juego (+ string-pos-ant 56) (+ string-pos-ant 58)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "rb") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (+ string-pos-ant 84 )) (equal? (substring string-juego (+ string-pos-ant 14) (+ string-pos-ant 16)) "00") (equal? (substring string-juego (+ string-pos-ant 28) (+ string-pos-ant 30)) "00") (equal? (substring string-juego (+ string-pos-ant 42) (+ string-pos-ant 44)) "00") (equal? (substring string-juego (+ string-pos-ant 56) (+ string-pos-ant 58)) "00") (equal? (substring string-juego (+ string-pos-ant 70) (+ string-pos-ant 72)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "rb") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (+ string-pos-ant 98 )) (equal? (substring string-juego (+ string-pos-ant 14) (+ string-pos-ant 16)) "00") (equal? (substring string-juego (+ string-pos-ant 28) (+ string-pos-ant 30)) "00") (equal? (substring string-juego (+ string-pos-ant 42) (+ string-pos-ant 44)) "00") (equal? (substring string-juego (+ string-pos-ant 56) (+ string-pos-ant 58)) "00") (equal? (substring string-juego (+ string-pos-ant 70) (+ string-pos-ant 72)) "00") (equal? (substring string-juego (+ string-pos-ant 84) (+ string-pos-ant 86)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "rb") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario imprime que es un movimiento no valido
                                                         [else ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "red") (sleep 0.6) ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "white") (busqueda (get-mouse-click juego-grafico) 80 80 0 0)]
                                                       ); fin cond
                ]; de lo contrario busca el segundo click abajo a la derecha
                [(or (equal? (+ string-pos-ant 18) string-pos) (and (< (quotient string-pos-ant 16) (quotient string-pos 16)) (< (remainder string-pos-ant 16) (remainder string-pos 16))) (equal? (+ string-pos-ant 36) string-pos) (equal? (+ string-pos-ant 54) string-pos) (equal? (+ string-pos-ant 72) string-pos) (equal? (+ string-pos-ant 90) string-pos) (equal? (+ string-pos-ant 108) string-pos) (equal? (+ string-pos-ant 126) string-pos))
                                                (cond
                                                  [(= string-pos (+ string-pos-ant 18))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "rb") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (+ string-pos-ant 36)) (equal? (substring string-juego (+ string-pos-ant 18) (+ string-pos-ant 20)) "00"))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "rb") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (+ string-pos-ant 54)) (equal? (substring string-juego (+ string-pos-ant 18) (+ string-pos-ant 20)) "00") (equal? (substring string-juego (+ string-pos-ant 36) (+ string-pos-ant 38)) "00"))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "rb") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (+ string-pos-ant 72)) (equal? (substring string-juego (+ string-pos-ant 18) (+ string-pos-ant 20)) "00") (equal? (substring string-juego (+ string-pos-ant 36) (+ string-pos-ant 38)) "00") (equal? (substring string-juego (+ string-pos-ant 54) (+ string-pos-ant 56)) "00"))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "rb") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (+ string-pos-ant 90 )) (equal? (substring string-juego (+ string-pos-ant 18) (+ string-pos-ant 20)) "00") (equal? (substring string-juego (+ string-pos-ant 36) (+ string-pos-ant 38)) "00") (equal? (substring string-juego (+ string-pos-ant 54) (+ string-pos-ant 56)) "00") (equal? (substring string-juego (+ string-pos-ant 72) (+ string-pos-ant 74)) "00"))
                                                                                              (string-copy! string-juego string-pos-ant "00")
                                                                                              (string-copy! string-juego string-pos ficha)
                                                                                              (if (equal? (jaque 0 "rb") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (+ string-pos-ant 108)) (equal? (substring string-juego (+ string-pos-ant 18) (+ string-pos-ant 20)) "00") (equal? (substring string-juego (+ string-pos-ant 36) (+ string-pos-ant 38)) "00") (equal? (substring string-juego (+ string-pos-ant 54) (+ string-pos-ant 56)) "00") (equal? (substring string-juego (+ string-pos-ant 72) (+ string-pos-ant 74)) "00") (equal? (substring string-juego (+ string-pos-ant 90) (+ string-pos-ant 92)) "00"))
                                                                                              (string-copy! string-juego string-pos-ant "00")
                                                                                              (string-copy! string-juego string-pos ficha)
                                                                                              (if (equal? (jaque 0 "rb") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (+ string-pos-ant 126)) (equal? (substring string-juego (+ string-pos-ant 18) (+ string-pos-ant 20)) "00") (equal? (substring string-juego (+ string-pos-ant 36) (+ string-pos-ant 38)) "00") (equal? (substring string-juego (+ string-pos-ant 54) (+ string-pos-ant 56)) "00") (equal? (substring string-juego (+ string-pos-ant 72) (+ string-pos-ant 74)) "00") (equal? (substring string-juego (+ string-pos-ant 90) (+ string-pos-ant 92)) "00") (equal? (substring string-juego (+ string-pos-ant 108) (+ string-pos-ant 110)) "00"))
                                                                                              (string-copy! string-juego string-pos-ant "00")
                                                                                              (string-copy! string-juego string-pos ficha)
                                                                                              (if (equal? (jaque 0 "rb") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario imprime que es un movimiento no valido
                                                  [else ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "red") (sleep 0.6) ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "white") (busqueda (get-mouse-click juego-grafico) 80 80 0 0)]
                                                ); fin cond
                ]; de lo contrario busca el segundo click arriba a la derecha
                [(or (equal? (- string-pos-ant 14) string-pos) (and (> (quotient string-pos-ant 16) (quotient string-pos 16)) (< (remainder string-pos-ant 16) (remainder string-pos 16))) (equal? (- string-pos-ant 28) string-pos) (equal? (- string-pos-ant 42) string-pos) (equal? (- string-pos-ant 56) string-pos) (equal? (- string-pos-ant 70) string-pos) (equal? (- string-pos-ant 84) string-pos) (equal? (- string-pos-ant 98) string-pos))
                                                (cond
                                                  [(= string-pos (- string-pos-ant 14))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "rb") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (- string-pos-ant 28)) (equal? (substring string-juego (- string-pos-ant 14) (- string-pos-ant 12)) "00"))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "rb") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (- string-pos-ant 42)) (equal? (substring string-juego (- string-pos-ant 14) (- string-pos-ant 12)) "00") (equal? (substring string-juego (- string-pos-ant 28) (- string-pos-ant 26)) "00"))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "rb") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (- string-pos-ant 56)) (equal? (substring string-juego (- string-pos-ant 14) (- string-pos-ant 12)) "00") (equal? (substring string-juego (- string-pos-ant 28) (- string-pos-ant 26)) "00") (equal? (substring string-juego (- string-pos-ant 42) (- string-pos-ant 40)) "00"))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "rb") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (- string-pos-ant 70)) (equal? (substring string-juego (- string-pos-ant 14) (- string-pos-ant 12)) "00") (equal? (substring string-juego (- string-pos-ant 28) (- string-pos-ant 26)) "00") (equal? (substring string-juego (- string-pos-ant 42) (- string-pos-ant 40)) "00") (equal? (substring string-juego (- string-pos-ant 56) (- string-pos-ant 54)) "00"))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "rb") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (- string-pos-ant 84)) (equal? (substring string-juego (- string-pos-ant 14) (- string-pos-ant 12)) "00") (equal? (substring string-juego (- string-pos-ant 28) (- string-pos-ant 26)) "00") (equal? (substring string-juego (- string-pos-ant 42) (- string-pos-ant 40)) "00") (equal? (substring string-juego (- string-pos-ant 56) (- string-pos-ant 54)) "00") (equal? (substring string-juego (- string-pos-ant 70) (- string-pos-ant 68)) "00"))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "rb") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (- string-pos-ant 98)) (equal? (substring string-juego (- string-pos-ant 14) (- string-pos-ant 12)) "00") (equal? (substring string-juego (- string-pos-ant 28) (- string-pos-ant 26)) "00") (equal? (substring string-juego (- string-pos-ant 42) (- string-pos-ant 40)) "00") (equal? (substring string-juego (- string-pos-ant 56) (- string-pos-ant 54)) "00") (equal? (substring string-juego (- string-pos-ant 70) (- string-pos-ant 68)) "00") (equal? (substring string-juego (- string-pos-ant 84) (- string-pos-ant 82)) "00"))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "rb") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario imprime que es un movimiento no valido
                                                  [else ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "red") (sleep 0.6) ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "white") (busqueda (get-mouse-click juego-grafico) 80 80 0 0)]
                                                ); fin cond
                ]; de lo contrario imprime que es un movimiento no valido
                [else ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "red") (sleep 0.6) ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "white") (busqueda (get-mouse-click juego-grafico) 80 80 0 0)]
              ); fin cond
          ; de lo contrario
              (begin
                ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "red") (sleep 0.6) ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "white")
                (busqueda (get-mouse-click juego-grafico) 80 80 0 0)
              ); fin begin false, movimiento no valido
          ); fin if, para saber si el movimiento es valido
      ; de lo contrario
          (move-alfil-blanco click-mouse (if (= pixeles-x 640) 80 (+ pixeles-x 80)) (if (= pixeles-x 640) (+ pixeles-y 80) pixeles-y) pixeles-x-ant pixeles-y-ant string-pos-ant (+ string-pos 2) ficha direccion)
      ); fin if, para saber donde se dio click
  ; de lo contrario
      (if (and (and (>= (posn-x (mouse-click-posn click-mouse)) 85 ) (<= (posn-x (mouse-click-posn click-mouse)) 195)) (and (>= (posn-y (mouse-click-posn click-mouse)) 740) (<= (posn-y (mouse-click-posn click-mouse)) 758)))
          (begin
            ((draw-string juego-grafico) (make-posn 840 430) "JUEGO TERMINADO" "black")
            (string-set! string-juego-copy 127 #\-) (string-set! string-juego 127 #\-)
          ); fin begin true, se dio click en el boton de terminar
      ; de lo contrario
         (begin
           ((draw-string juego-grafico) (make-posn 840 430) "CLICK NO VALIDO" "red") (sleep 0.6) ((draw-string juego-grafico) (make-posn 840 430) "CLICK NO VALIDO" "white")
           (busqueda (get-mouse-click juego-grafico) 80 80 0 0)
         ); fin begin false, click no valido
     ); fin if, termino el juego
  ); fin if, principal
); fin definicion, movimiento del alfil blanco

#| Identificadores Locales A La Funcion (Move Alfil Negro):
   - click-mouse: guarda la informacion acerca del ultimo olick dado
   - pixeles-x: almacena las coordenadas en x del primer cuadro del tablero, la cual va contando aumentando su valor hasta ser la del cuadro seleccionado
   - pixeles-y: almacena las coordenadas en y del primer cuadro del tablero, la cual va contando aumentando su valor hasta ser la del cuadro seleccionado
   - pixeles-x-ant: almacena las coordenadas en x donde se encuentra la ficha ya seleccionada
   - pixeles-y-ant: almacena las coordenadas en y donde se encuentra la ficha ya seleccionada
   - string-pos-ant: almacena la posicion númerica de la ficha en el string
   - string-pos: almacena un valor númerico con relacion en el string, el cual va contando hasta ser la posicion a la que se deasea llevar la ficha
   - ficha: almacena un substring que identifica la ficha especifica que se va a mover
   - direccion: guarda la dirección de la imagen que se quiere imprimir en la posicion que el usuario desea
; Definicion de la funcion para dar movimiento a los alfiles negros. |#
(define (move-alfil-negro click-mouse pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant string-pos-ant string-pos ficha direccion)
  (if (and (and (>= (posn-x (mouse-click-posn click-mouse)) 80) (<= (posn-x (mouse-click-posn click-mouse)) 720)) (and (>= (posn-y (mouse-click-posn click-mouse)) 80) (<= (posn-y (mouse-click-posn click-mouse)) 720))) #| se asegura de que el click sea dentro del tablero |#
      (if (and (and (>= (posn-x (mouse-click-posn click-mouse)) pixeles-x) (<= (posn-x (mouse-click-posn click-mouse)) (+ pixeles-x 80))) (and (>= (posn-y (mouse-click-posn click-mouse)) pixeles-y) (<= (posn-y (mouse-click-posn click-mouse)) (+ pixeles-y 80))))
          (if (or (equal? (substring string-juego string-pos (+ string-pos 1)) "0") (equal? (substring string-juego string-pos (+ string-pos 1)) "p") (equal? (substring string-juego string-pos (+ string-pos 1)) "t") (equal? (substring string-juego string-pos (+ string-pos 1)) "c")  (equal? (substring string-juego string-pos (+ string-pos 1)) "a") (equal? (substring string-juego string-pos (+ string-pos 1)) "q"))
              (cond #| condicionales en el siguiente orden: mover arriba izquierda, abajo izquierda, abajo derecha y arriba derecha |#
                ; inicio que busca el segundo click arriba a la izquierda
                [(or (equal? (- string-pos-ant 18) string-pos) (and (> (quotient string-pos-ant 16) (quotient string-pos 16)) (> (remainder string-pos-ant 16) (remainder string-pos 16))) (equal? (- string-pos-ant 36) string-pos) (equal? (- string-pos-ant 54) string-pos) (equal? (- string-pos-ant 72) string-pos) (equal? (- string-pos-ant 90) string-pos) (equal? (- string-pos-ant 108) string-pos) (equal? (- string-pos-ant 126) string-pos))
                                                       (cond
                                                         [(= string-pos (- string-pos-ant 18 ))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "RN") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (- string-pos-ant 36 )) (equal? (substring string-juego (- string-pos-ant 18) (- string-pos-ant 16)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "RN") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (- string-pos-ant 54 )) (equal? (substring string-juego (- string-pos-ant 18) (- string-pos-ant 16)) "00") (equal? (substring string-juego (- string-pos-ant 36) (- string-pos-ant 34)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "RN") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (- string-pos-ant 72 )) (equal? (substring string-juego (- string-pos-ant 18) (- string-pos-ant 16)) "00") (equal? (substring string-juego (- string-pos-ant 36) (- string-pos-ant 34)) "00") (equal? (substring string-juego (- string-pos-ant 54) (- string-pos-ant 52)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "RN") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (- string-pos-ant 90 )) (equal? (substring string-juego (- string-pos-ant 18) (- string-pos-ant 16)) "00") (equal? (substring string-juego (- string-pos-ant 36) (- string-pos-ant 34)) "00") (equal? (substring string-juego (- string-pos-ant 54) (- string-pos-ant 52)) "00") (equal? (substring string-juego (- string-pos-ant 72) (- string-pos-ant 70)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "RN") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (- string-pos-ant 108)) (equal? (substring string-juego (- string-pos-ant 18) (- string-pos-ant 16)) "00") (equal? (substring string-juego (- string-pos-ant 36) (- string-pos-ant 34)) "00") (equal? (substring string-juego (- string-pos-ant 54) (- string-pos-ant 52)) "00") (equal? (substring string-juego (- string-pos-ant 72) (- string-pos-ant 70)) "00") (equal? (substring string-juego (- string-pos-ant 90) (- string-pos-ant 88)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "RN") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (- string-pos-ant 126)) (equal? (substring string-juego (- string-pos-ant 18) (- string-pos-ant 16)) "00") (equal? (substring string-juego (- string-pos-ant 36) (- string-pos-ant 34)) "00") (equal? (substring string-juego (- string-pos-ant 54) (- string-pos-ant 52)) "00") (equal? (substring string-juego (- string-pos-ant 72) (- string-pos-ant 70)) "00") (equal? (substring string-juego (- string-pos-ant 90) (- string-pos-ant 88)) "00") (equal? (substring string-juego (- string-pos-ant 108) (- string-pos-ant 106)) "00") (equal? (substring string-juego (- string-pos-ant 126) (- string-pos-ant 124)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "RN") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario imprime que es un movimiento no valido
                                                         [else ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "red") (sleep 0.6) ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "white") (busqueda (get-mouse-click juego-grafico) 80 80 0 1)]
                                                       ); fin cond
                ]; de lo contrario busca el segundo click abajo a la izquierda
                [(or (equal? (+ string-pos-ant 14) string-pos) (and (< (quotient string-pos-ant 16) (quotient string-pos 16)) (> (remainder string-pos-ant 16) (remainder string-pos 16))) (equal? (+ string-pos-ant 28) string-pos) (equal? (+ string-pos-ant 42) string-pos) (equal? (+ string-pos-ant 56) string-pos) (equal? (+ string-pos-ant 70) string-pos) (equal? (+ string-pos-ant 84)string-pos) (equal? (+ string-pos-ant 98) string-pos))
                                                       (cond
                                                         [(= string-pos (+ string-pos-ant 14 ))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "RN") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (+ string-pos-ant 28 )) (equal? (substring string-juego (+ string-pos-ant 14) (+ string-pos-ant 16)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "RN") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (+ string-pos-ant 42 )) (equal? (substring string-juego (+ string-pos-ant 14) (+ string-pos-ant 16)) "00") (equal? (substring string-juego (+ string-pos-ant 28) (+ string-pos-ant 30)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "RN") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (+ string-pos-ant 56 )) (equal? (substring string-juego (+ string-pos-ant 14) (+ string-pos-ant 16)) "00") (equal? (substring string-juego (+ string-pos-ant 28) (+ string-pos-ant 30)) "00") (equal? (substring string-juego (+ string-pos-ant 42) (+ string-pos-ant 44)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "RN") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (+ string-pos-ant 70 )) (equal? (substring string-juego (+ string-pos-ant 14) (+ string-pos-ant 16)) "00") (equal? (substring string-juego (+ string-pos-ant 28) (+ string-pos-ant 30)) "00") (equal? (substring string-juego (+ string-pos-ant 42) (+ string-pos-ant 44)) "00") (equal? (substring string-juego (+ string-pos-ant 56) (+ string-pos-ant 58)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "RN") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (+ string-pos-ant 84 )) (equal? (substring string-juego (+ string-pos-ant 14) (+ string-pos-ant 16)) "00") (equal? (substring string-juego (+ string-pos-ant 28) (+ string-pos-ant 30)) "00") (equal? (substring string-juego (+ string-pos-ant 42) (+ string-pos-ant 44)) "00") (equal? (substring string-juego (+ string-pos-ant 56) (+ string-pos-ant 58)) "00") (equal? (substring string-juego (+ string-pos-ant 70) (+ string-pos-ant 72)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "RN") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (+ string-pos-ant 98 )) (equal? (substring string-juego (+ string-pos-ant 14) (+ string-pos-ant 16)) "00") (equal? (substring string-juego (+ string-pos-ant 28) (+ string-pos-ant 30)) "00") (equal? (substring string-juego (+ string-pos-ant 42) (+ string-pos-ant 44)) "00") (equal? (substring string-juego (+ string-pos-ant 56) (+ string-pos-ant 58)) "00") (equal? (substring string-juego (+ string-pos-ant 70) (+ string-pos-ant 72)) "00") (equal? (substring string-juego (+ string-pos-ant 84) (+ string-pos-ant 86)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "RN") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario imprime que es un movimiento no valido
                                                         [else ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "red") (sleep 0.6) ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "white") (busqueda (get-mouse-click juego-grafico) 80 80 0 1)]
                                                       ); fin cond
                ]; de lo contrario busca el segundo click abajo a la derecha
                [(or (equal? (+ string-pos-ant 18) string-pos) (and (< (quotient string-pos-ant 16) (quotient string-pos 16)) (< (remainder string-pos-ant 16) (remainder string-pos 16))) (equal? (+ string-pos-ant 36) string-pos) (equal? (+ string-pos-ant 54) string-pos) (equal? (+ string-pos-ant 72) string-pos) (equal? (+ string-pos-ant 90) string-pos) (equal? (+ string-pos-ant 108) string-pos) (equal? (+ string-pos-ant 126) string-pos))
                                                (cond
                                                  [(= string-pos (+ string-pos-ant 18))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "RN") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (+ string-pos-ant 36)) (equal? (substring string-juego (+ string-pos-ant 18) (+ string-pos-ant 20)) "00"))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "RN") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (+ string-pos-ant 54)) (equal? (substring string-juego (+ string-pos-ant 18) (+ string-pos-ant 20)) "00") (equal? (substring string-juego (+ string-pos-ant 36) (+ string-pos-ant 38)) "00"))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "RN") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (+ string-pos-ant 72)) (equal? (substring string-juego (+ string-pos-ant 18) (+ string-pos-ant 20)) "00") (equal? (substring string-juego (+ string-pos-ant 36) (+ string-pos-ant 38)) "00") (equal? (substring string-juego (+ string-pos-ant 54) (+ string-pos-ant 56)) "00"))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "RN") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (+ string-pos-ant 90 )) (equal? (substring string-juego (+ string-pos-ant 18) (+ string-pos-ant 20)) "00") (equal? (substring string-juego (+ string-pos-ant 36) (+ string-pos-ant 38)) "00") (equal? (substring string-juego (+ string-pos-ant 54) (+ string-pos-ant 56)) "00") (equal? (substring string-juego (+ string-pos-ant 72) (+ string-pos-ant 74)) "00"))
                                                                                              (string-copy! string-juego string-pos-ant "00")
                                                                                              (string-copy! string-juego string-pos ficha)
                                                                                              (if (equal? (jaque 0 "RN") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (+ string-pos-ant 108)) (equal? (substring string-juego (+ string-pos-ant 18) (+ string-pos-ant 20)) "00") (equal? (substring string-juego (+ string-pos-ant 36) (+ string-pos-ant 38)) "00") (equal? (substring string-juego (+ string-pos-ant 54) (+ string-pos-ant 56)) "00") (equal? (substring string-juego (+ string-pos-ant 72) (+ string-pos-ant 74)) "00") (equal? (substring string-juego (+ string-pos-ant 90) (+ string-pos-ant 92)) "00"))
                                                                                              (string-copy! string-juego string-pos-ant "00")
                                                                                              (string-copy! string-juego string-pos ficha)
                                                                                              (if (equal? (jaque 0 "RN") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (+ string-pos-ant 126)) (equal? (substring string-juego (+ string-pos-ant 18) (+ string-pos-ant 20)) "00") (equal? (substring string-juego (+ string-pos-ant 36) (+ string-pos-ant 38)) "00") (equal? (substring string-juego (+ string-pos-ant 54) (+ string-pos-ant 56)) "00") (equal? (substring string-juego (+ string-pos-ant 72) (+ string-pos-ant 74)) "00") (equal? (substring string-juego (+ string-pos-ant 90) (+ string-pos-ant 92)) "00") (equal? (substring string-juego (+ string-pos-ant 108) (+ string-pos-ant 110)) "00"))
                                                                                              (string-copy! string-juego string-pos-ant "00")
                                                                                              (string-copy! string-juego string-pos ficha)
                                                                                              (if (equal? (jaque 0 "RN") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario imprime que es un movimiento no valido
                                                  [else ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "red") (sleep 0.6) ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "white") (busqueda (get-mouse-click juego-grafico) 80 80 0 1)]
                                                ); fin cond
                ]; de lo contrario busca el segundo click arriba a la derecha
                [(or (equal? (- string-pos-ant 14) string-pos) (and (> (quotient string-pos-ant 16) (quotient string-pos 16)) (< (remainder string-pos-ant 16) (remainder string-pos 16))) (equal? (- string-pos-ant 28) string-pos) (equal? (- string-pos-ant 42) string-pos) (equal? (- string-pos-ant 56) string-pos) (equal? (- string-pos-ant 70) string-pos) (equal? (- string-pos-ant 84) string-pos) (equal? (- string-pos-ant 98) string-pos))
                                                (cond
                                                  [(= string-pos (- string-pos-ant 14))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "RN") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (- string-pos-ant 28)) (equal? (substring string-juego (- string-pos-ant 14) (- string-pos-ant 12)) "00"))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "RN") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (- string-pos-ant 42)) (equal? (substring string-juego (- string-pos-ant 14) (- string-pos-ant 12)) "00") (equal? (substring string-juego (- string-pos-ant 28) (- string-pos-ant 26)) "00"))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "RN") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (- string-pos-ant 56)) (equal? (substring string-juego (- string-pos-ant 14) (- string-pos-ant 12)) "00") (equal? (substring string-juego (- string-pos-ant 28) (- string-pos-ant 26)) "00") (equal? (substring string-juego (- string-pos-ant 42) (- string-pos-ant 40)) "00"))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "RN") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (- string-pos-ant 70)) (equal? (substring string-juego (- string-pos-ant 14) (- string-pos-ant 12)) "00") (equal? (substring string-juego (- string-pos-ant 28) (- string-pos-ant 26)) "00") (equal? (substring string-juego (- string-pos-ant 42) (- string-pos-ant 40)) "00") (equal? (substring string-juego (- string-pos-ant 56) (- string-pos-ant 54)) "00"))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "RN") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (- string-pos-ant 84)) (equal? (substring string-juego (- string-pos-ant 14) (- string-pos-ant 12)) "00") (equal? (substring string-juego (- string-pos-ant 28) (- string-pos-ant 26)) "00") (equal? (substring string-juego (- string-pos-ant 42) (- string-pos-ant 40)) "00") (equal? (substring string-juego (- string-pos-ant 56) (- string-pos-ant 54)) "00") (equal? (substring string-juego (- string-pos-ant 70) (- string-pos-ant 68)) "00"))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "RN") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (- string-pos-ant 98)) (equal? (substring string-juego (- string-pos-ant 14) (- string-pos-ant 12)) "00") (equal? (substring string-juego (- string-pos-ant 28) (- string-pos-ant 26)) "00") (equal? (substring string-juego (- string-pos-ant 42) (- string-pos-ant 40)) "00") (equal? (substring string-juego (- string-pos-ant 56) (- string-pos-ant 54)) "00") (equal? (substring string-juego (- string-pos-ant 70) (- string-pos-ant 68)) "00") (equal? (substring string-juego (- string-pos-ant 84) (- string-pos-ant 82)) "00"))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "RN") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario imprime que es un movimiento no valido
                                                  [else ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "red") (sleep 0.6) ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "white") (busqueda (get-mouse-click juego-grafico) 80 80 0 1)]
                                                ); fin cond
                ]; de lo contrario imprime que es un movimiento no valido
                [else ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "red") (sleep 0.6) ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "white") (busqueda (get-mouse-click juego-grafico) 80 80 0 1)]
              ); fin cond
          ; de lo contrario
              (begin
                ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "red") (sleep 0.6) ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "white")
                (busqueda (get-mouse-click juego-grafico) 80 80 0 1)
              ); fin begin false, el movimiento no es valido
          ); fin if, para saber si el movimiento es valido
      ; de lo contrario
          (move-alfil-negro click-mouse (if (= pixeles-x 640) 80 (+ pixeles-x 80)) (if (= pixeles-x 640) (+ pixeles-y 80) pixeles-y) pixeles-x-ant pixeles-y-ant string-pos-ant (+ string-pos 2) ficha direccion)
      ); fin if, para saber donde se dio click
  ; de lo contrario
      (if (and (and (>= (posn-x (mouse-click-posn click-mouse)) 85 ) (<= (posn-x (mouse-click-posn click-mouse)) 195)) (and (>= (posn-y (mouse-click-posn click-mouse)) 740) (<= (posn-y (mouse-click-posn click-mouse)) 758)))
          (begin
            ((draw-string juego-grafico) (make-posn 840 430) "JUEGO TERMINADO" "black")
            (string-set! string-juego-copy 127 #\-) (string-set! string-juego 127 #\-)
          ); fin begin true, se dio click en el boton de terminar
      ; de lo contrario
         (begin
           ((draw-string juego-grafico) (make-posn 840 430) "CLICK NO VALIDO" "red") (sleep 0.6) ((draw-string juego-grafico) (make-posn 840 430) "CLICK NO VALIDO" "white")
           (busqueda (get-mouse-click juego-grafico) 80 80 0 1)
         ); fin begin false, click no valido
     ); fin if, termino el juego
  ); fin if, principal
); fin definicion, movimiento del alfil negro
; Fin De La Definicion De Las Funciones Que Dan Movimiento A Los Alfiles.

; Inicio De La Definicion De Las Funciones Que Dan Movimiento A La Reina Blanca Y La Negra.
#| Identificadores Locales A La Funcion (Move Reina Blanco):
   - click-mouse: guarda la informacion acerca del ultimo olick dado
   - pixeles-x: almacena las coordenadas en x del primer cuadro del tablero, la cual va contando aumentando su valor hasta ser la del cuadro seleccionado
   - pixeles-y: almacena las coordenadas en y del primer cuadro del tablero, la cual va contando aumentando su valor hasta ser la del cuadro seleccionado
   - pixeles-x-ant: almacena las coordenadas en x donde se encuentra la ficha ya seleccionada
   - pixeles-y-ant: almacena las coordenadas en y donde se encuentra la ficha ya seleccionada
   - string-pos-ant: almacena la posicion númerica de la ficha en el string
   - string-pos: almacena un valor númerico con relacion en el string, el cual va contando hasta ser la posicion a la que se deasea llevar la ficha
   - ficha: almacena un substring que identifica la ficha especifica que se va a mover
   - direccion: guarda la dirección de la imagen que se quiere imprimir en la posicion que el usuario desea
; Definicion de la funcion para dar movimiento a la reina blanca. |#
(define (move-reina-blanco click-mouse pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant string-pos-ant string-pos ficha direccion)
  (if (and (and (>= (posn-x (mouse-click-posn click-mouse)) 80) (<= (posn-x (mouse-click-posn click-mouse)) 720)) (and (>= (posn-y (mouse-click-posn click-mouse)) 80) (<= (posn-y (mouse-click-posn click-mouse)) 720))) #| se asegura de que el click sea dentro del tablero |#
      (if (and (and (>= (posn-x (mouse-click-posn click-mouse)) pixeles-x) (<= (posn-x (mouse-click-posn click-mouse)) (+ pixeles-x 80))) (and (>= (posn-y (mouse-click-posn click-mouse)) pixeles-y) (<= (posn-y (mouse-click-posn click-mouse)) (+ pixeles-y 80))))
          (if (or (equal? (substring string-juego string-pos (+ string-pos 1)) "0") (equal? (substring string-juego string-pos (+ string-pos 1)) "P") (equal? (substring string-juego string-pos (+ string-pos 1)) "T") (equal? (substring string-juego string-pos (+ string-pos 1)) "C")  (equal? (substring string-juego string-pos (+ string-pos 1)) "A") (equal? (substring string-juego string-pos (+ string-pos 1)) "Q"))
              (cond #| condicionales en el siguiente orden: mover arriba izquierda, abajo izquierda, abajo derecha y arriba derecha |#
                ; inicio que busca el segundo click arriba a la izquierda
                [(or (equal? (- string-pos-ant 18) string-pos) (and (> (quotient string-pos-ant 16) (quotient string-pos 16)) (> (remainder string-pos-ant 16) (remainder string-pos 16))) (equal? (- string-pos-ant 36) string-pos) (equal? (- string-pos-ant 54) string-pos) (equal? (- string-pos-ant 72) string-pos) (equal? (- string-pos-ant 90) string-pos) (equal? (- string-pos-ant 108) string-pos) (equal? (- string-pos-ant 126) string-pos))
                                                       (cond
                                                         [(= string-pos (- string-pos-ant 18 ))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "rb") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (- string-pos-ant 36 )) (equal? (substring string-juego (- string-pos-ant 18) (- string-pos-ant 16)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "rb") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (- string-pos-ant 54 )) (equal? (substring string-juego (- string-pos-ant 18) (- string-pos-ant 16)) "00") (equal? (substring string-juego (- string-pos-ant 36) (- string-pos-ant 34)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "rb") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (- string-pos-ant 72 )) (equal? (substring string-juego (- string-pos-ant 18) (- string-pos-ant 16)) "00") (equal? (substring string-juego (- string-pos-ant 36) (- string-pos-ant 34)) "00") (equal? (substring string-juego (- string-pos-ant 54) (- string-pos-ant 52)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "rb") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (- string-pos-ant 90 )) (equal? (substring string-juego (- string-pos-ant 18) (- string-pos-ant 16)) "00") (equal? (substring string-juego (- string-pos-ant 36) (- string-pos-ant 34)) "00") (equal? (substring string-juego (- string-pos-ant 54) (- string-pos-ant 52)) "00") (equal? (substring string-juego (- string-pos-ant 72) (- string-pos-ant 70)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "rb") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (- string-pos-ant 108)) (equal? (substring string-juego (- string-pos-ant 18) (- string-pos-ant 16)) "00") (equal? (substring string-juego (- string-pos-ant 36) (- string-pos-ant 34)) "00") (equal? (substring string-juego (- string-pos-ant 54) (- string-pos-ant 52)) "00") (equal? (substring string-juego (- string-pos-ant 72) (- string-pos-ant 70)) "00") (equal? (substring string-juego (- string-pos-ant 90) (- string-pos-ant 88)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "rb") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (- string-pos-ant 126)) (equal? (substring string-juego (- string-pos-ant 18) (- string-pos-ant 16)) "00") (equal? (substring string-juego (- string-pos-ant 36) (- string-pos-ant 34)) "00") (equal? (substring string-juego (- string-pos-ant 54) (- string-pos-ant 52)) "00") (equal? (substring string-juego (- string-pos-ant 72) (- string-pos-ant 70)) "00") (equal? (substring string-juego (- string-pos-ant 90) (- string-pos-ant 88)) "00") (equal? (substring string-juego (- string-pos-ant 108) (- string-pos-ant 106)) "00") (equal? (substring string-juego (- string-pos-ant 126) (- string-pos-ant 124)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "rb") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario imprime que es un movimiento no valido
                                                         [else ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "red") (sleep 0.6) ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "white") (busqueda (get-mouse-click juego-grafico) 80 80 0 0)]
                                                       ); fin cond
                ]; de lo contrario busca el segundo click abajo a la izquierda
                [(or (equal? (+ string-pos-ant 14) string-pos) (and (< (quotient string-pos-ant 16) (quotient string-pos 16)) (> (remainder string-pos-ant 16) (remainder string-pos 16))) (equal? (+ string-pos-ant 28) string-pos) (equal? (+ string-pos-ant 42) string-pos) (equal? (+ string-pos-ant 56) string-pos) (equal? (+ string-pos-ant 70) string-pos) (equal? (+ string-pos-ant 84)string-pos) (equal? (+ string-pos-ant 98) string-pos))
                                                       (cond
                                                         [(= string-pos (+ string-pos-ant 14 ))
                                                                                                    (string-copy! string-juego string-pos-ant "00")
                                                                                                    (string-copy! string-juego string-pos ficha)
                                                                                                    (if (equal? (jaque 0 "rb") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (+ string-pos-ant 28 )) (equal? (substring string-juego (+ string-pos-ant 14) (+ string-pos-ant 16)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "rb") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (+ string-pos-ant 42 )) (equal? (substring string-juego (+ string-pos-ant 14) (+ string-pos-ant 16)) "00") (equal? (substring string-juego (+ string-pos-ant 28) (+ string-pos-ant 30)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "rb") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (+ string-pos-ant 56 )) (equal? (substring string-juego (+ string-pos-ant 14) (+ string-pos-ant 16)) "00") (equal? (substring string-juego (+ string-pos-ant 28) (+ string-pos-ant 30)) "00") (equal? (substring string-juego (+ string-pos-ant 42) (+ string-pos-ant 44)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "rb") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (+ string-pos-ant 70 )) (equal? (substring string-juego (+ string-pos-ant 14) (+ string-pos-ant 16)) "00") (equal? (substring string-juego (+ string-pos-ant 28) (+ string-pos-ant 30)) "00") (equal? (substring string-juego (+ string-pos-ant 42) (+ string-pos-ant 44)) "00") (equal? (substring string-juego (+ string-pos-ant 56) (+ string-pos-ant 58)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "rb") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (+ string-pos-ant 84 )) (equal? (substring string-juego (+ string-pos-ant 14) (+ string-pos-ant 16)) "00") (equal? (substring string-juego (+ string-pos-ant 28) (+ string-pos-ant 30)) "00") (equal? (substring string-juego (+ string-pos-ant 42) (+ string-pos-ant 44)) "00") (equal? (substring string-juego (+ string-pos-ant 56) (+ string-pos-ant 58)) "00") (equal? (substring string-juego (+ string-pos-ant 70) (+ string-pos-ant 72)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "rb") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (+ string-pos-ant 98 )) (equal? (substring string-juego (+ string-pos-ant 14) (+ string-pos-ant 16)) "00") (equal? (substring string-juego (+ string-pos-ant 28) (+ string-pos-ant 30)) "00") (equal? (substring string-juego (+ string-pos-ant 42) (+ string-pos-ant 44)) "00") (equal? (substring string-juego (+ string-pos-ant 56) (+ string-pos-ant 58)) "00") (equal? (substring string-juego (+ string-pos-ant 70) (+ string-pos-ant 72)) "00") (equal? (substring string-juego (+ string-pos-ant 84) (+ string-pos-ant 86)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "rb") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario imprime que es un movimiento no valido
                                                         [else ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "red") (sleep 0.6) ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "white") (busqueda (get-mouse-click juego-grafico) 80 80 0 0)]
                                                       ); fin cond
                ]; de lo contrario busca el segundo click abajo a la derecha
                [(or (equal? (+ string-pos-ant 18) string-pos) (and (< (quotient string-pos-ant 16) (quotient string-pos 16)) (< (remainder string-pos-ant 16) (remainder string-pos 16))) (equal? (+ string-pos-ant 36) string-pos) (equal? (+ string-pos-ant 54) string-pos) (equal? (+ string-pos-ant 72) string-pos) (equal? (+ string-pos-ant 90) string-pos) (equal? (+ string-pos-ant 108) string-pos) (equal? (+ string-pos-ant 126) string-pos))
                                                (cond
                                                  [(= string-pos (+ string-pos-ant 18))
                                                                                              (string-copy! string-juego string-pos-ant "00")
                                                                                              (string-copy! string-juego string-pos ficha)
                                                                                              (if (equal? (jaque 0 "rb") #t)
                                                                                                  (begin
                                                                                                    ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                    (string-copy! string-juego 0 string-juego-copy)
                                                                                                  ); fin begin true, existe jaque
                                                                                              ; de lo contrario
                                                                                                  (begin
                                                                                                    (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                  ); fin begin falee, dibuja en la ventana grafica
                                                                                              ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (+ string-pos-ant 36)) (equal? (substring string-juego (+ string-pos-ant 18) (+ string-pos-ant 20)) "00"))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "rb") #t)
                                                                                                  (begin
                                                                                                    ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                    (string-copy! string-juego 0 string-juego-copy)
                                                                                                  ); fin begin true, existe jaque
                                                                                              ; de lo contrario
                                                                                                  (begin
                                                                                                    (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                  ); fin begin falee, dibuja en la ventana grafica
                                                                                              ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (+ string-pos-ant 54)) (equal? (substring string-juego (+ string-pos-ant 18) (+ string-pos-ant 20)) "00") (equal? (substring string-juego (+ string-pos-ant 36) (+ string-pos-ant 38)) "00"))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "rb") #t)
                                                                                                  (begin
                                                                                                    ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                    (string-copy! string-juego 0 string-juego-copy)
                                                                                                  ); fin begin true, existe jaque
                                                                                              ; de lo contrario
                                                                                                  (begin
                                                                                                    (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                  ); fin begin falee, dibuja en la ventana grafica
                                                                                              ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (+ string-pos-ant 72)) (equal? (substring string-juego (+ string-pos-ant 18) (+ string-pos-ant 20)) "00") (equal? (substring string-juego (+ string-pos-ant 36) (+ string-pos-ant 38)) "00") (equal? (substring string-juego (+ string-pos-ant 54) (+ string-pos-ant 56)) "00"))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "rb") #t)
                                                                                                  (begin
                                                                                                    ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                    (string-copy! string-juego 0 string-juego-copy)
                                                                                                  ); fin begin true, existe jaque
                                                                                              ; de lo contrario
                                                                                                  (begin
                                                                                                    (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                  ); fin begin falee, dibuja en la ventana grafica
                                                                                              ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (+ string-pos-ant 90 )) (equal? (substring string-juego (+ string-pos-ant 18) (+ string-pos-ant 20)) "00") (equal? (substring string-juego (+ string-pos-ant 36) (+ string-pos-ant 38)) "00") (equal? (substring string-juego (+ string-pos-ant 54) (+ string-pos-ant 56)) "00") (equal? (substring string-juego (+ string-pos-ant 72) (+ string-pos-ant 74)) "00"))
                                                                                              (string-copy! string-juego string-pos-ant "00")
                                                                                              (string-copy! string-juego string-pos ficha)
                                                                                              (if (equal? (jaque 0 "rb") #t)
                                                                                                  (begin
                                                                                                    ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                    (string-copy! string-juego 0 string-juego-copy)
                                                                                                  ); fin begin true, existe jaque
                                                                                              ; de lo contrario
                                                                                                  (begin
                                                                                                    (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                  ); fin begin falee, dibuja en la ventana grafica
                                                                                              ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (+ string-pos-ant 108)) (equal? (substring string-juego (+ string-pos-ant 18) (+ string-pos-ant 20)) "00") (equal? (substring string-juego (+ string-pos-ant 36) (+ string-pos-ant 38)) "00") (equal? (substring string-juego (+ string-pos-ant 54) (+ string-pos-ant 56)) "00") (equal? (substring string-juego (+ string-pos-ant 72) (+ string-pos-ant 74)) "00") (equal? (substring string-juego (+ string-pos-ant 90) (+ string-pos-ant 92)) "00"))
                                                                                              (string-copy! string-juego string-pos-ant "00")
                                                                                              (string-copy! string-juego string-pos ficha)
                                                                                              (if (equal? (jaque 0 "rb") #t)
                                                                                                  (begin
                                                                                                    ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                    (string-copy! string-juego 0 string-juego-copy)
                                                                                                  ); fin begin true, existe jaque
                                                                                              ; de lo contrario
                                                                                                  (begin
                                                                                                    (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                  ); fin begin falee, dibuja en la ventana grafica
                                                                                              ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (+ string-pos-ant 126)) (equal? (substring string-juego (+ string-pos-ant 18) (+ string-pos-ant 20)) "00") (equal? (substring string-juego (+ string-pos-ant 36) (+ string-pos-ant 38)) "00") (equal? (substring string-juego (+ string-pos-ant 54) (+ string-pos-ant 56)) "00") (equal? (substring string-juego (+ string-pos-ant 72) (+ string-pos-ant 74)) "00") (equal? (substring string-juego (+ string-pos-ant 90) (+ string-pos-ant 92)) "00") (equal? (substring string-juego (+ string-pos-ant 108) (+ string-pos-ant 110)) "00"))
                                                                                              (string-copy! string-juego string-pos-ant "00")
                                                                                              (string-copy! string-juego string-pos ficha)
                                                                                              (if (equal? (jaque 0 "rb") #t)
                                                                                                  (begin
                                                                                                    ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                    (string-copy! string-juego 0 string-juego-copy)
                                                                                                  ); fin begin true, existe jaque
                                                                                              ; de lo contrario
                                                                                                  (begin
                                                                                                    (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                  ); fin begin falee, dibuja en la ventana grafica
                                                                                              ); fin if, para saber si hay jaque
                                                  ]; de lo contrario imprime que es un movimiento no valido
                                                  [else ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "red") (sleep 0.6) ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "white") (busqueda (get-mouse-click juego-grafico) 80 80 0 0)]
                                                ); fin cond
                ]; de lo contrario busca el segundo click arriba a la derecha
                [(or (equal? (- string-pos-ant 14) string-pos) (and (> (quotient string-pos-ant 16) (quotient string-pos 16)) (< (remainder string-pos-ant 16) (remainder string-pos 16))) (equal? (- string-pos-ant 28) string-pos) (equal? (- string-pos-ant 42) string-pos) (equal? (- string-pos-ant 56) string-pos) (equal? (- string-pos-ant 70) string-pos) (equal? (- string-pos-ant 84) string-pos) (equal? (- string-pos-ant 98) string-pos))
                                                (cond
                                                  [(= string-pos (- string-pos-ant 14))
                                                                                        (string-copy! string-juego string-pos-ant "00")
                                                                                        (string-copy! string-juego string-pos ficha)
                                                                                        (if (equal? (jaque 0 "rb") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (- string-pos-ant 28)) (equal? (substring string-juego (- string-pos-ant 14) (- string-pos-ant 12)) "00"))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "rb") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (- string-pos-ant 42)) (equal? (substring string-juego (- string-pos-ant 14) (- string-pos-ant 12)) "00") (equal? (substring string-juego (- string-pos-ant 28) (- string-pos-ant 26)) "00"))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "rb") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (- string-pos-ant 56)) (equal? (substring string-juego (- string-pos-ant 14) (- string-pos-ant 12)) "00") (equal? (substring string-juego (- string-pos-ant 28) (- string-pos-ant 26)) "00") (equal? (substring string-juego (- string-pos-ant 42) (- string-pos-ant 40)) "00"))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "rb") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (- string-pos-ant 70)) (equal? (substring string-juego (- string-pos-ant 14) (- string-pos-ant 12)) "00") (equal? (substring string-juego (- string-pos-ant 28) (- string-pos-ant 26)) "00") (equal? (substring string-juego (- string-pos-ant 42) (- string-pos-ant 40)) "00") (equal? (substring string-juego (- string-pos-ant 56) (- string-pos-ant 54)) "00"))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "rb") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (- string-pos-ant 84)) (equal? (substring string-juego (- string-pos-ant 14) (- string-pos-ant 12)) "00") (equal? (substring string-juego (- string-pos-ant 28) (- string-pos-ant 26)) "00") (equal? (substring string-juego (- string-pos-ant 42) (- string-pos-ant 40)) "00") (equal? (substring string-juego (- string-pos-ant 56) (- string-pos-ant 54)) "00") (equal? (substring string-juego (- string-pos-ant 70) (- string-pos-ant 68)) "00"))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "rb") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (- string-pos-ant 98)) (equal? (substring string-juego (- string-pos-ant 14) (- string-pos-ant 12)) "00") (equal? (substring string-juego (- string-pos-ant 28) (- string-pos-ant 26)) "00") (equal? (substring string-juego (- string-pos-ant 42) (- string-pos-ant 40)) "00") (equal? (substring string-juego (- string-pos-ant 56) (- string-pos-ant 54)) "00") (equal? (substring string-juego (- string-pos-ant 70) (- string-pos-ant 68)) "00") (equal? (substring string-juego (- string-pos-ant 84) (- string-pos-ant 82)) "00"))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "rb") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario imprime que es un movimiento no valido
                                                  [else ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "red") (sleep 0.6) ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "white") (busqueda (get-mouse-click juego-grafico) 80 80 0 0)]
                                                ); fin cond
                ]; de lo contrario busca en los movimientos que podria usar una torre
                [(>= (- string-pos-ant 16) string-pos) (cond
                                                         [(= string-pos (- string-pos-ant 16 ))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "rb") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (- string-pos-ant 32 )) (equal? (substring string-juego (- string-pos-ant 16) (- string-pos-ant 14)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "rb") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (- string-pos-ant 48 )) (equal? (substring string-juego (- string-pos-ant 16) (- string-pos-ant 14)) "00") (equal? (substring string-juego (- string-pos-ant 32) (- string-pos-ant 30)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "rb") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (- string-pos-ant 64 )) (equal? (substring string-juego (- string-pos-ant 16) (- string-pos-ant 14)) "00") (equal? (substring string-juego (- string-pos-ant 32) (- string-pos-ant 30)) "00") (equal? (substring string-juego (- string-pos-ant 48) (- string-pos-ant 46)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "rb") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (- string-pos-ant 80 )) (equal? (substring string-juego (- string-pos-ant 16) (- string-pos-ant 14)) "00") (equal? (substring string-juego (- string-pos-ant 32) (- string-pos-ant 30)) "00") (equal? (substring string-juego (- string-pos-ant 48) (- string-pos-ant 46)) "00") (equal? (substring string-juego (- string-pos-ant 64) (- string-pos-ant 62)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "rb") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (- string-pos-ant 96 )) (equal? (substring string-juego (- string-pos-ant 16) (- string-pos-ant 14)) "00") (equal? (substring string-juego (- string-pos-ant 32) (- string-pos-ant 30)) "00") (equal? (substring string-juego (- string-pos-ant 48) (- string-pos-ant 46)) "00") (equal? (substring string-juego (- string-pos-ant 64) (- string-pos-ant 62)) "00") (equal? (substring string-juego (- string-pos-ant 80) (- string-pos-ant 78)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "rb") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (- string-pos-ant 112)) (equal? (substring string-juego (- string-pos-ant 16) (- string-pos-ant 14)) "00") (equal? (substring string-juego (- string-pos-ant 32) (- string-pos-ant 30)) "00") (equal? (substring string-juego (- string-pos-ant 48) (- string-pos-ant 46)) "00") (equal? (substring string-juego (- string-pos-ant 64) (- string-pos-ant 62)) "00") (equal? (substring string-juego (- string-pos-ant 80) (- string-pos-ant 78)) "00") (equal? (substring string-juego (- string-pos-ant 96) (- string-pos-ant 94)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "rb") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [else ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "red") (sleep 0.6) ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "white") (busqueda (get-mouse-click juego-grafico) 80 80 0 0)]
                                                       ); fin cond
                ]; de lo contrario busca el segundo click abajo
                [(<= (+ string-pos-ant 16) string-pos) (cond
                                                         [(= string-pos (+ string-pos-ant 16 ))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "rb") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (+ string-pos-ant 32 )) (equal? (substring string-juego (+ string-pos-ant 16) (+ string-pos-ant 18)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "rb") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (+ string-pos-ant 48 )) (equal? (substring string-juego (+ string-pos-ant 16) (+ string-pos-ant 18)) "00") (equal? (substring string-juego (+ string-pos-ant 32) (+ string-pos-ant 34)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "rb") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (+ string-pos-ant 64 )) (equal? (substring string-juego (+ string-pos-ant 16) (+ string-pos-ant 18)) "00") (equal? (substring string-juego (+ string-pos-ant 32) (+ string-pos-ant 34)) "00") (equal? (substring string-juego (+ string-pos-ant 48) (+ string-pos-ant 50)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "rb") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (+ string-pos-ant 80 )) (equal? (substring string-juego (+ string-pos-ant 16) (+ string-pos-ant 18)) "00") (equal? (substring string-juego (+ string-pos-ant 32) (+ string-pos-ant 34)) "00") (equal? (substring string-juego (+ string-pos-ant 48) (+ string-pos-ant 50)) "00") (equal? (substring string-juego (+ string-pos-ant 64) (+ string-pos-ant 66)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "rb") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (+ string-pos-ant 96 )) (equal? (substring string-juego (+ string-pos-ant 16) (+ string-pos-ant 18)) "00") (equal? (substring string-juego (+ string-pos-ant 32) (+ string-pos-ant 34)) "00") (equal? (substring string-juego (+ string-pos-ant 48) (+ string-pos-ant 50)) "00") (equal? (substring string-juego (+ string-pos-ant 64) (+ string-pos-ant 66)) "00") (equal? (substring string-juego (+ string-pos-ant 80) (+ string-pos-ant 82)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "rb") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (+ string-pos-ant 112)) (equal? (substring string-juego (+ string-pos-ant 16) (+ string-pos-ant 18)) "00") (equal? (substring string-juego (+ string-pos-ant 32) (+ string-pos-ant 34)) "00") (equal? (substring string-juego (+ string-pos-ant 48) (+ string-pos-ant 50)) "00") (equal? (substring string-juego (+ string-pos-ant 64) (+ string-pos-ant 66)) "00") (equal? (substring string-juego (+ string-pos-ant 80) (+ string-pos-ant 82)) "00") (equal? (substring string-juego (+ string-pos-ant 96) (+ string-pos-ant 98)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "rb") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, para saber si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [else ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "red") (sleep 0.6) ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "white") (busqueda (get-mouse-click juego-grafico) 80 80 0 0)]
                                                       ); fin cond
                ]; de lo contrario busca el segundo click a la derecha
                [(and (<= string-pos-ant string-pos) (= (quotient string-pos-ant 16) (quotient string-pos 16)))
                                                (cond
                                                  [(= string-pos (+ string-pos-ant 2 ))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "rb") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (+ string-pos-ant 4 )) (equal? (substring string-juego (+ string-pos-ant 2) (+ string-pos-ant 4)) "00"))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "rb") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (+ string-pos-ant 6 )) (equal? (substring string-juego (+ string-pos-ant 2) (+ string-pos-ant 4)) "00") (equal? (substring string-juego (+ string-pos-ant 4) (+ string-pos-ant 6)) "00"))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "rb") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (+ string-pos-ant 8 )) (equal? (substring string-juego (+ string-pos-ant 2) (+ string-pos-ant 4)) "00") (equal? (substring string-juego (+ string-pos-ant 4) (+ string-pos-ant 6)) "00") (equal? (substring string-juego (+ string-pos-ant 6) (+ string-pos-ant 8)) "00"))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "rb") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (+ string-pos-ant 10 )) (equal? (substring string-juego (+ string-pos-ant 2) (+ string-pos-ant 4)) "00") (equal? (substring string-juego (+ string-pos-ant 4) (+ string-pos-ant 6)) "00") (equal? (substring string-juego (+ string-pos-ant 6) (+ string-pos-ant 8)) "00") (equal? (substring string-juego (+ string-pos-ant 8) (+ string-pos-ant 10)) "00"))
                                                                                              (string-copy! string-juego string-pos-ant "00")
                                                                                              (string-copy! string-juego string-pos ficha)
                                                                                              (if (equal? (jaque 0 "rb") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (+ string-pos-ant 12 )) (equal? (substring string-juego (+ string-pos-ant 2) (+ string-pos-ant 4)) "00") (equal? (substring string-juego (+ string-pos-ant 4) (+ string-pos-ant 6)) "00") (equal? (substring string-juego (+ string-pos-ant 6) (+ string-pos-ant 8)) "00") (equal? (substring string-juego (+ string-pos-ant 8) (+ string-pos-ant 10)) "00") (equal? (substring string-juego (+ string-pos-ant 10) (+ string-pos-ant 12)) "00"))
                                                                                              (string-copy! string-juego string-pos-ant "00")
                                                                                              (string-copy! string-juego string-pos ficha)
                                                                                              (if (equal? (jaque 0 "rb") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (+ string-pos-ant 14 )) (equal? (substring string-juego (+ string-pos-ant 2) (+ string-pos-ant 4)) "00") (equal? (substring string-juego (+ string-pos-ant 4) (+ string-pos-ant 6)) "00") (equal? (substring string-juego (+ string-pos-ant 6) (+ string-pos-ant 8)) "00") (equal? (substring string-juego (+ string-pos-ant 8) (+ string-pos-ant 10)) "00") (equal? (substring string-juego (+ string-pos-ant 10) (+ string-pos-ant 12)) "00") (equal? (substring string-juego (+ string-pos-ant 12) (+ string-pos-ant 14)) "00"))
                                                                                              (string-copy! string-juego string-pos-ant "00")
                                                                                              (string-copy! string-juego string-pos ficha)
                                                                                              (if (equal? (jaque 0 "rb") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [else ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "red") (sleep 0.6) ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "white") (busqueda (get-mouse-click juego-grafico) 80 80 0 0)]
                                                ); fin cond
                ]; de lo contrario busca el segundo click a la izquierda
                [(and (>= string-pos-ant string-pos) (= (quotient string-pos-ant 16) (quotient string-pos 16)))
                                                (cond
                                                  [(= string-pos (- string-pos-ant 2 ))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "rb") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (- string-pos-ant 4 )) (equal? (substring string-juego (- string-pos-ant 2) (- string-pos-ant 0)) "00"))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "rb") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (- string-pos-ant 6 )) (equal? (substring string-juego (- string-pos-ant 2) (- string-pos-ant 0)) "00") (equal? (substring string-juego (- string-pos-ant 4) (- string-pos-ant 2)) "00"))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "rb") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (- string-pos-ant 8 )) (equal? (substring string-juego (- string-pos-ant 2) (- string-pos-ant 0)) "00") (equal? (substring string-juego (- string-pos-ant 4) (- string-pos-ant 2)) "00") (equal? (substring string-juego (- string-pos-ant 6) (- string-pos-ant 4)) "00"))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "rb") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (- string-pos-ant 10)) (equal? (substring string-juego (- string-pos-ant 2) (- string-pos-ant 0)) "00") (equal? (substring string-juego (- string-pos-ant 4) (- string-pos-ant 2)) "00") (equal? (substring string-juego (- string-pos-ant 6) (- string-pos-ant 4)) "00") (equal? (substring string-juego (- string-pos-ant 8) (- string-pos-ant 6)) "00"))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "rb") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (- string-pos-ant 12)) (equal? (substring string-juego (- string-pos-ant 2) (- string-pos-ant 0)) "00") (equal? (substring string-juego (- string-pos-ant 4) (- string-pos-ant 2)) "00") (equal? (substring string-juego (- string-pos-ant 6) (- string-pos-ant 4)) "00") (equal? (substring string-juego (- string-pos-ant 8) (- string-pos-ant 6)) "00") (equal? (substring string-juego (- string-pos-ant 10) (- string-pos-ant 8)) "00"))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "rb") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (- string-pos-ant 14)) (equal? (substring string-juego (- string-pos-ant 2) (- string-pos-ant 0)) "00") (equal? (substring string-juego (- string-pos-ant 4) (- string-pos-ant 2)) "00") (equal? (substring string-juego (- string-pos-ant 6) (- string-pos-ant 4)) "00") (equal? (substring string-juego (- string-pos-ant 8) (- string-pos-ant 6)) "00") (equal? (substring string-juego (- string-pos-ant 10) (- string-pos-ant 8)) "00") (equal? (substring string-juego (- string-pos-ant 12) (- string-pos-ant 10)) "00"))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "rb") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, para saber si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [else ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "red") (sleep 0.6) ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "white") (busqueda (get-mouse-click juego-grafico) 80 80 0 0)]
                                                ); fin cond
                ]; de lo contrario imprime que es un movimiento no valido
                [else ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "red") (sleep 0.6) ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "white") (busqueda (get-mouse-click juego-grafico) 80 80 0 0)]
              ); fin cond
          ; de lo contrario
              (begin
                ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "red") (sleep 0.6) ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "white")
                (busqueda (get-mouse-click juego-grafico) 80 80 0 0)
              ); fin begin false, el movimiento no es valido
          ); fin if, para saber si el movimiento es valido
      ; de lo contrario
          (move-reina-blanco click-mouse (if (= pixeles-x 640) 80 (+ pixeles-x 80)) (if (= pixeles-x 640) (+ pixeles-y 80) pixeles-y) pixeles-x-ant pixeles-y-ant string-pos-ant (+ string-pos 2) ficha direccion)
      ); fin if, para saber donde se dio click
  ; de lo contrario
      (if (and (and (>= (posn-x (mouse-click-posn click-mouse)) 85 ) (<= (posn-x (mouse-click-posn click-mouse)) 195)) (and (>= (posn-y (mouse-click-posn click-mouse)) 740) (<= (posn-y (mouse-click-posn click-mouse)) 758)))
          (begin
            ((draw-string juego-grafico) (make-posn 840 430) "JUEGO TERMINADO" "black")
            (string-set! string-juego-copy 127 #\-) (string-set! string-juego 127 #\-)
          ); fin begin true, se dio click en el boton de terminar
      ; de lo contrario
         (begin
           ((draw-string juego-grafico) (make-posn 840 430) "CLICK NO VALIDO" "red") (sleep 0.6) ((draw-string juego-grafico) (make-posn 840 430) "CLICK NO VALIDO" "white")
           (busqueda (get-mouse-click juego-grafico) 80 80 0 0)
         ); fin begin false, se dio un click no valido
     ); fin if, termino el juego
  ); fin if, principal
); fin definicion, movimiento de la reina blanca

#| Identificadores Locales A La Funcion (Move Reina Negro):
   - click-mouse: guarda la informacion acerca del ultimo olick dado
   - pixeles-x: almacena las coordenadas en x del primer cuadro del tablero, la cual va contando aumentando su valor hasta ser la del cuadro seleccionado
   - pixeles-y: almacena las coordenadas en y del primer cuadro del tablero, la cual va contando aumentando su valor hasta ser la del cuadro seleccionado
   - pixeles-x-ant: almacena las coordenadas en x donde se encuentra la ficha ya seleccionada
   - pixeles-y-ant: almacena las coordenadas en y donde se encuentra la ficha ya seleccionada
   - string-pos-ant: almacena la posicion númerica de la ficha en el string
   - string-pos: almacena un valor númerico con relacion en el string, el cual va contando hasta ser la posicion a la que se deasea llevar la ficha
   - ficha: almacena un substring que identifica la ficha especifica que se va a mover
   - direccion: guarda la dirección de la imagen que se quiere imprimir en la posicion que el usuario desea
; Definicion de la funcion para dar movimiento a la reina negro. |#
(define (move-reina-negro click-mouse pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant string-pos-ant string-pos ficha direccion)
  (if (and (and (>= (posn-x (mouse-click-posn click-mouse)) 80) (<= (posn-x (mouse-click-posn click-mouse)) 720)) (and (>= (posn-y (mouse-click-posn click-mouse)) 80) (<= (posn-y (mouse-click-posn click-mouse)) 720))) #| se asegura de que el click sea dentro del tablero |#
      (if (and (and (>= (posn-x (mouse-click-posn click-mouse)) pixeles-x) (<= (posn-x (mouse-click-posn click-mouse)) (+ pixeles-x 80))) (and (>= (posn-y (mouse-click-posn click-mouse)) pixeles-y) (<= (posn-y (mouse-click-posn click-mouse)) (+ pixeles-y 80))))
          (if (or (equal? (substring string-juego string-pos (+ string-pos 1)) "0") (equal? (substring string-juego string-pos (+ string-pos 1)) "p") (equal? (substring string-juego string-pos (+ string-pos 1)) "t") (equal? (substring string-juego string-pos (+ string-pos 1)) "c")  (equal? (substring string-juego string-pos (+ string-pos 1)) "a") (equal? (substring string-juego string-pos (+ string-pos 1)) "q"))
              (cond #| condicionales en el siguiente orden: mover arriba izquierda, abajo izquierda, abajo derecha y arriba derecha |#
                ; inicio que busca el segundo click arriba a la izquierda
                [(or (equal? (- string-pos-ant 18) string-pos) (and (> (quotient string-pos-ant 16) (quotient string-pos 16)) (> (remainder string-pos-ant 16) (remainder string-pos 16))) (equal? (- string-pos-ant 36) string-pos) (equal? (- string-pos-ant 54) string-pos) (equal? (- string-pos-ant 72) string-pos) (equal? (- string-pos-ant 90) string-pos) (equal? (- string-pos-ant 108) string-pos) (equal? (- string-pos-ant 126) string-pos))
                                                       (cond
                                                         [(= string-pos (- string-pos-ant 18 ))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "RN") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, analiza si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (- string-pos-ant 36 )) (equal? (substring string-juego (- string-pos-ant 18) (- string-pos-ant 16)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "RN") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, analiza si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (- string-pos-ant 54 )) (equal? (substring string-juego (- string-pos-ant 18) (- string-pos-ant 16)) "00") (equal? (substring string-juego (- string-pos-ant 36) (- string-pos-ant 34)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "RN") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, analiza si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (- string-pos-ant 72 )) (equal? (substring string-juego (- string-pos-ant 18) (- string-pos-ant 16)) "00") (equal? (substring string-juego (- string-pos-ant 36) (- string-pos-ant 34)) "00") (equal? (substring string-juego (- string-pos-ant 54) (- string-pos-ant 52)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "RN") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, analiza si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (- string-pos-ant 90 )) (equal? (substring string-juego (- string-pos-ant 18) (- string-pos-ant 16)) "00") (equal? (substring string-juego (- string-pos-ant 36) (- string-pos-ant 34)) "00") (equal? (substring string-juego (- string-pos-ant 54) (- string-pos-ant 52)) "00") (equal? (substring string-juego (- string-pos-ant 72) (- string-pos-ant 70)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "RN") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, analiza si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (- string-pos-ant 108)) (equal? (substring string-juego (- string-pos-ant 18) (- string-pos-ant 16)) "00") (equal? (substring string-juego (- string-pos-ant 36) (- string-pos-ant 34)) "00") (equal? (substring string-juego (- string-pos-ant 54) (- string-pos-ant 52)) "00") (equal? (substring string-juego (- string-pos-ant 72) (- string-pos-ant 70)) "00") (equal? (substring string-juego (- string-pos-ant 90) (- string-pos-ant 88)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "RN") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, analiza si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (- string-pos-ant 126)) (equal? (substring string-juego (- string-pos-ant 18) (- string-pos-ant 16)) "00") (equal? (substring string-juego (- string-pos-ant 36) (- string-pos-ant 34)) "00") (equal? (substring string-juego (- string-pos-ant 54) (- string-pos-ant 52)) "00") (equal? (substring string-juego (- string-pos-ant 72) (- string-pos-ant 70)) "00") (equal? (substring string-juego (- string-pos-ant 90) (- string-pos-ant 88)) "00") (equal? (substring string-juego (- string-pos-ant 108) (- string-pos-ant 106)) "00") (equal? (substring string-juego (- string-pos-ant 126) (- string-pos-ant 124)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "RN") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, analiza si hay jaque
                                                         ]; de lo contrario imprime que es un movimiento no valido
                                                         [else ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "red") (sleep 0.6) ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "white") (busqueda (get-mouse-click juego-grafico) 80 80 0 1)]
                                                       ); fin cond
                ]; de lo contrario busca el segundo click abajo a la izquierda
                [(or (equal? (+ string-pos-ant 14) string-pos) (and (< (quotient string-pos-ant 16) (quotient string-pos 16)) (> (remainder string-pos-ant 16) (remainder string-pos 16))) (equal? (+ string-pos-ant 28) string-pos) (equal? (+ string-pos-ant 42) string-pos) (equal? (+ string-pos-ant 56) string-pos) (equal? (+ string-pos-ant 70) string-pos) (equal? (+ string-pos-ant 84)string-pos) (equal? (+ string-pos-ant 98) string-pos))
                                                       (cond
                                                         [(= string-pos (+ string-pos-ant 14 ))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "RN") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, analiza si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (+ string-pos-ant 28 )) (equal? (substring string-juego (+ string-pos-ant 14) (+ string-pos-ant 16)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "RN") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, analiza si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (+ string-pos-ant 42 )) (equal? (substring string-juego (+ string-pos-ant 14) (+ string-pos-ant 16)) "00") (equal? (substring string-juego (+ string-pos-ant 28) (+ string-pos-ant 30)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "RN") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, analiza si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (+ string-pos-ant 56 )) (equal? (substring string-juego (+ string-pos-ant 14) (+ string-pos-ant 16)) "00") (equal? (substring string-juego (+ string-pos-ant 28) (+ string-pos-ant 30)) "00") (equal? (substring string-juego (+ string-pos-ant 42) (+ string-pos-ant 44)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "RN") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, analiza si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (+ string-pos-ant 70 )) (equal? (substring string-juego (+ string-pos-ant 14) (+ string-pos-ant 16)) "00") (equal? (substring string-juego (+ string-pos-ant 28) (+ string-pos-ant 30)) "00") (equal? (substring string-juego (+ string-pos-ant 42) (+ string-pos-ant 44)) "00") (equal? (substring string-juego (+ string-pos-ant 56) (+ string-pos-ant 58)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "RN") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, analiza si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (+ string-pos-ant 84 )) (equal? (substring string-juego (+ string-pos-ant 14) (+ string-pos-ant 16)) "00") (equal? (substring string-juego (+ string-pos-ant 28) (+ string-pos-ant 30)) "00") (equal? (substring string-juego (+ string-pos-ant 42) (+ string-pos-ant 44)) "00") (equal? (substring string-juego (+ string-pos-ant 56) (+ string-pos-ant 58)) "00") (equal? (substring string-juego (+ string-pos-ant 70) (+ string-pos-ant 72)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "RN") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, analiza si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (+ string-pos-ant 98 )) (equal? (substring string-juego (+ string-pos-ant 14) (+ string-pos-ant 16)) "00") (equal? (substring string-juego (+ string-pos-ant 28) (+ string-pos-ant 30)) "00") (equal? (substring string-juego (+ string-pos-ant 42) (+ string-pos-ant 44)) "00") (equal? (substring string-juego (+ string-pos-ant 56) (+ string-pos-ant 58)) "00") (equal? (substring string-juego (+ string-pos-ant 70) (+ string-pos-ant 72)) "00") (equal? (substring string-juego (+ string-pos-ant 84) (+ string-pos-ant 86)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "RN") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, analiza si hay jaque
                                                         ]; de lo contrario imprime que es un movimiento no valido
                                                         [else ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "red") (sleep 0.6) ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "white") (busqueda (get-mouse-click juego-grafico) 80 80 0 1)]
                                                       ); fin cond
                ]; de lo contrario busca el segundo click abajo a la derecha
                [(or (equal? (+ string-pos-ant 18) string-pos) (and (< (quotient string-pos-ant 16) (quotient string-pos 16)) (< (remainder string-pos-ant 16) (remainder string-pos 16))) (equal? (+ string-pos-ant 36) string-pos) (equal? (+ string-pos-ant 54) string-pos) (equal? (+ string-pos-ant 72) string-pos) (equal? (+ string-pos-ant 90) string-pos) (equal? (+ string-pos-ant 108) string-pos) (equal? (+ string-pos-ant 126) string-pos))
                                                (cond
                                                  [(= string-pos (+ string-pos-ant 18))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "RN") #t)
                                                                                                 (begin
                                                                                                  ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                  ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                  (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, analiza si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (+ string-pos-ant 36)) (equal? (substring string-juego (+ string-pos-ant 18) (+ string-pos-ant 20)) "00"))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "RN") #t)
                                                                                                 (begin
                                                                                                  ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                  ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                  (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, analiza si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (+ string-pos-ant 54)) (equal? (substring string-juego (+ string-pos-ant 18) (+ string-pos-ant 20)) "00") (equal? (substring string-juego (+ string-pos-ant 36) (+ string-pos-ant 38)) "00"))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "RN") #t)
                                                                                                 (begin
                                                                                                  ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                  ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                  (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, analiza si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (+ string-pos-ant 72)) (equal? (substring string-juego (+ string-pos-ant 18) (+ string-pos-ant 20)) "00") (equal? (substring string-juego (+ string-pos-ant 36) (+ string-pos-ant 38)) "00") (equal? (substring string-juego (+ string-pos-ant 54) (+ string-pos-ant 56)) "00"))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "RN") #t)
                                                                                                 (begin
                                                                                                  ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                  ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                  (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, analiza si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (+ string-pos-ant 90 )) (equal? (substring string-juego (+ string-pos-ant 18) (+ string-pos-ant 20)) "00") (equal? (substring string-juego (+ string-pos-ant 36) (+ string-pos-ant 38)) "00") (equal? (substring string-juego (+ string-pos-ant 54) (+ string-pos-ant 56)) "00") (equal? (substring string-juego (+ string-pos-ant 72) (+ string-pos-ant 74)) "00"))
                                                                                              (string-copy! string-juego string-pos-ant "00")
                                                                                              (string-copy! string-juego string-pos ficha)
                                                                                              (if (equal? (jaque 0 "RN") #t)
                                                                                                 (begin
                                                                                                  ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                  ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                  (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, analiza si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (+ string-pos-ant 108)) (equal? (substring string-juego (+ string-pos-ant 18) (+ string-pos-ant 20)) "00") (equal? (substring string-juego (+ string-pos-ant 36) (+ string-pos-ant 38)) "00") (equal? (substring string-juego (+ string-pos-ant 54) (+ string-pos-ant 56)) "00") (equal? (substring string-juego (+ string-pos-ant 72) (+ string-pos-ant 74)) "00") (equal? (substring string-juego (+ string-pos-ant 90) (+ string-pos-ant 92)) "00"))
                                                                                              (string-copy! string-juego string-pos-ant "00")
                                                                                              (string-copy! string-juego string-pos ficha)
                                                                                              (if (equal? (jaque 0 "RN") #t)
                                                                                                 (begin
                                                                                                  ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                  ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                  (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, analiza si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (+ string-pos-ant 126)) (equal? (substring string-juego (+ string-pos-ant 18) (+ string-pos-ant 20)) "00") (equal? (substring string-juego (+ string-pos-ant 36) (+ string-pos-ant 38)) "00") (equal? (substring string-juego (+ string-pos-ant 54) (+ string-pos-ant 56)) "00") (equal? (substring string-juego (+ string-pos-ant 72) (+ string-pos-ant 74)) "00") (equal? (substring string-juego (+ string-pos-ant 90) (+ string-pos-ant 92)) "00") (equal? (substring string-juego (+ string-pos-ant 108) (+ string-pos-ant 110)) "00"))
                                                                                              (string-copy! string-juego string-pos-ant "00")
                                                                                              (string-copy! string-juego string-pos ficha)
                                                                                              (if (equal? (jaque 0 "RN") #t)
                                                                                                 (begin
                                                                                                  ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                  ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                  (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, analiza si hay jaque
                                                  ]; de lo contrario imprime que es un movimiento no valido
                                                  [else ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "red") (sleep 0.6) ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "white") (busqueda (get-mouse-click juego-grafico) 80 80 0 1)]
                                                ); fin cond
                ]; de lo contrario busca el segundo click arriba a la derecha
                [(or (equal? (- string-pos-ant 14) string-pos) (and (> (quotient string-pos-ant 16) (quotient string-pos 16)) (< (remainder string-pos-ant 16) (remainder string-pos 16))) (equal? (- string-pos-ant 28) string-pos) (equal? (- string-pos-ant 42) string-pos) (equal? (- string-pos-ant 56) string-pos) (equal? (- string-pos-ant 70) string-pos) (equal? (- string-pos-ant 84) string-pos) (equal? (- string-pos-ant 98) string-pos))
                                                (cond
                                                  [(= string-pos (- string-pos-ant 14))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "RN") #t)
                                                                                                 (begin
                                                                                                  ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                  ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                  (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, analiza si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (- string-pos-ant 28)) (equal? (substring string-juego (- string-pos-ant 14) (- string-pos-ant 12)) "00"))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "RN") #t)
                                                                                                 (begin
                                                                                                  ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                  ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                  (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, analiza si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (- string-pos-ant 42)) (equal? (substring string-juego (- string-pos-ant 14) (- string-pos-ant 12)) "00") (equal? (substring string-juego (- string-pos-ant 28) (- string-pos-ant 26)) "00"))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "RN") #t)
                                                                                                 (begin
                                                                                                  ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                  ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                  (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, analiza si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (- string-pos-ant 56)) (equal? (substring string-juego (- string-pos-ant 14) (- string-pos-ant 12)) "00") (equal? (substring string-juego (- string-pos-ant 28) (- string-pos-ant 26)) "00") (equal? (substring string-juego (- string-pos-ant 42) (- string-pos-ant 40)) "00"))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "RN") #t)
                                                                                                 (begin
                                                                                                  ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                  ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                  (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, analiza si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (- string-pos-ant 70)) (equal? (substring string-juego (- string-pos-ant 14) (- string-pos-ant 12)) "00") (equal? (substring string-juego (- string-pos-ant 28) (- string-pos-ant 26)) "00") (equal? (substring string-juego (- string-pos-ant 42) (- string-pos-ant 40)) "00") (equal? (substring string-juego (- string-pos-ant 56) (- string-pos-ant 54)) "00"))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "RN") #t)
                                                                                                 (begin
                                                                                                  ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                  ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                  (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, analiza si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (- string-pos-ant 84)) (equal? (substring string-juego (- string-pos-ant 14) (- string-pos-ant 12)) "00") (equal? (substring string-juego (- string-pos-ant 28) (- string-pos-ant 26)) "00") (equal? (substring string-juego (- string-pos-ant 42) (- string-pos-ant 40)) "00") (equal? (substring string-juego (- string-pos-ant 56) (- string-pos-ant 54)) "00") (equal? (substring string-juego (- string-pos-ant 70) (- string-pos-ant 68)) "00"))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "RN") #t)
                                                                                                 (begin
                                                                                                  ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                  ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                  (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, analiza si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (- string-pos-ant 98)) (equal? (substring string-juego (- string-pos-ant 14) (- string-pos-ant 12)) "00") (equal? (substring string-juego (- string-pos-ant 28) (- string-pos-ant 26)) "00") (equal? (substring string-juego (- string-pos-ant 42) (- string-pos-ant 40)) "00") (equal? (substring string-juego (- string-pos-ant 56) (- string-pos-ant 54)) "00") (equal? (substring string-juego (- string-pos-ant 70) (- string-pos-ant 68)) "00") (equal? (substring string-juego (- string-pos-ant 84) (- string-pos-ant 82)) "00"))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "RN") #t)
                                                                                                 (begin
                                                                                                  ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                  ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                  (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, analiza si hay jaque
                                                  ]; de lo contrario imprime que es un movimiento no valido
                                                  [else ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "red") (sleep 0.6) ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "white") (busqueda (get-mouse-click juego-grafico) 80 80 0 1)]
                                                ); fin cond
                ]; de lo contrario busca en los movimientos que podria usar una torre
                [(>= (- string-pos-ant 16) string-pos) (cond
                                                         [(= string-pos (- string-pos-ant 16 ))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "RN") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, analiza si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (- string-pos-ant 32 )) (equal? (substring string-juego (- string-pos-ant 16) (- string-pos-ant 14)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "RN") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, analiza si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (- string-pos-ant 48 )) (equal? (substring string-juego (- string-pos-ant 16) (- string-pos-ant 14)) "00") (equal? (substring string-juego (- string-pos-ant 32) (- string-pos-ant 30)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "RN") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, analiza si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (- string-pos-ant 64 )) (equal? (substring string-juego (- string-pos-ant 16) (- string-pos-ant 14)) "00") (equal? (substring string-juego (- string-pos-ant 32) (- string-pos-ant 30)) "00") (equal? (substring string-juego (- string-pos-ant 48) (- string-pos-ant 46)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "RN") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, analiza si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (- string-pos-ant 80 )) (equal? (substring string-juego (- string-pos-ant 16) (- string-pos-ant 14)) "00") (equal? (substring string-juego (- string-pos-ant 32) (- string-pos-ant 30)) "00") (equal? (substring string-juego (- string-pos-ant 48) (- string-pos-ant 46)) "00") (equal? (substring string-juego (- string-pos-ant 64) (- string-pos-ant 62)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "RN") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, analiza si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (- string-pos-ant 96 )) (equal? (substring string-juego (- string-pos-ant 16) (- string-pos-ant 14)) "00") (equal? (substring string-juego (- string-pos-ant 32) (- string-pos-ant 30)) "00") (equal? (substring string-juego (- string-pos-ant 48) (- string-pos-ant 46)) "00") (equal? (substring string-juego (- string-pos-ant 64) (- string-pos-ant 62)) "00") (equal? (substring string-juego (- string-pos-ant 80) (- string-pos-ant 78)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "RN") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, analiza si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (- string-pos-ant 112)) (equal? (substring string-juego (- string-pos-ant 16) (- string-pos-ant 14)) "00") (equal? (substring string-juego (- string-pos-ant 32) (- string-pos-ant 30)) "00") (equal? (substring string-juego (- string-pos-ant 48) (- string-pos-ant 46)) "00") (equal? (substring string-juego (- string-pos-ant 64) (- string-pos-ant 62)) "00") (equal? (substring string-juego (- string-pos-ant 80) (- string-pos-ant 78)) "00") (equal? (substring string-juego (- string-pos-ant 96) (- string-pos-ant 94)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "RN") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, analiza si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [else ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "red") (sleep 0.6) ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "white") (busqueda (get-mouse-click juego-grafico) 80 80 0 1)]
                                                       ); fin cond
                ]; de lo contrario busca el segundo click abajo
                [(<= (+ string-pos-ant 16) string-pos) (cond
                                                         [(= string-pos (+ string-pos-ant 16 ))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "RN") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, analiza si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (+ string-pos-ant 32 )) (equal? (substring string-juego (+ string-pos-ant 16) (+ string-pos-ant 18)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "RN") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, analiza si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (+ string-pos-ant 48 )) (equal? (substring string-juego (+ string-pos-ant 16) (+ string-pos-ant 18)) "00") (equal? (substring string-juego (+ string-pos-ant 32) (+ string-pos-ant 34)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "RN") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, analiza si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (+ string-pos-ant 64 )) (equal? (substring string-juego (+ string-pos-ant 16) (+ string-pos-ant 18)) "00") (equal? (substring string-juego (+ string-pos-ant 32) (+ string-pos-ant 34)) "00") (equal? (substring string-juego (+ string-pos-ant 48) (+ string-pos-ant 50)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "RN") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, analiza si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (+ string-pos-ant 80 )) (equal? (substring string-juego (+ string-pos-ant 16) (+ string-pos-ant 18)) "00") (equal? (substring string-juego (+ string-pos-ant 32) (+ string-pos-ant 34)) "00") (equal? (substring string-juego (+ string-pos-ant 48) (+ string-pos-ant 50)) "00") (equal? (substring string-juego (+ string-pos-ant 64) (+ string-pos-ant 66)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "RN") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, analiza si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (+ string-pos-ant 96 )) (equal? (substring string-juego (+ string-pos-ant 16) (+ string-pos-ant 18)) "00") (equal? (substring string-juego (+ string-pos-ant 32) (+ string-pos-ant 34)) "00") (equal? (substring string-juego (+ string-pos-ant 48) (+ string-pos-ant 50)) "00") (equal? (substring string-juego (+ string-pos-ant 64) (+ string-pos-ant 66)) "00") (equal? (substring string-juego (+ string-pos-ant 80) (+ string-pos-ant 82)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "RN") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, analiza si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [(and (= string-pos (+ string-pos-ant 112)) (equal? (substring string-juego (+ string-pos-ant 16) (+ string-pos-ant 18)) "00") (equal? (substring string-juego (+ string-pos-ant 32) (+ string-pos-ant 34)) "00") (equal? (substring string-juego (+ string-pos-ant 48) (+ string-pos-ant 50)) "00") (equal? (substring string-juego (+ string-pos-ant 64) (+ string-pos-ant 66)) "00") (equal? (substring string-juego (+ string-pos-ant 80) (+ string-pos-ant 82)) "00") (equal? (substring string-juego (+ string-pos-ant 96) (+ string-pos-ant 98)) "00"))
                                                                                                     (string-copy! string-juego string-pos-ant "00")
                                                                                                     (string-copy! string-juego string-pos ficha)
                                                                                                     (if (equal? (jaque 0 "RN") #t)
                                                                                                         (begin
                                                                                                           ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                           (string-copy! string-juego 0 string-juego-copy)
                                                                                                         ); fin begin true, existe jaque
                                                                                                     ; de lo contrario
                                                                                                         (begin
                                                                                                           (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                         ); fin begin falee, dibuja en la ventana grafica
                                                                                                     ); fin if, analiza si hay jaque
                                                         ]; de lo contrario va mas lejos
                                                         [else ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "red") (sleep 0.6) ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "white") (busqueda (get-mouse-click juego-grafico) 80 80 0 1)]
                                                       ); fin cond
                ]; de lo contrario busca el segundo click a la derecha
                [(and (<= string-pos-ant string-pos) (= (quotient string-pos-ant 16) (quotient string-pos 16)))
                                                (cond
                                                  [(= string-pos (+ string-pos-ant 2 ))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "RN") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, analiza si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (+ string-pos-ant 4 )) (equal? (substring string-juego (+ string-pos-ant 2) (+ string-pos-ant 4)) "00"))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "RN") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, analiza si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (+ string-pos-ant 6 )) (equal? (substring string-juego (+ string-pos-ant 2) (+ string-pos-ant 4)) "00") (equal? (substring string-juego (+ string-pos-ant 4) (+ string-pos-ant 6)) "00"))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "RN") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, analiza si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (+ string-pos-ant 8 )) (equal? (substring string-juego (+ string-pos-ant 2) (+ string-pos-ant 4)) "00") (equal? (substring string-juego (+ string-pos-ant 4) (+ string-pos-ant 6)) "00") (equal? (substring string-juego (+ string-pos-ant 6) (+ string-pos-ant 8)) "00"))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "RN") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, analiza si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (+ string-pos-ant 10 )) (equal? (substring string-juego (+ string-pos-ant 2) (+ string-pos-ant 4)) "00") (equal? (substring string-juego (+ string-pos-ant 4) (+ string-pos-ant 6)) "00") (equal? (substring string-juego (+ string-pos-ant 6) (+ string-pos-ant 8)) "00") (equal? (substring string-juego (+ string-pos-ant 8) (+ string-pos-ant 10)) "00"))
                                                                                              (string-copy! string-juego string-pos-ant "00")
                                                                                              (string-copy! string-juego string-pos ficha)
                                                                                              (if (equal? (jaque 0 "RN") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, analiza si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (+ string-pos-ant 12 )) (equal? (substring string-juego (+ string-pos-ant 2) (+ string-pos-ant 4)) "00") (equal? (substring string-juego (+ string-pos-ant 4) (+ string-pos-ant 6)) "00") (equal? (substring string-juego (+ string-pos-ant 6) (+ string-pos-ant 8)) "00") (equal? (substring string-juego (+ string-pos-ant 8) (+ string-pos-ant 10)) "00") (equal? (substring string-juego (+ string-pos-ant 10) (+ string-pos-ant 12)) "00"))
                                                                                              (string-copy! string-juego string-pos-ant "00")
                                                                                              (string-copy! string-juego string-pos ficha)
                                                                                              (if (equal? (jaque 0 "RN") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, analiza si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (+ string-pos-ant 14 )) (equal? (substring string-juego (+ string-pos-ant 2) (+ string-pos-ant 4)) "00") (equal? (substring string-juego (+ string-pos-ant 4) (+ string-pos-ant 6)) "00") (equal? (substring string-juego (+ string-pos-ant 6) (+ string-pos-ant 8)) "00") (equal? (substring string-juego (+ string-pos-ant 8) (+ string-pos-ant 10)) "00") (equal? (substring string-juego (+ string-pos-ant 10) (+ string-pos-ant 12)) "00") (equal? (substring string-juego (+ string-pos-ant 12) (+ string-pos-ant 14)) "00"))
                                                                                              (string-copy! string-juego string-pos-ant "00")
                                                                                              (string-copy! string-juego string-pos ficha)
                                                                                              (if (equal? (jaque 0 "RN") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, analiza si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [else ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "red") (sleep 0.6) ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "white") (busqueda (get-mouse-click juego-grafico) 80 80 0 1)]
                                                ); fin cond
                ]; de lo contrario busca el segundo click a la izquierda
                [(and (>= string-pos-ant string-pos)  (= (quotient string-pos-ant 16) (quotient string-pos 16)))
                                                (cond
                                                  [(= string-pos (- string-pos-ant 2 ))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "RN") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, analiza si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (- string-pos-ant 4 )) (equal? (substring string-juego (- string-pos-ant 2) (- string-pos-ant 0)) "00"))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "RN") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, analiza si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (- string-pos-ant 6 )) (equal? (substring string-juego (- string-pos-ant 2) (- string-pos-ant 0)) "00") (equal? (substring string-juego (- string-pos-ant 4) (- string-pos-ant 2)) "00"))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "RN") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, analiza si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (- string-pos-ant 8 )) (equal? (substring string-juego (- string-pos-ant 2) (- string-pos-ant 0)) "00") (equal? (substring string-juego (- string-pos-ant 4) (- string-pos-ant 2)) "00") (equal? (substring string-juego (- string-pos-ant 6) (- string-pos-ant 4)) "00"))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "RN") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, analiza si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (- string-pos-ant 10)) (equal? (substring string-juego (- string-pos-ant 2) (- string-pos-ant 0)) "00") (equal? (substring string-juego (- string-pos-ant 4) (- string-pos-ant 2)) "00") (equal? (substring string-juego (- string-pos-ant 6) (- string-pos-ant 4)) "00") (equal? (substring string-juego (- string-pos-ant 8) (- string-pos-ant 6)) "00"))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "RN") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, analiza si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (- string-pos-ant 12)) (equal? (substring string-juego (- string-pos-ant 2) (- string-pos-ant 0)) "00") (equal? (substring string-juego (- string-pos-ant 4) (- string-pos-ant 2)) "00") (equal? (substring string-juego (- string-pos-ant 6) (- string-pos-ant 4)) "00") (equal? (substring string-juego (- string-pos-ant 8) (- string-pos-ant 6)) "00") (equal? (substring string-juego (- string-pos-ant 10) (- string-pos-ant 8)) "00"))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "RN") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, analiza si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [(and (= string-pos (- string-pos-ant 14)) (equal? (substring string-juego (- string-pos-ant 2) (- string-pos-ant 0)) "00") (equal? (substring string-juego (- string-pos-ant 4) (- string-pos-ant 2)) "00") (equal? (substring string-juego (- string-pos-ant 6) (- string-pos-ant 4)) "00") (equal? (substring string-juego (- string-pos-ant 8) (- string-pos-ant 6)) "00") (equal? (substring string-juego (- string-pos-ant 10) (- string-pos-ant 8)) "00") (equal? (substring string-juego (- string-pos-ant 12) (- string-pos-ant 10)) "00"))
                                                                                             (string-copy! string-juego string-pos-ant "00")
                                                                                             (string-copy! string-juego string-pos ficha)
                                                                                             (if (equal? (jaque 0 "RN") #t)
                                                                                                 (begin
                                                                                                   ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                                                   (string-copy! string-juego 0 string-juego-copy)
                                                                                                 ); fin begin true, existe jaque
                                                                                             ; de lo contrario
                                                                                                 (begin
                                                                                                   (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                                                                 ); fin begin falee, dibuja en la ventana grafica
                                                                                             ); fin if, analiza si hay jaque
                                                  ]; de lo contrario va mas lejos
                                                  [else ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "red") (sleep 0.6) ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "white") (busqueda (get-mouse-click juego-grafico) 80 80 0 1)]
                                                ); fin cond
                ]; de lo contrario imprime que es un movimiento no valido
                [else ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "red") (sleep 0.6) ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "white") (busqueda (get-mouse-click juego-grafico) 80 80 0 1)]
              ); fin cond
          ; de lo contrario
              (begin
                ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "red") (sleep 0.6) ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "white")
                (busqueda (get-mouse-click juego-grafico) 80 80 0 1)
              ); fin begin false, el movimiento no es valido
          ); fin if, para saber si el movimiento es valido
      ; de lo contrario
          (move-reina-negro click-mouse (if (= pixeles-x 640) 80 (+ pixeles-x 80)) (if (= pixeles-x 640) (+ pixeles-y 80) pixeles-y) pixeles-x-ant pixeles-y-ant string-pos-ant (+ string-pos 2) ficha direccion)
      ); fin if, para saber donde se dio click
  ; de lo contrario
      (if (and (and (>= (posn-x (mouse-click-posn click-mouse)) 85 ) (<= (posn-x (mouse-click-posn click-mouse)) 195)) (and (>= (posn-y (mouse-click-posn click-mouse)) 740) (<= (posn-y (mouse-click-posn click-mouse)) 758)))
          (begin
            ((draw-string juego-grafico) (make-posn 840 430) "JUEGO TERMINADO" "black")
            (string-set! string-juego-copy 127 #\-) (string-set! string-juego 127 #\-)
          ); fin begin true, se dio click en el boton de terminar
      ; de lo contrario
         (begin
           ((draw-string juego-grafico) (make-posn 840 430) "CLICK NO VALIDO" "red") (sleep 0.6) ((draw-string juego-grafico) (make-posn 840 430) "CLICK NO VALIDO" "white")
           (busqueda (get-mouse-click juego-grafico) 80 80 0 1)
         ); fin begin false, se dio un click no valido
     ); fin if, termino el juego
  ); fin if, principal
); fin definicion, movimiento de la reina negro
; Fin De La Definicion De Las Funciones Que Dan Movimiento A La Reina Blanca Y La Negra.

; Inicio De La Defincion De Las Funciones Que Dan Movimiento Al Rey Blanco Y Al Rey Negro.
#| Identificadores Locales A La Funcion (Move Rey Blanco):
   - click-mouse: guarda la informacion acerca del ultimo olick dado
   - pixeles-x: almacena las coordenadas en x del primer cuadro del tablero, la cual va contando aumentando su valor hasta ser la del cuadro seleccionado
   - pixeles-y: almacena las coordenadas en y del primer cuadro del tablero, la cual va contando aumentando su valor hasta ser la del cuadro seleccionado
   - pixeles-x-ant: almacena las coordenadas en x donde se encuentra la ficha ya seleccionada
   - pixeles-y-ant: almacena las coordenadas en y donde se encuentra la ficha ya seleccionada
   - string-pos-ant: almacena la posicion númerica de la ficha en el string
   - string-pos: almacena un valor númerico con relacion en el string, el cual va contando hasta ser la posicion a la que se deasea llevar la ficha
   - ficha: almacena un substring que identifica la ficha especifica que se va a mover
   - direccion: guarda la dirección de la imagen que se quiere imprimir en la posicion que el usuario desea
; Definicion de la funcion para dar movimiento a los rey blanco. |#
(define (move-rey-blanco click-mouse pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant string-pos-ant string-pos ficha direccion)
  (if (and (and (>= (posn-x (mouse-click-posn click-mouse)) 80) (<= (posn-x (mouse-click-posn click-mouse)) 720)) (and (>= (posn-y (mouse-click-posn click-mouse)) 80) (<= (posn-y (mouse-click-posn click-mouse)) 720))) #| se asegura de que el click sea dentro del tablero |#
      (if (and (and (>= (posn-x (mouse-click-posn click-mouse)) pixeles-x) (<= (posn-x (mouse-click-posn click-mouse)) (+ pixeles-x 80))) (and (>= (posn-y (mouse-click-posn click-mouse)) pixeles-y) (<= (posn-y (mouse-click-posn click-mouse)) (+ pixeles-y 80))))
          (if (or (equal? (substring string-juego string-pos (+ string-pos 1)) "0") (equal? (substring string-juego string-pos (+ string-pos 1)) "P") (equal? (substring string-juego string-pos (+ string-pos 1)) "T") (equal? (substring string-juego string-pos (+ string-pos 1)) "C")  (equal? (substring string-juego string-pos (+ string-pos 1)) "A") (equal? (substring string-juego string-pos (+ string-pos 1)) "Q"))
              (cond #| condicional para mover |#
                [(equal? string-pos (- string-pos-ant 18)) (string-copy! string-juego string-pos-ant "00")
                                                           (string-copy! string-juego string-pos ficha)
                                                           (if (equal? (jaque 0 "rb") #t)
                                                               (begin
                                                                 ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                 (string-copy! string-juego 0 string-juego-copy)
                                                               ); fin begin true, existe jaque
                                                          ; de lo contrario
                                                               (begin
                                                                 (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                               ); fin begin falee, dibuja en la ventana grafica
                                                          ); fin if, para saber si hay jaque
                ]; de lo contrario comprueba otra posicion
                [(equal? string-pos (- string-pos-ant 16)) (string-copy! string-juego string-pos-ant "00")
                                                           (string-copy! string-juego string-pos ficha)
                                                           (if (equal? (jaque 0 "rb") #t)
                                                               (begin
                                                                 ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                 (string-copy! string-juego 0 string-juego-copy)
                                                               ); fin begin true, existe jaque
                                                          ; de lo contrario
                                                               (begin
                                                                 (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                               ); fin begin falee, dibuja en la ventana grafica
                                                          ); fin if, para saber si hay jaque
                ]; de lo contrario comprueba otra posicion
                [(equal? string-pos (- string-pos-ant 14)) (string-copy! string-juego string-pos-ant "00")
                                                           (string-copy! string-juego string-pos ficha)
                                                           (if (equal? (jaque 0 "rb") #t)
                                                               (begin
                                                                 ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                 (string-copy! string-juego 0 string-juego-copy)
                                                               ); fin begin true, existe jaque
                                                          ; de lo contrario
                                                               (begin
                                                                 (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                               ); fin begin falee, dibuja en la ventana grafica
                                                          ); fin if, para saber si hay jaque
                ]; de lo contrario comprueba otra posicion
                [(equal? string-pos (- string-pos-ant 2)) (string-copy! string-juego string-pos-ant "00")
                                                           (string-copy! string-juego string-pos ficha)
                                                           (if (equal? (jaque 0 "rb") #t)
                                                               (begin
                                                                 ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                 (string-copy! string-juego 0 string-juego-copy)
                                                               ); fin begin true, existe jaque
                                                          ; de lo contrario
                                                               (begin
                                                                 (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                               ); fin begin falee, dibuja en la ventana grafica
                                                          ); fin if, para saber si hay jaque
                ]; de lo contrario comprueba otra posicion
                [(equal? string-pos (+ string-pos-ant 2)) (string-copy! string-juego string-pos-ant "00")
                                                           (string-copy! string-juego string-pos ficha)
                                                           (if (equal? (jaque 0 "rb") #t)
                                                               (begin
                                                                 ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                 (string-copy! string-juego 0 string-juego-copy)
                                                               ); fin begin true, existe jaque
                                                          ; de lo contrario
                                                               (begin
                                                                 (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                               ); fin begin falee, dibuja en la ventana grafica
                                                          ); fin if, para saber si hay jaque
                ]; de lo contrario comprueba otra posicion
                [(equal? string-pos (+ string-pos-ant 14)) (string-copy! string-juego string-pos-ant "00")
                                                           (string-copy! string-juego string-pos ficha)
                                                           (if (equal? (jaque 0 "rb") #t)
                                                               (begin
                                                                 ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                 (string-copy! string-juego 0 string-juego-copy)
                                                               ); fin begin true, existe jaque
                                                          ; de lo contrario
                                                               (begin
                                                                 (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                               ); fin begin falee, dibuja en la ventana grafica
                                                          ); fin if, para saber si hay jaque
                ]; de lo contrario comprueba otra posicion
                [(equal? string-pos (+ string-pos-ant 16)) (string-copy! string-juego string-pos-ant "00")
                                                           (string-copy! string-juego string-pos ficha)
                                                           (if (equal? (jaque 0 "rb") #t)
                                                               (begin
                                                                 ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                 (string-copy! string-juego 0 string-juego-copy)
                                                               ); fin begin true, existe jaque
                                                          ; de lo contrario
                                                               (begin
                                                                 (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                               ); fin begin falee, dibuja en la ventana grafica
                                                          ); fin if, para saber si hay jaque
                ]; de lo contrario comprueba otra posicion
                [(equal? string-pos (+ string-pos-ant 18)) (string-copy! string-juego string-pos-ant "00")
                                                           (string-copy! string-juego string-pos ficha)
                                                           (if (equal? (jaque 0 "rb") #t)
                                                               (begin
                                                                 ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                                                                 (string-copy! string-juego 0 string-juego-copy)
                                                               ); fin begin true, existe jaque
                                                          ; de lo contrario
                                                               (begin
                                                                 (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                               ); fin begin falee, dibuja en la ventana grafica
                                                          ); fin if, para saber si hay jaque
                ]; de lo contrario es un movimiento no valido
                [else ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "white")(busqueda (get-mouse-click juego-grafico) 80 80 0 0)]
              ); fin cond
          ; de lo contrairo
              (begin
                ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "white")
                (busqueda (get-mouse-click juego-grafico) 80 80 0 0)
              ); fin begin false
          ); fin if, para sabar si es un movimiento valido
      ; de lo contrario
          (move-rey-blanco click-mouse (if (= pixeles-x 640) 80 (+ pixeles-x 80)) (if (= pixeles-x 640) (+ pixeles-y 80) pixeles-y) pixeles-x-ant pixeles-y-ant string-pos-ant (+ string-pos 2) ficha direccion)
      ); fin if, para saber donde se dio click
  ; de lo contrario
      (if (and (and (>= (posn-x (mouse-click-posn click-mouse)) 85 ) (<= (posn-x (mouse-click-posn click-mouse)) 195)) (and (>= (posn-y (mouse-click-posn click-mouse)) 740) (<= (posn-y (mouse-click-posn click-mouse)) 758)))
          (begin
            ((draw-string juego-grafico) (make-posn 840 430) "JUEGO TERMINADO" "black")
            (string-set! string-juego-copy 127 #\-) (string-set! string-juego 127 #\-)
          ); fin begin true, se dio click en el boton de terminar
      ; de lo contrario
         (begin
           ((draw-string juego-grafico) (make-posn 840 430) "CLICK NO VALIDO" "red") (sleep 0.6) ((draw-string juego-grafico) (make-posn 840 430) "CLICK NO VALIDO" "white")
           (busqueda (get-mouse-click juego-grafico) 80 80 0 0)
         ); fin begin false, se dio un click no valido
     ); fin if, termino el juego
  ); fin if, principal
); fin definicion, movimiento del rey blanco

#| Identificadores Locales A La Funcion (Move Rey Negro):
   - click-mouse: guarda la informacion acerca del ultimo olick dado
   - pixeles-x: almacena las coordenadas en x del primer cuadro del tablero, la cual va contando aumentando su valor hasta ser la del cuadro seleccionado
   - pixeles-y: almacena las coordenadas en y del primer cuadro del tablero, la cual va contando aumentando su valor hasta ser la del cuadro seleccionado
   - pixeles-x-ant: almacena las coordenadas en x donde se encuentra la ficha ya seleccionada
   - pixeles-y-ant: almacena las coordenadas en y donde se encuentra la ficha ya seleccionada
   - string-pos-ant: almacena la posicion númerica de la ficha en el string
   - string-pos: almacena un valor númerico con relacion en el string, el cual va contando hasta ser la posicion a la que se deasea llevar la ficha
   - ficha: almacena un substring que identifica la ficha especifica que se va a mover
   - direccion: guarda la dirección de la imagen que se quiere imprimir en la posicion que el usuario desea
Definicion de la funcion para dar movimiento al rey negro. |#
(define (move-rey-negro click-mouse pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant string-pos-ant string-pos ficha direccion)
  (if (and (and (>= (posn-x (mouse-click-posn click-mouse)) 80) (<= (posn-x (mouse-click-posn click-mouse)) 720)) (and (>= (posn-y (mouse-click-posn click-mouse)) 80) (<= (posn-y (mouse-click-posn click-mouse)) 720))) #| se asegura de que el click sea dentro del tablero |#
      (if (and (and (>= (posn-x (mouse-click-posn click-mouse)) pixeles-x) (<= (posn-x (mouse-click-posn click-mouse)) (+ pixeles-x 80))) (and (>= (posn-y (mouse-click-posn click-mouse)) pixeles-y) (<= (posn-y (mouse-click-posn click-mouse)) (+ pixeles-y 80))))
          (if (or (equal? (substring string-juego string-pos (+ string-pos 1)) "0") (equal? (substring string-juego string-pos (+ string-pos 1)) "p") (equal? (substring string-juego string-pos (+ string-pos 1)) "t") (equal? (substring string-juego string-pos (+ string-pos 1)) "c")  (equal? (substring string-juego string-pos (+ string-pos 1)) "a") (equal? (substring string-juego string-pos (+ string-pos 1)) "q"))
              (cond #| condicional para mover |#
                [(equal? string-pos (- string-pos-ant 18)) (string-copy! string-juego string-pos-ant "00")
                                                           (string-copy! string-juego string-pos ficha)
                                                           (if (equal? (jaque 0 "RN") #t)
                                                               (begin
                                                                 ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                 (string-copy! string-juego 0 string-juego-copy)
                                                               ); fin begin true, existe jaque
                                                          ; de lo contrario
                                                               (begin
                                                                 (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                               ); fin begin falee, dibuja en la ventana grafica
                                                          ); fin if, analiza el jaque
                ]; de lo contrario comprueba otra posicion
                [(equal? string-pos (- string-pos-ant 16)) (string-copy! string-juego string-pos-ant "00")
                                                           (string-copy! string-juego string-pos ficha)
                                                           (if (equal? (jaque 0 "RN") #t)
                                                               (begin
                                                                 ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                 (string-copy! string-juego 0 string-juego-copy)
                                                               ); fin begin true, existe jaque
                                                          ; de lo contrario
                                                               (begin
                                                                 (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                               ); fin begin falee, dibuja en la ventana grafica
                                                          ); fin if, analiza el jaque
                ]; de lo contrario comprueba otra posicion
                [(equal? string-pos (- string-pos-ant 14)) (string-copy! string-juego string-pos-ant "00")
                                                           (string-copy! string-juego string-pos ficha)
                                                           (if (equal? (jaque 0 "RN") #t)
                                                               (begin
                                                                 ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                 (string-copy! string-juego 0 string-juego-copy)
                                                               ); fin begin true, existe jaque
                                                          ; de lo contrario
                                                               (begin
                                                                 (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                               ); fin begin falee, dibuja en la ventana grafica
                                                          ); fin if, analiza el jaque
                ]; de lo contrario comprueba otra posicion
                [(equal? string-pos (- string-pos-ant 2 )) (string-copy! string-juego string-pos-ant "00")
                                                           (string-copy! string-juego string-pos ficha)
                                                           (if (equal? (jaque 0 "RN") #t)
                                                               (begin
                                                                 ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                 (string-copy! string-juego 0 string-juego-copy)
                                                               ); fin begin true, existe jaque
                                                          ; de lo contrario
                                                               (begin
                                                                 (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                               ); fin begin falee, dibuja en la ventana grafica
                                                          ); fin if, analiza el jaque
                ]; de lo contrario comprueba otra posicion
                [(equal? string-pos (+ string-pos-ant 2 )) (string-copy! string-juego string-pos-ant "00")
                                                           (string-copy! string-juego string-pos ficha)
                                                           (if (equal? (jaque 0 "RN") #t)
                                                               (begin
                                                                 ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                 (string-copy! string-juego 0 string-juego-copy)
                                                               ); fin begin true, existe jaque
                                                          ; de lo contrario
                                                               (begin
                                                                 (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                               ); fin begin falee, dibuja en la ventana grafica
                                                          ); fin if, analiza el jaque
                ]; de lo contrario comprueba otra posicion
                [(equal? string-pos (+ string-pos-ant 14)) (string-copy! string-juego string-pos-ant "00")
                                                           (string-copy! string-juego string-pos ficha)
                                                           (if (equal? (jaque 0 "RN") #t)
                                                               (begin
                                                                 ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                 (string-copy! string-juego 0 string-juego-copy)
                                                               ); fin begin true, existe jaque
                                                          ; de lo contrario
                                                               (begin
                                                                 (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                               ); fin begin falee, dibuja en la ventana grafica
                                                          ); fin if, analiza el jaque
                ]; de lo contrario comprueba otra posicion
                [(equal? string-pos (+ string-pos-ant 16)) (string-copy! string-juego string-pos-ant "00")
                                                           (string-copy! string-juego string-pos ficha)
                                                           (if (equal? (jaque 0 "RN") #t)
                                                               (begin
                                                                 ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                 (string-copy! string-juego 0 string-juego-copy)
                                                               ); fin begin true, existe jaque
                                                          ; de lo contrario
                                                               (begin
                                                                 (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                               ); fin begin falee, dibuja en la ventana grafica
                                                          ); fin if, analiza el jaque
                ]; de lo contrario comprueba otra posicion
                [(equal? string-pos (+ string-pos-ant 18)) (string-copy! string-juego string-pos-ant "00")
                                                           (string-copy! string-juego string-pos ficha)
                                                           (if (equal? (jaque 0 "RN") #t)
                                                               (begin
                                                                 ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                                                                 (string-copy! string-juego 0 string-juego-copy)
                                                               ); fin begin true, existe jaque
                                                          ; de lo contrario
                                                               (begin
                                                                 (actualizacion-grafica pixeles-x pixeles-y pixeles-x-ant pixeles-y-ant direccion)
                                                               ); fin begin falee, dibuja en la ventana grafica
                                                          ); fin if, analiza el jaque
                ]; de lo contrario es un movimiento no valido
                [else ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "white")(busqueda (get-mouse-click juego-grafico) 80 80 0 1)]
              ); fin cond
          ; de lo contrairo
              (begin
                ((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "MOVIMIENTO NO VALIDO" "white")
                (busqueda (get-mouse-click juego-grafico) 80 80 0 1)
              ); fin begin false, movimiento no valido
          ); fin if, para saber si el movimiento es valido
      ; de lo contrario
          (move-rey-negro click-mouse (if (= pixeles-x 640) 80 (+ pixeles-x 80)) (if (= pixeles-x 640) (+ pixeles-y 80) pixeles-y) pixeles-x-ant pixeles-y-ant string-pos-ant (+ string-pos 2) ficha direccion)
      ); fin if, para saber donde se dio click
  ; de lo contrario
      (if (and (and (>= (posn-x (mouse-click-posn click-mouse)) 85 ) (<= (posn-x (mouse-click-posn click-mouse)) 195)) (and (>= (posn-y (mouse-click-posn click-mouse)) 740) (<= (posn-y (mouse-click-posn click-mouse)) 758)))
          (begin
            ((draw-string juego-grafico) (make-posn 840 430) "JUEGO TERMINADO" "black")
            (string-set! string-juego-copy 127 #\-) (string-set! string-juego 127 #\-)
          ); fin begin true, se dio click en el boton terminar
      ; de lo contrario
         (begin
           ((draw-string juego-grafico) (make-posn 840 430) "CLICK NO VALIDO" "red") (sleep 0.6) ((draw-string juego-grafico) (make-posn 840 430) "CLICK NO VALIDO" "white")
           (busqueda (get-mouse-click juego-grafico) 80 80 0 1)
         ); fin begin false, se dio un click no valido
     ); fin if, termino el juego
  ); fin if, principal
); fin definicion, movimiento del rey negro
; Fin De La Definicion De Las Funciones Que Dan Movimiento Al Rey Blanco Y Al Rey Negro.

;___________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
#| Definicion De La Función Encargada De Buscar Que Ficha Es La Que El Jugador Desea Mover |#

#| Identificadores Locales A La Función (busqueda):
   - click-mouse: almacena los datos referentes al click que se haga en pantalla
   - pixeles-x: almacena un valor numerico para guardarlo como coordenadas en x
   - pixeles-y: almacena un valor numerico para guardarlo como coordenadas en y
   - string-pos: almacena un valor numerico para saber en que parte del string se encuentra la ficha que se quiere mover
   - turno: almacena un valor numerico que identifica si juegan las blancas o las negras
Definicion de la funcion busqueda, se encarga de buscar la ficha que se clicqueo. |#
(define (busqueda click-mouse pixeles-x pixeles-y string-pos turno)
  (if (= turno 0)
      #| juegan las blancas |#
      (if (and (and (>= (posn-x (mouse-click-posn click-mouse)) 80) (<= (posn-x (mouse-click-posn click-mouse)) 720)) (and (>= (posn-y (mouse-click-posn click-mouse)) 80) (<= (posn-y (mouse-click-posn click-mouse)) 720))) #| se asegura de que el click sea dentro del tablero |#
          (if (and (and (>= (posn-x (mouse-click-posn click-mouse)) pixeles-x) (<= (posn-x (mouse-click-posn click-mouse)) (+ pixeles-x 80))) (and (>= (posn-y (mouse-click-posn click-mouse)) pixeles-y) (<= (posn-y (mouse-click-posn click-mouse)) (+ pixeles-y 80))))
              (cond #| condicion para saber que ficha se cliqueo |#
                [(equal? (substring string-juego string-pos (+ string-pos 1)) "p") (move-peon-blanco    (get-mouse-click juego-grafico) 80 80 pixeles-x pixeles-y string-pos 0 (substring string-juego string-pos (+ string-pos 2)) "Imagenes/PeonBlanco 60x60.png"   ) (controlador (if (equal? string-juego string-juego-copy) turno 1))]
                [(equal? (substring string-juego string-pos (+ string-pos 1)) "t") (move-torre-blanco   (get-mouse-click juego-grafico) 80 80 pixeles-x pixeles-y string-pos 0 (substring string-juego string-pos (+ string-pos 2)) "Imagenes/TorreBlanco 60x60.png"  ) (controlador (if (equal? string-juego string-juego-copy) turno 1))]
                [(equal? (substring string-juego string-pos (+ string-pos 1)) "c") (move-caballo-blanco (get-mouse-click juego-grafico) 80 80 pixeles-x pixeles-y string-pos 0 (substring string-juego string-pos (+ string-pos 2)) "Imagenes/CaballoBlanco 60x60.png") (controlador (if (equal? string-juego string-juego-copy) turno 1))]
                [(equal? (substring string-juego string-pos (+ string-pos 1)) "a") (move-alfil-blanco   (get-mouse-click juego-grafico) 80 80 pixeles-x pixeles-y string-pos 0 (substring string-juego string-pos (+ string-pos 2)) "Imagenes/AlfilBlanco 60x60.png"  ) (controlador (if (equal? string-juego string-juego-copy) turno 1))]
                [(equal? (substring string-juego string-pos (+ string-pos 1)) "q") (move-reina-blanco   (get-mouse-click juego-grafico) 80 80 pixeles-x pixeles-y string-pos 0 (substring string-juego string-pos (+ string-pos 2)) "Imagenes/ReinaBlanco 60x60.png"  ) (controlador (if (equal? string-juego string-juego-copy) turno 1))]
                [(equal? (substring string-juego string-pos (+ string-pos 1)) "r") (move-rey-blanco     (get-mouse-click juego-grafico) 80 80 pixeles-x pixeles-y string-pos 0 (substring string-juego string-pos (+ string-pos 2)) "Imagenes/ReyBlanco 60x60.png"    ) (controlador (if (equal? string-juego string-juego-copy) turno 1))]
                [else ((draw-string juego-grafico) (make-posn 840 430) "CLICK NO VALIDO" "red") (sleep 0.6) ((draw-string juego-grafico) (make-posn 840 430) "CLICK NO VALIDO" "white") (controlador 0)]
              ); fin cond, analiza a que ficha se le d io click
          ; de lo contrario
              (busqueda click-mouse (if (= pixeles-x 640) 80 (+ pixeles-x 80)) (if (= pixeles-x 640) (+ pixeles-y 80) pixeles-y) (+ string-pos 2) turno)
          ); fin if, para saber donde se dio click
      ; de lo contrario
          (if (and (and (>= (posn-x (mouse-click-posn click-mouse)) 85 ) (<= (posn-x (mouse-click-posn click-mouse)) 195)) (and (>= (posn-y (mouse-click-posn click-mouse)) 740) (<= (posn-y (mouse-click-posn click-mouse)) 758)))
              (begin
                ((draw-string juego-grafico) (make-posn 840 430) "JUEGO TERMINADO" "black")
                (string-set! string-juego-copy 127 #\-) (string-set! string-juego 127 #\-)
              ); fin begin true, si dio click en el boton terminar
           ; de lo contrario
              (begin
                ((draw-string juego-grafico) (make-posn 840 430) "CLICK NO VALIDO" "red") (sleep 0.6) ((draw-string juego-grafico) (make-posn 840 430) "CLICK NO VALIDO" "white")
                (controlador turno)
              ); fin begin false, se dio un click no valido
          ); fin if, analiza si el juego termino
      ); fin if, juegan las blancas
  ; de lo contrario
      #| juegan las negras |#
      (if (and (and (>= (posn-x (mouse-click-posn click-mouse)) 80) (<= (posn-x (mouse-click-posn click-mouse)) 720)) (and (>= (posn-y (mouse-click-posn click-mouse)) 80) (<= (posn-y (mouse-click-posn click-mouse)) 720))) #| se asegura de que el click sea dentro del tablero |#
          (if (and (and (>= (posn-x (mouse-click-posn click-mouse)) pixeles-x) (<= (posn-x (mouse-click-posn click-mouse)) (+ pixeles-x 80))) (and (>= (posn-y (mouse-click-posn click-mouse)) pixeles-y) (<= (posn-y (mouse-click-posn click-mouse)) (+ pixeles-y 80))))
              (cond #| condicion para saber que ficha se cliqueo |#
                [(equal? (substring string-juego string-pos (+ string-pos 1)) "P") (move-peon-negro    (get-mouse-click juego-grafico) 80 80 pixeles-x pixeles-y string-pos 0 (substring string-juego string-pos (+ string-pos 2)) "Imagenes/PeonNegro 60x60.png"   ) (controlador (if (equal? string-juego string-juego-copy) turno 0))]
                [(equal? (substring string-juego string-pos (+ string-pos 1)) "T") (move-torre-negro   (get-mouse-click juego-grafico) 80 80 pixeles-x pixeles-y string-pos 0 (substring string-juego string-pos (+ string-pos 2)) "Imagenes/TorreNegro 60x60.png"  ) (controlador (if (equal? string-juego string-juego-copy) turno 0))]
                [(equal? (substring string-juego string-pos (+ string-pos 1)) "C") (move-caballo-negro (get-mouse-click juego-grafico) 80 80 pixeles-x pixeles-y string-pos 0 (substring string-juego string-pos (+ string-pos 2)) "Imagenes/CaballoNegro 60x60.png") (controlador (if (equal? string-juego string-juego-copy) turno 0))]
                [(equal? (substring string-juego string-pos (+ string-pos 1)) "A") (move-alfil-negro   (get-mouse-click juego-grafico) 80 80 pixeles-x pixeles-y string-pos 0 (substring string-juego string-pos (+ string-pos 2)) "Imagenes/AlfilNegro 60x60.png"  ) (controlador (if (equal? string-juego string-juego-copy) turno 0))]
                [(equal? (substring string-juego string-pos (+ string-pos 1)) "Q") (move-reina-negro   (get-mouse-click juego-grafico) 80 80 pixeles-x pixeles-y string-pos 0 (substring string-juego string-pos (+ string-pos 2)) "Imagenes/ReinaNegro 60x60.png"  ) (controlador (if (equal? string-juego string-juego-copy) turno 0))]
                [(equal? (substring string-juego string-pos (+ string-pos 1)) "R") (move-rey-negro     (get-mouse-click juego-grafico) 80 80 pixeles-x pixeles-y string-pos 0 (substring string-juego string-pos (+ string-pos 2)) "Imagenes/ReyNegro 60x60.png"    ) (controlador (if (equal? string-juego string-juego-copy) turno 0))]
                [else ((draw-string juego-grafico) (make-posn 840 430) "CLICK NO VALIDO" "red") (sleep 0.6) ((draw-string juego-grafico) (make-posn 840 430) "CLICK NO VALIDO" "white") (controlador 1)]
              ); fin cond, analiza a que ficha se le dio click
          ; de lo contrario
              (busqueda click-mouse (if (= pixeles-x 640) 80 (+ pixeles-x 80)) (if (= pixeles-x 640) (+ pixeles-y 80) pixeles-y) (+ string-pos 2) turno)
          ); fin if, para saber donde se dio click
      ; de lo contrario
          (if (and (and (>= (posn-x (mouse-click-posn click-mouse)) 85 ) (<= (posn-x (mouse-click-posn click-mouse)) 195)) (and (>= (posn-y (mouse-click-posn click-mouse)) 740) (<= (posn-y (mouse-click-posn click-mouse)) 758)))
              (begin
                ((draw-string juego-grafico) (make-posn 840 430) "JUEGO TERMINADO" "black")
                (string-set! string-juego-copy 127 #\-) (string-set! string-juego 127 #\-)
              ); fin begin true, se dio click en el boton terminar
           ; de lo contrario
              (begin
                ((draw-string juego-grafico) (make-posn 840 430) "CLICK NO VALIDO" "red") (sleep 0.6) ((draw-string juego-grafico) (make-posn 840 430) "CLICK NO VALIDO" "white")
                (controlador turno)
              ); fin begin false, se dio un click no valido
          ); fin if, analiza si el juego termino
      ); fin if, juegan las negras
  ); fin if, que da paso al jugador que le corresponde jugar
); fin definicion busqueda

;___________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________
#| Función Que Controla Los Turnos De Los Jugadores Y La Lógica Del Juego |#

#| Identificadores Locales A La Función (controlador):
   - turno: almacena un numero sea 0 o 1 que corresponde si juegan las blancas o las negras
Definicion de la funcion controlador, controla el juego. |#
(define (controlador turno)
  (if (equal? 0 turno)
      (begin #| turno de las blancas |#
        (string-copy! string-juego-copy 0 string-juego)
        ((draw-string juego-grafico) (make-posn 840 180) "JUEGAN LAS NEGRAS" "white")
        ((draw-string juego-grafico) (make-posn 840 640) "JUEGAN LAS BLANCAS" "black")
        (printf string-juego)
        (newline)
        (if (equal? #t (jaque 0 "rb"))
            (if (equal? (jaque-mate-blanco 0 0) #t)
                (begin
                  ((draw-string juego-grafico) (make-posn 840 430) "JAQUE MATE AL REY BLANCO" "red")
                  (string-set! string-juego-copy 127 #\-) (string-set! string-juego 127 #\-)
                ); fin begin true, hay jaque mate en las blancas
            ; de lo contrario
                (begin
                  ((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY BLANCO EN JAQUE" "white")
                ); fin begin false, hay jaque en las blancas
            ); fin if, posible jaque mate en las blancas
        ; de lo contrario
            (void)
        ); fin if, posible jaque en las blancas
        (if (equal? (substring string-juego 127 128) "-")
            (void)
        ; de lo contrario
            (begin
              (busqueda (get-mouse-click juego-grafico) 80 80 0 turno)
            ); fin begin false, el juego continua
        ); fin if, valida si el juego termino
      ); fin begin true, turno de las blancas
  ; de lo contrario
      (begin #| turno de las negras |#
        (string-copy! string-juego-copy 0 string-juego)
        ((draw-string juego-grafico) (make-posn 840 640) "JUEGAN LAS BLANCAS" "white")
        ((draw-string juego-grafico) (make-posn 840 180) "JUEGAN LAS NEGRAS" "black")
        (printf string-juego)
        (newline)
        (if (equal? #t (jaque 0 "RN"))
            (if (equal? (jaque-mate-negro 0 0) #t)
                (begin
                  ((draw-string juego-grafico) (make-posn 840 430) "JAQUE MATE AL REY NEGRO" "red")
                  (string-set! string-juego-copy 127 #\-) (string-set! string-juego 127 #\-)
                ); fin begin true, hay jaque mate en las negras
            ; de lo contrario
                (begin
                  ((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "red")(sleep 0.6)((draw-string juego-grafico) (make-posn 840 430) "REY NEGRO EN JAQUE" "white")
                ); fin begin false, hay jaque en las negras
            ); fin if, posible jaque mate en las negras
        ; de lo contrario
            (void)
        ); fin if, posible jaque en las negras
        (if (equal? (substring string-juego 127 128) "-")
            (void)
        ; de lo contrario
            (begin
              (busqueda (get-mouse-click juego-grafico) 80 80 0 turno)
            ); fin begin false, el juego continua
        ); fin if, valida si el juego termino
      ); fin begin false, turno de las negras
  ); fin if, analizador de que fichas juegan
); fin definición controlador

(controlador 0); llamado a la función que inicia el juego

;___________________________________________________________________________________________________________________________________________________________________________________________________________________________________________________